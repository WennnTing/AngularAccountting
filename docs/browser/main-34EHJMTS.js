import{A as iS,B as On,C as Li,D as Ah,E as _c,F as sy,G as sS,H as oS,I as z,J as dn,K as vt,L as oy,M as aS,N as yc,O as Z,P as Ft,Q as xh,R as ay,S as Fn,T as ji,U as ai,V as sa,W as uS,X as hn,Y as Je,a as N,b as Ce,c as ny,d as v,e as Yb,f as Ch,g as Zb,h as Xb,i as T,j as ra,k as Dh,l as Jb,m as eS,n as Tt,o as ia,p as mc,q as ry,r as tS,s as Er,t as iy,u as Th,v as bh,w as nS,x as Sh,y as lt,z as rS}from"./chunk-EMU53QTL.js";var cS=null;var uy=1,lS=Symbol("SIGNAL");function vn(t){let e=cS;return cS=t,e}var dS={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Z2(t){if(!(dy(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===uy)){if(!t.producerMustRecompute(t)&&!cy(t)){t.dirty=!1,t.lastCleanEpoch=uy;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=uy}}function hS(t){return t&&(t.nextProducerIndex=0),vn(t)}function fS(t,e){if(vn(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(dy(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)ly(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function cy(t){Rh(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(Z2(n),r!==n.version))return!0}return!1}function pS(t){if(Rh(t),dy(t))for(let e=0;e<t.producerNode.length;e++)ly(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function ly(t,e){if(X2(t),Rh(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)ly(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Rh(i),i.producerIndexOfThis[r]=e}}function dy(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Rh(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function X2(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function J2(){throw new Error}var ej=J2;function gS(t){ej=t}function J(t){return typeof t=="function"}function oa(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Mh=oa(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Us(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var it=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(J(r))try{r()}catch(s){e=s instanceof Mh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{mS(s)}catch(o){e=e??[],o instanceof Mh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Mh(e)}}add(e){var n;if(e&&e!==this)if(this.closed)mS(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Us(n,e)}remove(e){let{_finalizers:n}=this;n&&Us(n,e),e instanceof t&&e._removeParent(this)}};it.EMPTY=(()=>{let t=new it;return t.closed=!0,t})();var hy=it.EMPTY;function Nh(t){return t instanceof it||t&&"closed"in t&&J(t.remove)&&J(t.add)&&J(t.unsubscribe)}function mS(t){J(t)?t():t.unsubscribe()}var Jn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var aa={setTimeout(t,e,...n){let{delegate:r}=aa;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=aa;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Ph(t){aa.setTimeout(()=>{let{onUnhandledError:e}=Jn;if(e)e(t);else throw t})}function Bs(){}var _S=fy("C",void 0,void 0);function yS(t){return fy("E",void 0,t)}function vS(t){return fy("N",t,void 0)}function fy(t,e,n){return{kind:t,value:e,error:n}}var $s=null;function ua(t){if(Jn.useDeprecatedSynchronousErrorHandling){let e=!$s;if(e&&($s={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=$s;if($s=null,n)throw r}}else t()}function wS(t){Jn.useDeprecatedSynchronousErrorHandling&&$s&&($s.errorThrown=!0,$s.error=t)}var Hs=class extends it{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Nh(e)&&e.add(this)):this.destination=rj}static create(e,n,r){return new ui(e,n,r)}next(e){this.isStopped?gy(vS(e),this):this._next(e)}error(e){this.isStopped?gy(yS(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?gy(_S,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},tj=Function.prototype.bind;function py(t,e){return tj.call(t,e)}var my=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){kh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){kh(r)}else kh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){kh(n)}}},ui=class extends Hs{constructor(e,n,r){super();let i;if(J(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Jn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&py(e.next,s),error:e.error&&py(e.error,s),complete:e.complete&&py(e.complete,s)}):i=e}this.destination=new my(i)}};function kh(t){Jn.useDeprecatedSynchronousErrorHandling?wS(t):Ph(t)}function nj(t){throw t}function gy(t,e){let{onStoppedNotification:n}=Jn;n&&aa.setTimeout(()=>n(t,e))}var rj={closed:!0,next:Bs,error:nj,complete:Bs};var ca=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Vt(t){return t}function _y(...t){return yy(t)}function yy(t){return t.length===0?Vt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var se=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=sj(n)?n:new ui(n,r,i);return ua(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=ES(r),new r((i,s)=>{let o=new ui({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[ca](){return this}pipe(...n){return yy(n)(this)}toPromise(n){return n=ES(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function ES(t){var e;return(e=t??Jn.Promise)!==null&&e!==void 0?e:Promise}function ij(t){return t&&J(t.next)&&J(t.error)&&J(t.complete)}function sj(t){return t&&t instanceof Hs||ij(t)&&Nh(t)}function vy(t){return J(t?.lift)}function X(t){return e=>{if(vy(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Y(t,e,n,r,i){return new wy(t,e,n,r,i)}var wy=class extends Hs{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function la(){return X((t,e)=>{let n=null;t._refCount++;let r=Y(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var da=class extends se{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,vy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new it;let n=this.getSubject();e.add(this.source.subscribe(Y(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=it.EMPTY)}return e}refCount(){return la()(this)}};var IS=oa(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var wt=(()=>{class t extends se{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Oh(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new IS}next(n){ua(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){ua(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){ua(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?hy:(this.currentObservers=null,s.push(n),new it(()=>{this.currentObservers=null,Us(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new se;return n.source=this,n}}return t.create=(e,n)=>new Oh(e,n),t})(),Oh=class extends wt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:hy}};var Lt=class extends wt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var vc={now(){return(vc.delegate||Date).now()},delegate:void 0};var Fh=class extends wt{constructor(e=1/0,n=1/0,r=vc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var Vh=class extends it{constructor(e,n){super()}schedule(e,n=0){return this}};var wc={setInterval(t,e,...n){let{delegate:r}=wc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=wc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var ha=class extends Vh{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return wc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&wc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Us(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var fa=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};fa.now=vc.now;var pa=class extends fa{constructor(e,n=fa.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var ci=new pa(ha);var Lh=class extends ha{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var jh=class extends pa{};var Ey=new jh(Lh);var fn=new se(t=>t.complete());function CS(t){return t&&J(t.schedule)}function Iy(t){return t[t.length-1]}function ga(t){return J(Iy(t))?t.pop():void 0}function Ir(t){return CS(Iy(t))?t.pop():void 0}function DS(t,e){return typeof Iy(t)=="number"?t.pop():e}var Uh=t=>t&&typeof t.length=="number"&&typeof t!="function";function Bh(t){return J(t?.then)}function $h(t){return J(t[ca])}function Hh(t){return Symbol.asyncIterator&&J(t?.[Symbol.asyncIterator])}function qh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function oj(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Gh=oj();function zh(t){return J(t?.[Gh])}function Wh(t){return Zb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Ch(n.read());if(i)return yield Ch(void 0);yield yield Ch(r)}}finally{n.releaseLock()}})}function Kh(t){return J(t?.getReader)}function Me(t){if(t instanceof se)return t;if(t!=null){if($h(t))return aj(t);if(Uh(t))return uj(t);if(Bh(t))return cj(t);if(Hh(t))return TS(t);if(zh(t))return lj(t);if(Kh(t))return dj(t)}throw qh(t)}function aj(t){return new se(e=>{let n=t[ca]();if(J(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function uj(t){return new se(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function cj(t){return new se(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Ph)})}function lj(t){return new se(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function TS(t){return new se(e=>{hj(t,e).catch(n=>e.error(n))})}function dj(t){return TS(Wh(t))}function hj(t,e){var n,r,i,s;return Yb(this,void 0,void 0,function*(){try{for(n=Xb(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function pn(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function wn(t,e=0){return X((n,r)=>{n.subscribe(Y(r,i=>pn(r,t,()=>r.next(i),e),()=>pn(r,t,()=>r.complete(),e),i=>pn(r,t,()=>r.error(i),e)))})}function er(t,e=0){return X((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function bS(t,e){return Me(t).pipe(er(e),wn(e))}function SS(t,e){return Me(t).pipe(er(e),wn(e))}function AS(t,e){return new se(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function xS(t,e){return new se(n=>{let r;return pn(n,e,()=>{r=t[Gh](),pn(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>J(r?.return)&&r.return()})}function Qh(t,e){if(!t)throw new Error("Iterable cannot be null");return new se(n=>{pn(n,e,()=>{let r=t[Symbol.asyncIterator]();pn(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function RS(t,e){return Qh(Wh(t),e)}function MS(t,e){if(t!=null){if($h(t))return bS(t,e);if(Uh(t))return AS(t,e);if(Bh(t))return SS(t,e);if(Hh(t))return Qh(t,e);if(zh(t))return xS(t,e);if(Kh(t))return RS(t,e)}throw qh(t)}function ce(t,e){return e?MS(t,e):Me(t)}function B(...t){let e=Ir(t);return ce(t,e)}function ma(t,e){let n=J(t)?t:()=>t,r=i=>i.error(n());return new se(e?i=>e.schedule(r,0,i):r)}function Cy(t){return!!t&&(t instanceof se||J(t.lift)&&J(t.subscribe))}var li=oa(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function U(t,e){return X((n,r)=>{let i=0;n.subscribe(Y(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:fj}=Array;function pj(t,e){return fj(e)?t(...e):t(e)}function Yh(t){return U(e=>pj(t,e))}var{isArray:gj}=Array,{getPrototypeOf:mj,prototype:_j,keys:yj}=Object;function Zh(t){if(t.length===1){let e=t[0];if(gj(e))return{args:e,keys:null};if(vj(e)){let n=yj(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function vj(t){return t&&typeof t=="object"&&mj(t)===_j}function Xh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Ec(...t){let e=Ir(t),n=ga(t),{args:r,keys:i}=Zh(t);if(r.length===0)return ce([],e);let s=new se(wj(r,e,i?o=>Xh(i,o):Vt));return n?s.pipe(Yh(n)):s}function wj(t,e,n=Vt){return r=>{NS(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)NS(e,()=>{let c=ce(t[u],e),l=!1;c.subscribe(Y(r,d=>{s[u]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function NS(t,e,n){t?pn(n,t,e):e()}function PS(t,e,n,r,i,s,o,a){let u=[],c=0,l=0,d=!1,h=()=>{d&&!u.length&&!c&&e.complete()},f=g=>c<r?p(g):u.push(g),p=g=>{s&&e.next(g),c++;let m=!1;Me(n(g,l++)).subscribe(Y(e,I=>{i?.(I),s?f(I):e.next(I)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;u.length&&c<r;){let I=u.shift();o?pn(e,o,()=>p(I)):p(I)}h()}catch(I){e.error(I)}}))};return t.subscribe(Y(e,f,()=>{d=!0,h()})),()=>{a?.()}}function dt(t,e,n=1/0){return J(e)?dt((r,i)=>U((s,o)=>e(r,s,i,o))(Me(t(r,i))),n):(typeof e=="number"&&(n=e),X((r,i)=>PS(r,i,t,n)))}function Ui(t=1/0){return dt(Vt,t)}function kS(){return Ui(1)}function _a(...t){return kS()(ce(t,Ir(t)))}function Jh(t){return new se(e=>{Me(t()).subscribe(e)})}function Dy(...t){let e=ga(t),{args:n,keys:r}=Zh(t),i=new se(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),u=o,c=o;for(let l=0;l<o;l++){let d=!1;Me(n[l]).subscribe(Y(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?Xh(r,a):a),s.complete())}))}});return e?i.pipe(Yh(e)):i}function ya(...t){let e=Ir(t),n=DS(t,1/0),r=t;return r.length?r.length===1?Me(r[0]):Ui(n)(ce(r,e)):fn}function Et(t,e){return X((n,r)=>{let i=0;n.subscribe(Y(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Bi(t){return X((e,n)=>{let r=null,i=!1,s;r=e.subscribe(Y(n,void 0,void 0,o=>{s=Me(t(o,Bi(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function OS(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(Y(o,l=>{let d=c++;u=a?t(u,l,d):(a=!0,l),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function qs(t,e){return J(e)?dt(t,e,1):dt(t,1)}function Ty(t,e=ci){return X((n,r)=>{let i=null,s=null,o=null,a=()=>{if(i){i.unsubscribe(),i=null;let c=s;s=null,r.next(c)}};function u(){let c=o+t,l=e.now();if(l<c){i=this.schedule(void 0,c-l),r.add(i);return}a()}n.subscribe(Y(r,c=>{s=c,o=e.now(),i||(i=e.schedule(u,t),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}function $i(t){return X((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function di(t){return t<=0?()=>fn:X((e,n)=>{let r=0;e.subscribe(Y(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function by(t){return U(()=>t)}function Ic(t,e=Vt){return t=t??Ej,X((n,r)=>{let i,s=!0;n.subscribe(Y(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function Ej(t,e){return t===e}function ef(t=Ij){return X((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function Ij(){return new li}function Cc(t){return X((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function Vn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Et((i,s)=>t(i,s,r)):Vt,di(1),n?$i(e):ef(()=>new li))}function va(t){return t<=0?()=>fn:X((e,n)=>{let r=[];e.subscribe(Y(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function Sy(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Et((i,s)=>t(i,s,r)):Vt,va(1),n?$i(e):ef(()=>new li))}function Dc(){return X((t,e)=>{let n,r=!1;t.subscribe(Y(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function Cr(t,e){return X(OS(t,e,arguments.length>=2,!0))}function Tc(t={}){let{connector:e=()=>new wt,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return X((g,m)=>{c++,!d&&!l&&h();let I=u=u??e();m.add(()=>{c--,c===0&&!d&&!l&&(a=Ay(p,i))}),I.subscribe(m),!o&&c>0&&(o=new ui({next:A=>I.next(A),error:A=>{d=!0,h(),a=Ay(f,n,A),I.error(A)},complete:()=>{l=!0,h(),a=Ay(f,r),I.complete()}}),Me(g).subscribe(o))})(s)}}function Ay(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new ui({next:()=>{r.unsubscribe(),t()}});return Me(e(...n)).subscribe(r)}function tf(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Tc({connector:()=>new Fh(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function xy(t){return X((e,n)=>{let r=!1,i=0;e.subscribe(Y(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function Gs(...t){let e=Ir(t);return X((n,r)=>{(e?_a(t,n,e):_a(t,n)).subscribe(r)})}function Ne(t,e){return X((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(Y(r,u=>{i?.unsubscribe();let c=0,l=s++;Me(t(u,l)).subscribe(i=Y(r,d=>r.next(e?e(u,d,l,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function nf(t,e){return J(e)?Ne(()=>t,e):Ne(()=>t)}function Ry(t){return X((e,n)=>{Me(t).subscribe(Y(n,()=>n.complete(),Bs)),!n.closed&&e.subscribe(n)})}function st(t,e,n){let r=J(t)||e||n?{next:t,error:e,complete:n}:t;return r?X((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Y(s,u=>{var c;(c=r.next)===null||c===void 0||c.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,u),s.error(u)},()=>{var u,c;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):Vt}function My(...t){let e=ga(t);return X((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)Me(t[u]).subscribe(Y(r,c=>{s[u]=c,!a&&!o[u]&&(o[u]=!0,(a=o.every(Vt))&&(o=null))},Bs));n.subscribe(Y(r,u=>{if(a){let c=[u,...s];r.next(e?e(...c):c)}}))})}var Cj="https://g.co/ng/security#xss",H=class extends Error{constructor(e,n){super(Vv(e,n)),this.code=e}};function Vv(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function Pe(t){for(let e in t)if(t[e]===Pe)return e;throw Error("Could not find renamed property on target object.")}function Dj(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function en(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(en).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function FS(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var Tj=Pe({__forward_ref__:Pe});function Yi(t){return t.__forward_ref__=Yi,t.toString=function(){return en(this())},t}function Jt(t){return EA(t)?t():t}function EA(t){return typeof t=="function"&&t.hasOwnProperty(Tj)&&t.__forward_ref__===Yi}function IA(t){return t&&!!t.\u0275providers}var bj=Pe({\u0275cmp:Pe}),Sj=Pe({\u0275dir:Pe}),Aj=Pe({\u0275pipe:Pe}),xj=Pe({\u0275mod:Pe}),ff=Pe({\u0275fac:Pe}),bc=Pe({__NG_ELEMENT_ID__:Pe}),VS=Pe({__NG_ENV_ID__:Pe});function Sc(t){return typeof t=="string"?t:t==null?"":String(t)}function Rj(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Sc(t)}function Mj(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new H(-200,`Circular dependency in DI detected for ${t}${n}`)}function Lv(t,e){throw new H(-201,!1)}function Nj(t,e){t==null&&Pj(e,t,null,"!=")}function Pj(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(r==null?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}function V(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function $e(t){return{providers:t.providers||[],imports:t.imports||[]}}function Of(t){return LS(t,DA)||LS(t,TA)}function CA(t){return Of(t)!==null}function LS(t,e){return t.hasOwnProperty(e)?t[e]:null}function kj(t){let e=t&&(t[DA]||t[TA]);return e||null}function jS(t){return t&&(t.hasOwnProperty(US)||t.hasOwnProperty(Oj))?t[US]:null}var DA=Pe({\u0275prov:Pe}),US=Pe({\u0275inj:Pe}),TA=Pe({ngInjectableDef:Pe}),Oj=Pe({ngInjectorDef:Pe}),le=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(le||{}),Wy;function bA(){return Wy}function gn(t){let e=Wy;return Wy=t,e}function SA(t,e,n){let r=Of(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&le.Optional)return null;if(e!==void 0)return e;Lv(t,"Injector")}var jt=globalThis;var P=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=V({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var Fj={},xc=Fj,Ky="__NG_DI_FLAG__",pf="ngTempTokenPath",Vj="ngTokenPath",Lj=/\n/gm,jj="\u0275",BS="__source",Da;function Uj(){return Da}function Hi(t){let e=Da;return Da=t,e}function Bj(t,e=le.Default){if(Da===void 0)throw new H(-203,!1);return Da===null?SA(t,void 0,e):Da.get(t,e&le.Optional?null:void 0,e)}function w(t,e=le.Default){return(bA()||Bj)(Jt(t),e)}function O(t,e=le.Default){return w(t,Ff(e))}function Ff(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Qy(t){let e=[];for(let n=0;n<t.length;n++){let r=Jt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new H(900,!1);let i,s=le.Default;for(let o=0;o<r.length;o++){let a=r[o],u=$j(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(w(i,s))}else e.push(w(r))}return e}function AA(t,e){return t[Ky]=e,t.prototype[Ky]=e,t}function $j(t){return t[Ky]}function Hj(t,e,n,r){let i=t[pf];throw e[BS]&&i.unshift(e[BS]),t.message=qj(`
`+t.message,i,n,r),t[Vj]=i,t[pf]=null,t}function qj(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==jj?t.slice(2):t;let i=en(e);if(Array.isArray(e))i=e.map(en).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):en(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Lj,`
  `)}`}function Uc(t){return{toString:t}.toString()}var xA=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(xA||{}),br=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(br||{}),ba={},Ln=[],En=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(En||{});function RA(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function Yy(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];zj(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function Gj(t){return t===3||t===4||t===6}function zj(t){return t.charCodeAt(0)===64}function Rc(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?$S(t,n,i,null,e[++r]):$S(t,n,i,null,null))}}return t}function $S(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var MA="ng-template";function Wj(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&RA(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function NA(t){return t.type===4&&t.value!==MA}function Kj(t,e,n){let r=t.type===4&&!n?MA:t.value;return e===r}function Qj(t,e,n){let r=4,i=t.attrs||[],s=Xj(i),o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!tr(r)&&!tr(u))return!1;if(o&&tr(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!Kj(t,u,n)||u===""&&e.length===1){if(tr(r))return!1;o=!0}}else{let c=r&8?u:e[++a];if(r&8&&t.attrs!==null){if(!Wj(t.attrs,c,n)){if(tr(r))return!1;o=!0}continue}let l=r&8?"class":u,d=Yj(l,i,NA(t),n);if(d===-1){if(tr(r))return!1;o=!0;continue}if(c!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&RA(f,c,0)!==-1||r&2&&c!==h){if(tr(r))return!1;o=!0}}}}return tr(r)||o}function tr(t){return(t&1)===0}function Yj(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return Jj(e,t)}function Zj(t,e,n=!1){for(let r=0;r<e.length;r++)if(Qj(t,e[r],n))return!0;return!1}function Xj(t){for(let e=0;e<t.length;e++){let n=t[e];if(Gj(n))return e}return t.length}function Jj(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function HS(t,e){return t?":not("+e.trim()+")":e}function eU(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!tr(o)&&(e+=HS(s,i),i=""),r=o,s=s||!tr(r);n++}return i!==""&&(e+=HS(s,i)),e}function tU(t){return t.map(eU).join(",")}function nU(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!tr(i))break;i=s}r++}return{attrs:e,classes:n}}function Rr(t){return Uc(()=>{let e=VA(t),n=Ce(N({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===xA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||br.Emulated,styles:t.styles||Ln,_:null,schemas:t.schemas||null,tView:null,id:""});LA(n);let r=t.dependencies;return n.directiveDefs=GS(r,!1),n.pipeDefs=GS(r,!0),n.id=sU(n),n})}function rU(t){return Gi(t)||PA(t)}function iU(t){return t!==null}function He(t){return Uc(()=>({type:t.type,bootstrap:t.bootstrap||Ln,declarations:t.declarations||Ln,imports:t.imports||Ln,exports:t.exports||Ln,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function qS(t,e){if(t==null)return ba;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=En.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==En.None?[r,a]:r,e[s]=o):n[s]=r}return n}function Ut(t){return Uc(()=>{let e=VA(t);return LA(e),e})}function Mr(t){return{type:t.type,name:t.name,factory:null,pure:t.pure!==!1,standalone:t.standalone===!0,onDestroy:t.type.prototype.ngOnDestroy||null}}function Gi(t){return t[bj]||null}function PA(t){return t[Sj]||null}function kA(t){return t[Aj]||null}function OA(t){let e=Gi(t)||PA(t)||kA(t);return e!==null?e.standalone:!1}function FA(t,e){let n=t[xj]||null;if(!n&&e===!0)throw new Error(`Type ${en(t)} does not have '\u0275mod' property.`);return n}function VA(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||ba,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Ln,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:qS(t.inputs,e),outputs:qS(t.outputs),debugInfo:null}}function LA(t){t.features?.forEach(e=>e(t))}function GS(t,e){if(!t)return null;let n=e?kA:rU;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(iU)}function sU(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var pi=0,ge=1,te=2,zt=3,nr=4,ir=5,gf=6,Mc=7,rr=8,Sa=9,zi=10,bt=11,Nc=12,zS=13,ka=14,Sr=15,Vf=16,wa=17,Pc=18,Lf=19,jA=20,qi=21,Ny=22,Qs=23,Un=25,UA=1;var Ys=7,mf=8,_f=9,jn=10,jv=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(jv||{});function Ws(t){return Array.isArray(t)&&typeof t[UA]=="object"}function gi(t){return Array.isArray(t)&&t[UA]===!0}function Uv(t){return(t.flags&4)!==0}function jf(t){return t.componentOffset>-1}function Uf(t){return(t.flags&1)===1}function Wi(t){return!!t.template}function oU(t){return(t[te]&512)!==0}function Zs(t,e){let n=t.hasOwnProperty(ff);return n?t[ff]:null}var Zy=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function BA(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Oa(){return $A}function $A(t){return t.type.prototype.ngOnChanges&&(t.setInput=uU),aU}Oa.ngInherit=!0;function aU(){let t=qA(this),e=t?.current;if(e){let n=t.previous;if(n===ba)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function uU(t,e,n,r,i){let s=this.declaredInputs[r],o=qA(t)||cU(t,{previous:ba,current:null}),a=o.current||(o.current={}),u=o.previous,c=u[s];a[s]=new Zy(c&&c.currentValue,n,u===ba),BA(t,e,i,n)}var HA="__ngSimpleChanges__";function qA(t){return t[HA]||null}function cU(t,e){return t[HA]=e}var WS=null;var Dr=function(t,e,n){WS?.(t,e,n)},lU="svg",dU="math",hU=!1;function fU(){return hU}function Ar(t){for(;Array.isArray(t);)t=t[pi];return t}function GA(t,e){return Ar(e[t])}function sr(t,e){return Ar(e[t.index])}function zA(t,e){return t.data[e]}function WA(t,e){return t[e]}function Zi(t,e){let n=e[t];return Ws(n)?n:n[pi]}function Bv(t){return(t[te]&128)===128}function pU(t){return gi(t[zt])}function Aa(t,e){return e==null?null:t[e]}function KA(t){t[wa]=0}function gU(t){t[te]&1024||(t[te]|=1024,Bv(t)&&kc(t))}function mU(t,e){for(;t>0;)e=e[ka],t--;return e}function QA(t){return t[te]&9216||t[Qs]?.dirty}function Xy(t){QA(t)?kc(t):t[te]&64&&(fU()?(t[te]|=1024,kc(t)):t[zi].changeDetectionScheduler?.notify())}function kc(t){t[zi].changeDetectionScheduler?.notify();let e=Oc(t);for(;e!==null&&!(e[te]&8192||(e[te]|=8192,!Bv(e)));)e=Oc(e)}function YA(t,e){if((t[te]&256)===256)throw new H(911,!1);t[qi]===null&&(t[qi]=[]),t[qi].push(e)}function _U(t,e){if(t[qi]===null)return;let n=t[qi].indexOf(e);n!==-1&&t[qi].splice(n,1)}function Oc(t){let e=t[zt];return gi(e)?e[zt]:e}var he={lFrame:sx(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function yU(){return he.lFrame.elementDepthCount}function vU(){he.lFrame.elementDepthCount++}function wU(){he.lFrame.elementDepthCount--}function ZA(){return he.bindingsEnabled}function EU(){return he.skipHydrationRootTNode!==null}function IU(t){return he.skipHydrationRootTNode===t}function CU(){he.skipHydrationRootTNode=null}function Re(){return he.lFrame.lView}function mn(){return he.lFrame.tView}function qe(t){return he.lFrame.contextLView=t,t[rr]}function Ge(t){return he.lFrame.contextLView=null,t}function Cn(){let t=XA();for(;t!==null&&t.type===64;)t=t.parent;return t}function XA(){return he.lFrame.currentTNode}function DU(){let t=he.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function ro(t,e){let n=he.lFrame;n.currentTNode=t,n.isParent=e}function $v(){return he.lFrame.isParent}function JA(){he.lFrame.isParent=!1}function Hv(){let t=he.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function TU(){return he.lFrame.bindingIndex}function bU(t){return he.lFrame.bindingIndex=t}function ex(){return he.lFrame.bindingIndex++}function tx(t){let e=he.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function SU(){return he.lFrame.inI18n}function AU(t,e){let n=he.lFrame;n.bindingIndex=n.bindingRootIndex=t,Jy(e)}function xU(){return he.lFrame.currentDirectiveIndex}function Jy(t){he.lFrame.currentDirectiveIndex=t}function RU(t){let e=he.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function nx(t){he.lFrame.currentQueryIndex=t}function MU(t){let e=t[ge];return e.type===2?e.declTNode:e.type===1?t[ir]:null}function rx(t,e,n){if(n&le.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&le.Host);)if(i=MU(s),i===null||(s=s[ka],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=he.lFrame=ix();return r.currentTNode=e,r.lView=t,!0}function qv(t){let e=ix(),n=t[ge];he.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function ix(){let t=he.lFrame,e=t===null?null:t.child;return e===null?sx(t):e}function sx(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function ox(){let t=he.lFrame;return he.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var ax=ox;function Gv(){let t=ox();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function NU(t){return(he.lFrame.contextLView=mU(t,he.lFrame.contextLView))[rr]}function io(){return he.lFrame.selectedIndex}function Xs(t){he.lFrame.selectedIndex=t}function ux(){let t=he.lFrame;return zA(t.tView,t.selectedIndex)}function PU(){return he.lFrame.currentNamespace}var cx=!0;function Bf(){return cx}function $f(t){cx=t}function kU(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=$A(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function Hf(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function uf(t,e,n){lx(t,e,3,n)}function cf(t,e,n,r){(t[te]&3)===n&&lx(t,e,n,r)}function Py(t,e){let n=t[te];(n&3)===e&&(n&=16383,n+=1,t[te]=n)}function lx(t,e,n,r){let i=r!==void 0?t[wa]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[wa]+=65536),(a<s||s==-1)&&(OU(t,n,e,u),t[wa]=(t[wa]&4294901760)+u+2),u++}function KS(t,e){Dr(4,t,e);let n=vn(null);try{e.call(t)}finally{vn(n),Dr(5,t,e)}}function OU(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[te]>>14<t[wa]>>16&&(t[te]&3)===e&&(t[te]+=16384,KS(a,s)):KS(a,s)}var Ta=-1,Js=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function FU(t){return t instanceof Js}function VU(t){return(t.flags&8)!==0}function LU(t){return(t.flags&16)!==0}function dx(t){return t!==Ta}function yf(t){return t&32767}function jU(t){return t>>16}function vf(t,e){let n=jU(t),r=e;for(;n>0;)r=r[ka],n--;return r}var ev=!0;function wf(t){let e=ev;return ev=t,e}var UU=256,hx=UU-1,fx=5,BU=0,Tr={};function $U(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(bc)&&(r=n[bc]),r==null&&(r=n[bc]=BU++);let i=r&hx,s=1<<i;e.data[t+(i>>fx)]|=s}function Ef(t,e){let n=px(t,e);if(n!==-1)return n;let r=e[ge];r.firstCreatePass&&(t.injectorIndex=e.length,ky(r.data,t),ky(e,null),ky(r.blueprint,null));let i=zv(t,e),s=t.injectorIndex;if(dx(i)){let o=yf(i),a=vf(i,e),u=a[ge].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function ky(t,e){t.push(0,0,0,0,0,0,0,0,e)}function px(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function zv(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=vx(i),r===null)return Ta;if(n++,i=i[ka],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Ta}function tv(t,e,n){$U(t,e,n)}function gx(t,e,n){if(n&le.Optional||t!==void 0)return t;Lv(e,"NodeInjector")}function mx(t,e,n,r){if(n&le.Optional&&r===void 0&&(r=null),!(n&(le.Self|le.Host))){let i=t[Sa],s=gn(void 0);try{return i?i.get(e,r,n&le.Optional):SA(e,r,n&le.Optional)}finally{gn(s)}}return gx(r,e,n)}function _x(t,e,n,r=le.Default,i){if(t!==null){if(e[te]&2048&&!(r&le.Self)){let o=WU(t,e,n,r,Tr);if(o!==Tr)return o}let s=yx(t,e,n,r,Tr);if(s!==Tr)return s}return mx(e,n,r,i)}function yx(t,e,n,r,i){let s=GU(n);if(typeof s=="function"){if(!rx(e,t,r))return r&le.Host?gx(i,n,r):mx(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&le.Optional))Lv(n);else return o}finally{ax()}}else if(typeof s=="number"){let o=null,a=px(t,e),u=Ta,c=r&le.Host?e[Sr][ir]:null;for((a===-1||r&le.SkipSelf)&&(u=a===-1?zv(t,e):e[a+8],u===Ta||!YS(r,!1)?a=-1:(o=e[ge],a=yf(u),e=vf(u,e)));a!==-1;){let l=e[ge];if(QS(s,a,l.data)){let d=HU(a,e,n,o,r,c);if(d!==Tr)return d}u=e[a+8],u!==Ta&&YS(r,e[ge].data[a+8]===c)&&QS(s,a,e)?(o=l,a=yf(u),e=vf(u,e)):a=-1}}return i}function HU(t,e,n,r,i,s){let o=e[ge],a=o.data[t+8],u=r==null?jf(a)&&ev:r!=o&&(a.type&3)!==0,c=i&le.Host&&s===a,l=qU(a,o,n,u,c);return l!==null?xa(e,o,l,a):Tr}function qU(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,c=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:c;for(let f=d;f<h;f++){let p=o[f];if(f<u&&n===p||f>=u&&p.type===n)return f}if(i){let f=o[u];if(f&&Wi(f)&&f.type===n)return u}return null}function xa(t,e,n,r){let i=t[n],s=e.data;if(FU(i)){let o=i;o.resolving&&Mj(Rj(s[n]));let a=wf(o.canSeeViewProviders);o.resolving=!0;let u,c=o.injectImpl?gn(o.injectImpl):null,l=rx(t,r,le.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&kU(n,s[n],e)}finally{c!==null&&gn(c),wf(a),o.resolving=!1,ax()}}return i}function GU(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(bc)?t[bc]:void 0;return typeof e=="number"?e>=0?e&hx:zU:e}function QS(t,e,n){let r=1<<t;return!!(n[e+(t>>fx)]&r)}function YS(t,e){return!(t&le.Self)&&!(t&le.Host&&e)}var Ks=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return _x(this._tNode,this._lView,e,Ff(r),n)}};function zU(){return new Ks(Cn(),Re())}function Xi(t){return Uc(()=>{let e=t.prototype.constructor,n=e[ff]||nv(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[ff]||nv(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function nv(t){return EA(t)?()=>{let e=nv(Jt(t));return e&&e()}:Zs(t)}function WU(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[te]&2048&&!(o[te]&512);){let a=yx(s,o,n,r|le.Self,Tr);if(a!==Tr)return a;let u=s.parent;if(!u){let c=o[jA];if(c){let l=c.get(n,Tr,r);if(l!==Tr)return l}u=vx(o),o=o[ka]}s=u}return i}function vx(t){let e=t[ge],n=e.type;return n===2?e.declTNode:n===1?t[ir]:null}var rf="__parameters__";function KU(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function wx(t,e,n){return Uc(()=>{let r=KU(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,c,l){let d=u.hasOwnProperty(rf)?u[rf]:Object.defineProperty(u,rf,{value:[]})[rf];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function QU(t){let e=jt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function YU(t){return typeof t=="function"}function Wv(t,e){t.forEach(n=>Array.isArray(n)?Wv(n,e):e(n))}function Ex(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function If(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function ZU(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function XU(t,e,n){let r=Bc(t,e);return r>=0?t[r|1]=n:(r=~r,ZU(t,r,e,n)),r}function Oy(t,e){let n=Bc(t,e);if(n>=0)return t[n|1]}function Bc(t,e){return JU(t,e,1)}function JU(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var so=AA(wx("Optional"),8);var qf=AA(wx("SkipSelf"),4);function eB(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(iB))}return s}return Cf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(c=>{i.template=c}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let c=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[c+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(c=>{a.push(c),i.styleUrl=void 0}));let u=Promise.all(o).then(()=>sB(s));e.push(u)}),nB(),Promise.all(e).then(()=>{})}var Cf=new Map,tB=new Set;function nB(){let t=Cf;return Cf=new Map,t}function rB(){return Cf.size===0}function iB(t){return typeof t=="string"?t:t.text()}function sB(t){tB.delete(t)}var Ra=new P(""),Ix=new P("",-1),Cx=new P(""),Df=class{get(e,n=xc){if(n===xc){let r=new Error(`NullInjectorError: No provider for ${en(e)}!`);throw r.name="NullInjectorError",r}return n}};function oB(...t){return{\u0275providers:Dx(!0,t),\u0275fromNgModule:!0}}function Dx(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return Wv(e,o=>{let a=o;rv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&Tx(i,s),n}function Tx(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];Kv(i,s=>{e(s,r)})}}function rv(t,e,n,r){if(t=Jt(t),!t)return!1;let i=null,s=jS(t),o=!s&&Gi(t);if(!s&&!o){let u=t.ngModule;if(s=jS(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of u)rv(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{Wv(s.imports,l=>{rv(l,e,n,r)&&(c||=[],c.push(l))})}finally{}c!==void 0&&Tx(c,e)}if(!a){let c=Zs(i)||(()=>new i);e({provide:i,useFactory:c,deps:Ln},i),e({provide:Cx,useValue:i,multi:!0},i),e({provide:Ra,useValue:()=>w(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let c=t;Kv(u,l=>{e(l,c)})}}else return!1;return i!==t&&t.providers!==void 0}function Kv(t,e){for(let n of t)IA(n)&&(n=n.\u0275providers),Array.isArray(n)?Kv(n,e):e(n)}var aB=Pe({provide:String,useValue:Pe});function bx(t){return t!==null&&typeof t=="object"&&aB in t}function uB(t){return!!(t&&t.useExisting)}function cB(t){return!!(t&&t.useFactory)}function Ma(t){return typeof t=="function"}function lB(t){return!!t.useClass}var Gf=new P(""),lf={},dB={},Fy;function Qv(){return Fy===void 0&&(Fy=new Df),Fy}var In=class{},Fc=class extends In{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,sv(e,o=>this.processProvider(o)),this.records.set(Ix,Ea(void 0,this)),i.has("environment")&&this.records.set(In,Ea(void 0,this));let s=this.records.get(Gf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Cx,Ln,le.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Hi(this),r=gn(void 0),i;try{return e()}finally{Hi(n),gn(r)}}get(e,n=xc,r=le.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(VS))return e[VS](this);r=Ff(r);let i,s=Hi(this),o=gn(void 0);try{if(!(r&le.SkipSelf)){let u=this.records.get(e);if(u===void 0){let c=mB(e)&&Of(e);c&&this.injectableDefInScope(c)?u=Ea(iv(e),lf):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&le.Self?Qv():this.parent;return n=r&le.Optional&&n===xc?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[pf]=a[pf]||[]).unshift(en(e)),s)throw a;return Hj(a,e,"R3InjectorError",this.source)}else throw a}finally{gn(o),Hi(s)}}resolveInjectorInitializers(){let e=Hi(this),n=gn(void 0),r;try{let i=this.get(Ra,Ln,le.Self);for(let s of i)s()}finally{Hi(e),gn(n)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(en(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new H(205,!1)}processProvider(e){e=Jt(e);let n=Ma(e)?e:Jt(e&&e.provide),r=fB(e);if(!Ma(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Ea(void 0,lf,!0),i.factory=()=>Qy(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===lf&&(n.value=dB,n.value=n.factory()),typeof n.value=="object"&&n.value&&gB(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Jt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function iv(t){let e=Of(t),n=e!==null?e.factory:Zs(t);if(n!==null)return n;if(t instanceof P)throw new H(204,!1);if(t instanceof Function)return hB(t);throw new H(204,!1)}function hB(t){if(t.length>0)throw new H(204,!1);let n=kj(t);return n!==null?()=>n.factory(t):()=>new t}function fB(t){if(bx(t))return Ea(void 0,t.useValue);{let e=Sx(t);return Ea(e,lf)}}function Sx(t,e,n){let r;if(Ma(t)){let i=Jt(t);return Zs(i)||iv(i)}else if(bx(t))r=()=>Jt(t.useValue);else if(cB(t))r=()=>t.useFactory(...Qy(t.deps||[]));else if(uB(t))r=()=>w(Jt(t.useExisting));else{let i=Jt(t&&(t.useClass||t.provide));if(pB(t))r=()=>new i(...Qy(t.deps));else return Zs(i)||iv(i)}return r}function Ea(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function pB(t){return!!t.deps}function gB(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function mB(t){return typeof t=="function"||typeof t=="object"&&t instanceof P}function sv(t,e){for(let n of t)Array.isArray(n)?sv(n,e):n&&IA(n)?sv(n.\u0275providers,e):e(n)}function Ji(t,e){t instanceof Fc&&t.assertNotDestroyed();let n,r=Hi(t),i=gn(void 0);try{return e()}finally{Hi(r),gn(i)}}function _B(t){if(!bA()&&!Uj())throw new H(-203,!1)}function ZS(t,e=null,n=null,r){let i=Ax(t,e,n,r);return i.resolveInjectorInitializers(),i}function Ax(t,e=null,n=null,r,i=new Set){let s=[n||Ln,oB(t)];return r=r||(typeof t=="object"?void 0:en(t)),new Fc(s,e||Qv(),r||null,i)}var or=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return ZS({name:""},i,r,"");{let s=r.name??"";return ZS({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=xc,e.NULL=new Df,e.\u0275prov=V({token:e,providedIn:"any",factory:()=>w(Ix)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var ov;function xx(t){ov=t}function yB(){if(ov!==void 0)return ov;if(typeof document<"u")return document;throw new H(210,!1)}var zf=new P("",{providedIn:"root",factory:()=>vB}),vB="ng",Yv=new P(""),St=new P("",{providedIn:"platform",factory:()=>"unknown"});var Zv=new P("",{providedIn:"root",factory:()=>yB().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function Rx(t){return t instanceof Function?t():t}function wB(t){return(t??O(or)).get(St)==="browser"}function Mx(t){return(t.flags&128)===128}var hi=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(hi||{}),EB=/^>|^->|<!--|-->|--!>|<!-$/g,IB=/(<|>)/g,CB="\u200B$1\u200B";function DB(t){return t.replace(EB,e=>e.replace(IB,CB))}var Nx=new Map,TB=0;function bB(){return TB++}function SB(t){Nx.set(t[Lf],t)}function AB(t){Nx.delete(t[Lf])}var XS="__ngContext__";function Ki(t,e){Ws(e)?(t[XS]=e[Lf],SB(e)):t[XS]=e}var xB;function Xv(t,e){return xB(t,e)}function Ia(t,e,n,r,i){if(r!=null){let s,o=!1;gi(r)?s=r:Ws(r)&&(o=!0,r=r[pi]);let a=Ar(r);t===0&&n!==null?i==null?Vx(e,n,a):Tf(e,n,a,i||null,!0):t===1&&n!==null?Tf(e,n,a,i||null,!0):t===2?WB(e,a,o):t===3&&e.destroyNode(a),s!=null&&QB(e,t,s,n,i)}}function RB(t,e){return t.createText(e)}function MB(t,e,n){t.setValue(e,n)}function NB(t,e){return t.createComment(DB(e))}function Px(t,e,n){return t.createElement(e,n)}function PB(t,e){kx(t,e),e[pi]=null,e[ir]=null}function kB(t,e,n,r,i,s){r[pi]=i,r[ir]=e,Kf(t,r,n,1,i,s)}function kx(t,e){Kf(t,e,e[bt],2,null,null)}function OB(t){let e=t[Nc];if(!e)return Vy(t[ge],t);for(;e;){let n=null;if(Ws(e))n=e[Nc];else{let r=e[jn];r&&(n=r)}if(!n){for(;e&&!e[nr]&&e!==t;)Ws(e)&&Vy(e[ge],e),e=e[zt];e===null&&(e=t),Ws(e)&&Vy(e[ge],e),n=e&&e[nr]}e=n}}function FB(t,e,n,r){let i=jn+r,s=n.length;r>0&&(n[i-1][nr]=e),r<s-jn?(e[nr]=n[i],Ex(n,jn+r,e)):(n.push(e),e[nr]=null),e[zt]=n;let o=e[Vf];o!==null&&n!==o&&VB(o,e);let a=e[Pc];a!==null&&a.insertView(t),Xy(e),e[te]|=128}function VB(t,e){let n=t[_f],i=e[zt][zt][Sr];e[Sr]!==i&&(t[te]|=jv.HasTransplantedViews),n===null?t[_f]=[e]:n.push(e)}function Ox(t,e){let n=t[_f],r=n.indexOf(e);n.splice(r,1)}function av(t,e){if(t.length<=jn)return;let n=jn+e,r=t[n];if(r){let i=r[Vf];i!==null&&i!==t&&Ox(i,r),e>0&&(t[n-1][nr]=r[nr]);let s=If(t,jn+e);PB(r[ge],r);let o=s[Pc];o!==null&&o.detachView(s[ge]),r[zt]=null,r[nr]=null,r[te]&=-129}return r}function Fx(t,e){if(!(e[te]&256)){let n=e[bt];n.destroyNode&&Kf(t,e,n,3,null,null),OB(e)}}function Vy(t,e){if(!(e[te]&256)){e[te]&=-129,e[te]|=256,e[Qs]&&pS(e[Qs]),jB(t,e),LB(t,e),e[ge].type===1&&e[bt].destroy();let n=e[Vf];if(n!==null&&gi(e[zt])){n!==e[zt]&&Ox(n,e);let r=e[Pc];r!==null&&r.detachView(t)}AB(e)}}function LB(t,e){let n=t.cleanup,r=e[Mc];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Mc]=null);let i=e[qi];if(i!==null){e[qi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function jB(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Js)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];Dr(4,a,u);try{u.call(a)}finally{Dr(5,a,u)}}else{Dr(4,i,s);try{s.call(i)}finally{Dr(5,i,s)}}}}}function UB(t,e,n){return BB(t,e.parent,n)}function BB(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[pi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===br.None||s===br.Emulated)return null}return sr(r,n)}}function Tf(t,e,n,r,i){t.insertBefore(e,n,r,i)}function Vx(t,e,n){t.appendChild(e,n)}function JS(t,e,n,r,i){r!==null?Tf(t,e,n,r,i):Vx(t,e,n)}function $B(t,e,n,r){t.removeChild(e,n,r)}function Jv(t,e){return t.parentNode(e)}function HB(t,e){return t.nextSibling(e)}function qB(t,e,n){return zB(t,e,n)}function GB(t,e,n){return t.type&40?sr(t,n):null}var zB=GB,eA;function Wf(t,e,n,r){let i=UB(t,r,e),s=e[bt],o=r.parent||e[ir],a=qB(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)JS(s,i,n[u],a,!1);else JS(s,i,n,a,!1);eA!==void 0&&eA(s,r,e,n,i)}function df(t,e){if(e!==null){let n=e.type;if(n&3)return sr(e,t);if(n&4)return uv(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return df(t,r);{let i=t[e.index];return gi(i)?uv(-1,i):Ar(i)}}else{if(n&32)return Xv(e,t)()||Ar(t[e.index]);{let r=Lx(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Oc(t[Sr]);return df(i,r)}else return df(t,e.next)}}}return null}function Lx(t,e){if(e!==null){let r=t[Sr][ir],i=e.projection;return r.projection[i]}return null}function uv(t,e){let n=jn+t+1;if(n<e.length){let r=e[n],i=r[ge].firstChild;if(i!==null)return df(r,i)}return e[Ys]}function WB(t,e,n){let r=Jv(t,e);r&&$B(t,r,e,n)}function ew(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&Ki(Ar(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)ew(t,e,n.child,r,i,s,!1),Ia(e,t,i,a,s);else if(u&32){let c=Xv(n,r),l;for(;l=c();)Ia(e,t,i,l,s);Ia(e,t,i,a,s)}else u&16?KB(t,e,r,n,i,s):Ia(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Kf(t,e,n,r,i,s){ew(n,r,t.firstChild,e,i,s,!1)}function KB(t,e,n,r,i,s){let o=n[Sr],u=o[ir].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++){let l=u[c];Ia(e,t,i,l,s)}else{let c=u,l=o[zt];Mx(r)&&(c.flags|=128),ew(t,e,c,l,i,s,!0)}}function QB(t,e,n,r,i){let s=n[Ys],o=Ar(n);s!==o&&Ia(e,t,r,s,i);for(let a=jn;a<n.length;a++){let u=n[a];Kf(u[ge],u,t,e,r,s)}}function YB(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:hi.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=hi.Important),t.setStyle(n,r,i,s))}}function ZB(t,e,n){t.setAttribute(e,"style",n)}function jx(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function Ux(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&Yy(t,e,r),i!==null&&jx(t,e,i),s!==null&&ZB(t,e,s)}var cv=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Cj})`}};function tw(t){return t instanceof cv?t.changingThisBreaksApplicationSecurity:t}var lv=class{};var XB="h",JB="b";var e$=()=>null;function nw(t,e,n=!1){return e$(t,e,n)}var dv=class{},bf=class{};function t$(t){let e=Error(`No component factory found for ${en(t)}.`);return e[n$]=t,e}var n$="ngComponent";var hv=class{resolveComponentFactory(e){throw t$(e)}},Qf=(()=>{let e=class e{};e.NULL=new hv;let t=e;return t})();function r$(){return Yf(Cn(),Re())}function Yf(t,e){return new Nr(sr(t,e))}var Nr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=r$;let t=e;return t})();var Vc=class{},mi=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>i$();let t=e;return t})();function i$(){let t=Re(),e=Cn(),n=Zi(e.index,t);return(Ws(n)?n:t)[bt]}var s$=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),Ly={};function Bx(t){return rw(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function o$(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function rw(t){return t!==null&&(typeof t=="function"||typeof t=="object")}var fv=class{constructor(){}supports(e){return Bx(e)}create(e){return new pv(e)}},a$=(t,e)=>e,pv=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||a$}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<tA(r,i,s)?n:r,a=tA(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let c=a-i,l=u-i;if(c!=l){for(let h=0;h<c;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<c&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-c}}a!==u&&e(o,a,u)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!Bx(e))throw new H(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,o$(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new gv(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Sf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Sf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},gv=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},mv=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Sf=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new mv,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function tA(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}var _v=class{constructor(){}supports(e){return e instanceof Map||rw(e)}create(){return new yv}},yv=class{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(e){let n;for(n=this._mapHead;n!==null;n=n._next)e(n)}forEachPreviousItem(e){let n;for(n=this._previousMapHead;n!==null;n=n._nextPrevious)e(n)}forEachChangedItem(e){let n;for(n=this._changesHead;n!==null;n=n._nextChanged)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}diff(e){if(!e)e=new Map;else if(!(e instanceof Map||rw(e)))throw new H(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(n&&n.key===i)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{let s=this._getOrCreateRecordForKey(i,r);n=this._insertBeforeOrAppend(n,s)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;r!==null;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,n){if(e){let r=e._prev;return n._next=e,n._prev=r,e._prev=n,r&&(r._next=n),e===this._mapHead&&(this._mapHead=n),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(e,n){if(this._records.has(e)){let i=this._records.get(e);this._maybeAddToChanges(i,n);let s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}let r=new vv(e);return this._records.set(e,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;e!==null;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;e!=null;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,n){Object.is(n,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=n,this._addToChanges(e))}_addToAdditions(e){this._additionsHead===null?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){this._changesHead===null?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,n){e instanceof Map?e.forEach(n):Object.keys(e).forEach(r=>n(e[r],r))}},vv=class{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}};function nA(){return new iw([new fv])}var iw=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||nA()),deps:[[e,new qf,new so]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new H(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:nA});let t=e;return t})();function rA(){return new sw([new _v])}var sw=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||rA()),deps:[[e,new qf,new so]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i)return i;throw new H(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:rA});let t=e;return t})();function Af(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(Ar(s)),gi(s)&&u$(s,r);let o=n.type;if(o&8)Af(t,e,n.child,r);else if(o&32){let a=Xv(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=Lx(e,n);if(Array.isArray(a))r.push(...a);else{let u=Oc(e[Sr]);Af(u[ge],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function u$(t,e){for(let n=jn;n<t.length;n++){let r=t[n],i=r[ge].firstChild;i!==null&&Af(r[ge],r,i,e)}t[Ys]!==t[pi]&&e.push(t[Ys])}var $x=[];function c$(t){return t[Qs]??l$(t)}function l$(t){let e=$x.pop()??Object.create(h$);return e.lView=t,e}function d$(t){t.lView[Qs]!==t&&(t.lView=null,$x.push(t))}var h$=Ce(N({},dS),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{kc(t.lView)},consumerOnSignalRead(){this.lView[Qs]=this}});function Hx(t){return Gx(t[Nc])}function qx(t){return Gx(t[nr])}function Gx(t){for(;t!==null&&!gi(t);)t=t[nr];return t}var f$="ngOriginalError";function jy(t){return t[f$]}var xr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&jy(e);for(;n&&jy(n);)n=jy(n);return n||null}},zx=new P("",{providedIn:"root",factory:()=>O(xr).handleError.bind(void 0)});var Wx=!1,p$=new P("",{providedIn:"root",factory:()=>Wx});var Pr={};function L(t=1){Kx(mn(),Re(),io()+t,!1)}function Kx(t,e,n,r){if(!r)if((e[te]&3)===3){let s=t.preOrderCheckHooks;s!==null&&uf(e,s,n)}else{let s=t.preOrderHooks;s!==null&&cf(e,s,0,n)}Xs(n)}function K(t,e=le.Default){let n=Re();if(n===null)return w(t,e);let r=Cn();return _x(r,n,Jt(t),e)}function Qx(){let t="invalid";throw new Error(t)}function Yx(t,e,n,r,i,s){let o=vn(null);try{let a=null;i&En.SignalBased&&(a=e[r][lS]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&En.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):BA(e,a,r,s)}finally{vn(o)}}function g$(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Xs(~i);else{let s=i,o=n[++r],a=n[++r];AU(o,s);let u=e[s];a(2,u)}}}finally{Xs(-1)}}function Zf(t,e,n,r,i,s,o,a,u,c,l){let d=e.blueprint.slice();return d[pi]=i,d[te]=r|4|128|8|64,(c!==null||t&&t[te]&2048)&&(d[te]|=2048),KA(d),d[zt]=d[ka]=t,d[rr]=n,d[zi]=o||t&&t[zi],d[bt]=a||t&&t[bt],d[Sa]=u||t&&t[Sa]||null,d[ir]=s,d[Lf]=bB(),d[gf]=l,d[jA]=c,d[Sr]=e.type==2?t[Sr]:d,d}function $c(t,e,n,r,i){let s=t.data[e];if(s===null)s=m$(t,e,n,r,i),SU()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=DU();s.injectorIndex=o===null?-1:o.injectorIndex}return ro(s,!0),s}function m$(t,e,n,r,i){let s=XA(),o=$v(),a=o?s:s&&s.parent,u=t.data[e]=E$(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function Zx(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Xx(t,e,n,r,i){let s=io(),o=r&2;try{Xs(-1),o&&e.length>Un&&Kx(t,e,Un,!1),Dr(o?2:0,i),n(r,i)}finally{Xs(s),Dr(o?3:1,i)}}function ow(t,e,n){if(Uv(e)){let r=vn(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{vn(r)}}}function aw(t,e,n){ZA()&&(S$(t,e,n,sr(n,e)),(n.flags&64)===64&&nR(t,e,n))}function uw(t,e,n=sr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function Jx(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=cw(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function cw(t,e,n,r,i,s,o,a,u,c,l){let d=Un+r,h=d+i,f=_$(d,h),p=typeof c=="function"?c():c;return f[ge]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:p,incompleteFirstPass:!1,ssrId:l}}function _$(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:Pr);return n}function y$(t,e,n,r){let s=r.get(p$,Wx)||n===br.ShadowDom,o=t.selectRootElement(e,s);return v$(o),o}function v$(t){w$(t)}var w$=()=>null;function E$(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return EU()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function iA(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=En.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let c=s;if(i!==null){if(!i.hasOwnProperty(s))continue;c=i[s]}t===0?sA(r,n,c,a,u):sA(r,n,c,a)}return r}function sA(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function I$(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,c=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;u=iA(0,d.inputs,l,u,f),c=iA(1,d.outputs,l,c,p);let g=u!==null&&o!==null&&!NA(e)?F$(u,l,o):null;a.push(g)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}function C$(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function eR(t,e,n,r,i,s,o,a){let u=sr(e,n),c=e.inputs,l;!a&&c!=null&&(l=c[r])?(dw(t,n,l,r,i),jf(e)&&D$(n,e.index)):e.type&3?(r=C$(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function D$(t,e){let n=Zi(e,t);n[te]&16||(n[te]|=64)}function lw(t,e,n,r){if(ZA()){let i=r===null?null:{"":-1},s=x$(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&tR(t,e,n,o,i,a),i&&R$(n,r,i)}n.mergedAttrs=Rc(n.mergedAttrs,n.attrs)}function tR(t,e,n,r,i,s){for(let c=0;c<r.length;c++)tv(Ef(n,e),t,r[c].type);N$(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=Zx(t,e,r.length,null);for(let c=0;c<r.length;c++){let l=r[c];n.mergedAttrs=Rc(n.mergedAttrs,l.hostAttrs),P$(t,n,e,u,l),M$(u,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}I$(t,n,s)}function T$(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;b$(o)!=a&&o.push(a),o.push(n,r,s)}}function b$(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function S$(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;jf(n)&&k$(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Ef(n,e),Ki(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],c=xa(e,t,a,n);if(Ki(c,e),o!==null&&O$(e,a-i,c,u,n,o),Wi(u)){let l=Zi(n.index,e);l[rr]=xa(e,t,a,n)}}}function nR(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=xU();try{Xs(s);for(let a=r;a<i;a++){let u=t.data[a],c=e[a];Jy(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&A$(u,c)}}finally{Xs(-1),Jy(o)}}function A$(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function x$(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(Zj(e,o.selectors,!1))if(r||(r=[]),Wi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;wv(t,e,u)}else r.unshift(o),wv(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function wv(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function R$(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new H(-301,!1);r.push(e[i],s)}}}function M$(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Wi(e)&&(n[""]=t)}}function N$(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function P$(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Zs(i.type,!0)),o=new Js(s,Wi(i),K);t.blueprint[r]=o,n[r]=o,T$(t,e,r,Zx(t,n,i.hostVars,Pr),i)}function k$(t,e,n){let r=sr(e,t),i=Jx(n),s=t[zi].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=Xf(t,Zf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function O$(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],c=o[a++],l=o[a++],d=o[a++];Yx(r,n,u,c,l,d)}}function F$(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function rR(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function iR(t,e){let n=t.contentQueries;if(n!==null){let r=vn(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];nx(s),a.contentQueries(2,e[o],o)}}}finally{vn(r)}}}function Xf(t,e){return t[Nc]?t[zS][nr]=e:t[Nc]=e,t[zS]=e,e}function Ev(t,e,n){nx(0);let r=vn(null);try{e(t,n)}finally{vn(r)}}function V$(t){return t[Mc]||(t[Mc]=[])}function L$(t){return t.cleanup||(t.cleanup=[])}function sR(t,e){let n=t[Sa],r=n?n.get(xr,null):null;r&&r.handleError(e)}function dw(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=n[s++],c=e[o],l=t.data[o];Yx(l,c,r,a,u,i)}}function oR(t,e,n){let r=GA(e,t);MB(t[bt],r,n)}var j$=100;function U$(t,e=!0){let n=t[zi],r=n.rendererFactory,i=!1;i||r.begin?.();try{B$(t)}catch(s){throw e&&sR(t,s),s}finally{i||(r.end?.(),n.inlineEffectRunner?.flush())}}function B$(t){Iv(t,0);let e=0;for(;QA(t);){if(e===j$)throw new H(103,!1);e++,Iv(t,1)}}function $$(t,e,n,r){let i=e[te];if((i&256)===256)return;let s=!1;!s&&e[zi].inlineEffectRunner?.flush(),qv(e);let o=null,a=null;!s&&H$(t)&&(a=c$(e),o=hS(a));try{KA(e),bU(t.bindingStartIndex),n!==null&&Xx(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let d=t.preOrderCheckHooks;d!==null&&uf(e,d,null)}else{let d=t.preOrderHooks;d!==null&&cf(e,d,0,null),Py(e,0)}if(q$(e),aR(e,0),t.contentQueries!==null&&iR(t,e),!s)if(u){let d=t.contentCheckHooks;d!==null&&uf(e,d)}else{let d=t.contentHooks;d!==null&&cf(e,d,1),Py(e,1)}g$(t,e);let c=t.components;c!==null&&cR(e,c,0);let l=t.viewQuery;if(l!==null&&Ev(2,l,r),!s)if(u){let d=t.viewCheckHooks;d!==null&&uf(e,d)}else{let d=t.viewHooks;d!==null&&cf(e,d,2),Py(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[Ny]){for(let d of e[Ny])d();e[Ny]=null}s||(e[te]&=-73)}catch(u){throw kc(e),u}finally{a!==null&&(fS(a,o),d$(a)),Gv()}}function H$(t){return t.type!==2}function aR(t,e){for(let n=Hx(t);n!==null;n=qx(n))for(let r=jn;r<n.length;r++){let i=n[r];uR(i,e)}}function q$(t){for(let e=Hx(t);e!==null;e=qx(e)){if(!(e[te]&jv.HasTransplantedViews))continue;let n=e[_f];for(let r=0;r<n.length;r++){let i=n[r],s=i[zt];gU(i)}}}function G$(t,e,n){let r=Zi(e,t);uR(r,n)}function uR(t,e){Bv(t)&&Iv(t,e)}function Iv(t,e){let r=t[ge],i=t[te],s=t[Qs],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&cy(s)),s&&(s.dirty=!1),t[te]&=-9217,o)$$(r,t,r.template,t[rr]);else if(i&8192){aR(t,1);let a=r.components;a!==null&&cR(t,a,1)}}function cR(t,e,n){for(let r=0;r<e.length;r++)G$(t,e[r],n)}function hw(t){for(t[zi].changeDetectionScheduler?.notify();t;){t[te]|=64;let e=Oc(t);if(oU(t)&&!e)return t;t=e}return null}var eo=class{get rootNodes(){let e=this._lView,n=e[ge];return Af(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[rr]}set context(e){this._lView[rr]=e}get destroyed(){return(this._lView[te]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[zt];if(gi(e)){let n=e[mf],r=n?n.indexOf(this):-1;r>-1&&(av(e,r),If(n,r))}this._attachedToViewContainer=!1}Fx(this._lView[ge],this._lView)}onDestroy(e){YA(this._lView,e)}markForCheck(){hw(this._cdRefInjectingView||this._lView)}detach(){this._lView[te]&=-129}reattach(){Xy(this._lView),this._lView[te]|=128}detectChanges(){this._lView[te]|=1024,U$(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new H(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,kx(this._lView[ge],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new H(902,!1);this._appRef=e,Xy(this._lView)}},_i=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=z$;let t=e;return t})();function z$(t){return W$(Cn(),Re(),(t&16)===16)}function W$(t,e,n){if(jf(t)&&!n){let r=Zi(t.index,e);return new eo(r,r)}else if(t.type&47){let r=e[Sr];return new eo(r,e)}return null}var lR=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=K$,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),Cv=class extends lR{constructor(e){super(),this._lView=e}onDestroy(e){return YA(this._lView,e),()=>_U(this._lView,e)}};function K$(){return new Cv(Re())}var oA=new Set;function fw(t){oA.has(t)||(oA.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var Dv=class extends wt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=Uy(s),i&&(i=Uy(i)),o&&(o=Uy(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof it&&e.add(a),a}};function Uy(t){return e=>{setTimeout(t,void 0,e)}}var It=Dv;function aA(...t){}function Q$(){let t=typeof jt.requestAnimationFrame=="function",e=jt[t?"requestAnimationFrame":"setTimeout"],n=jt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var de=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new It(!1),this.onMicrotaskEmpty=new It(!1),this.onStable=new It(!1),this.onError=new It(!1),typeof Zone>"u")throw new H(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=Q$().nativeRequestAnimationFrame,X$(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new H(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new H(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,Y$,aA,aA);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},Y$={};function pw(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Z$(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(jt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Tv(t),t.isCheckStableRunning=!0,pw(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Tv(t))}function X$(t){let e=()=>{Z$(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(J$(a))return n.invokeTask(i,s,o,a);try{return uA(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),cA(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return uA(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),cA(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,Tv(t),pw(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function Tv(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function uA(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function cA(t){t._nesting--,pw(t)}var bv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new It,this.onMicrotaskEmpty=new It,this.onStable=new It,this.onError=new It}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function J$(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function eH(t="zone.js",e){return t==="noop"?new bv:t==="zone.js"?new de(e):t}var Ca=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Ca||{}),tH={destroy(){}};function gw(t,e){!e&&_B(gw);let n=e?.injector??O(or);if(!wB(n))return tH;fw("NgAfterNextRender");let r=n.get(mw),i=r.handler??=new Av,s=e?.phase??Ca.MixedReadWrite,o=()=>{i.unregister(u),a()},a=n.get(lR).onDestroy(o),u=new Sv(n,s,()=>{o(),t()});return i.register(u),{destroy:o}}var Sv=class{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(de),this.errorHandler=e.get(xr,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Av=class{constructor(){this.executingCallbacks=!1,this.buckets={[Ca.EarlyRead]:new Set,[Ca.Write]:new Set,[Ca.MixedReadWrite]:new Set,[Ca.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){let e=!1;this.executingCallbacks=!0;for(let n of Object.values(this.buckets))for(let r of n)e=!0,r.invoke();this.executingCallbacks=!1;for(let n of this.deferredCallbacks)this.buckets[n.phase].add(n);return this.deferredCallbacks.clear(),e}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},mw=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let s of r)s();return!!this.handler?.execute()||r.length>0}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function nH(t,e){let n=Zi(e,t),r=n[ge];rH(r,n);let i=n[pi];i!==null&&n[gf]===null&&(n[gf]=nw(i,n[Sa])),_w(r,n,n[rr])}function rH(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function _w(t,e,n){qv(e);try{let r=t.viewQuery;r!==null&&Ev(1,r,n);let i=t.template;i!==null&&Xx(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&iR(t,e),t.staticViewQueries&&Ev(2,t.viewQuery,n);let s=t.components;s!==null&&iH(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[te]&=-5,Gv()}}function iH(t,e){for(let n=0;n<e.length;n++)nH(t,e[n])}function xf(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=FS(i,a);else if(s==2){let u=a,c=e[++o];r=FS(r,u+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Rf=class extends Qf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Gi(e);return new Na(n,this.ngModule)}};function lA(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function sH(t){let e=t.toLowerCase();return e==="svg"?lU:e==="math"?dU:null}var xv=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Ff(r);let i=this.injector.get(e,Ly,r);return i!==Ly||n===Ly?i:this.parentInjector.get(e,n,r)}},Na=class extends bf{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=lA(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return lA(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=tU(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){i=i||this.ngModule;let s=i instanceof In?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let o=s?new xv(e,s):e,a=o.get(Vc,null);if(a===null)throw new H(407,!1);let u=o.get(s$,null),c=o.get(mw,null),l=o.get(lv,null),d={rendererFactory:a,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:c,changeDetectionScheduler:l},h=a.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=r?y$(h,r,this.componentDef.encapsulation,o):Px(h,f,sH(f)),g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let m=null;p!==null&&(m=nw(p,o,!0));let I=cw(0,null,null,1,0,null,null,null,null,null,null),A=Zf(null,I,null,g,null,null,d,h,o,null,m);qv(A);let D,k;try{let q=this.componentDef,W,xe=null;q.findHostDirectiveDefs?(W=[],xe=new Map,q.findHostDirectiveDefs(q,W,xe),W.push(q)):W=[q];let Dt=oH(A,p),js=aH(Dt,p,q,W,A,d,h);k=zA(I,Un),p&&lH(h,q,p,r),n!==void 0&&dH(k,this.ngContentSelectors,n),D=cH(js,q,W,xe,A,[hH]),_w(I,A,null)}finally{Gv()}return new Rv(this.componentType,D,Yf(k,A),A,k)}},Rv=class extends dv{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new eo(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;dw(s[ge],s,i,e,n),this.previousInputValues.set(e,n);let o=Zi(this._tNode.index,s);hw(o)}}get injector(){return new Ks(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function oH(t,e){let n=t[ge],r=Un;return t[r]=e,$c(n,r,2,"#host",null)}function aH(t,e,n,r,i,s,o){let a=i[ge];uH(r,t,e,o);let u=null;e!==null&&(u=nw(e,i[Sa]));let c=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=Zf(i,Jx(n),null,l,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&wv(a,t,r.length-1),Xf(i,d),i[t.index]=d}function uH(t,e,n,r){for(let i of t)e.mergedAttrs=Rc(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(xf(e,e.mergedAttrs,!0),n!==null&&Ux(r,n,e))}function cH(t,e,n,r,i,s){let o=Cn(),a=i[ge],u=sr(o,i);tR(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=xa(i,a,d,o);Ki(h,i)}nR(a,i,o),u&&Ki(u,i);let c=xa(i,a,o.directiveStart+o.componentOffset,o);if(t[rr]=i[rr]=c,s!==null)for(let l of s)l(c,e);return ow(a,o,t),c}function lH(t,e,n,r){if(r)Yy(t,n,["ng-version","17.1.2"]);else{let{attrs:i,classes:s}=nU(e.selectors[0]);i&&Yy(t,n,i),s&&s.length>0&&jx(t,n,s.join(" "))}}function dH(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function hH(){let t=Cn();Hf(Re()[ge],t)}function fH(t){return Object.getPrototypeOf(t.prototype).constructor}function yi(t){let e=fH(t.type),n=!0,r=[t];for(;e;){let i;if(Wi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new H(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=sf(t.inputs),o.inputTransforms=sf(t.inputTransforms),o.declaredInputs=sf(t.declaredInputs),o.outputs=sf(t.outputs);let a=i.hostBindings;a&&yH(t,a);let u=i.viewQuery,c=i.contentQueries;if(u&&mH(t,u),c&&_H(t,c),pH(t,i),Dj(t.outputs,i.outputs),Wi(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===yi&&(n=!1)}}e=Object.getPrototypeOf(e)}gH(r)}function pH(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function gH(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Rc(i.hostAttrs,n=Rc(n,i.hostAttrs))}}function sf(t){return t===ba?{}:t===Ln?[]:t}function mH(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function _H(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function yH(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}var Are=new RegExp(`^(\\d+)*(${JB}|${XB})*(.*)`);var vH=()=>null;function dA(t,e){return vH(t,e)}function wH(t,e,n,r){let i=e.tView,o=t[te]&4096?4096:16,a=Zf(t,i,n,o,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),u=t[e.index];a[Vf]=u;let c=t[Pc];return c!==null&&(a[Pc]=c.createEmbeddedView(i)),_w(i,a,n),a}function hA(t,e){return!e||e.firstChild===null||Mx(t)}function EH(t,e,n,r=!0){let i=e[ge];if(FB(i,e,t,n),r){let o=uv(n,t),a=e[bt],u=Jv(a,t[Ys]);u!==null&&kB(i,t[ir],a,e,u,o)}let s=e[gf];s!==null&&s.firstChild!==null&&(s.firstChild=null)}var Fa=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=IH;let t=e;return t})();function IH(){let t=Cn();return DH(t,Re())}var CH=Fa,dR=class extends CH{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Yf(this._hostTNode,this._hostLView)}get injector(){return new Ks(this._hostTNode,this._hostLView)}get parentInjector(){let e=zv(this._hostTNode,this._hostLView);if(dx(e)){let n=vf(e,this._hostLView),r=yf(e),i=n[ge].data[r+8];return new Ks(i,n)}else return new Ks(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=fA(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-jn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=dA(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,hA(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!YU(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let u=o?e:new Na(Gi(e)),c=r||this.parentInjector;if(!s&&u.ngModule==null){let g=(o?c:this.parentInjector).get(In,null);g&&(s=g)}let l=Gi(u.componentType??{}),d=dA(this._lContainer,l?.id??null),h=d?.firstChild??null,f=u.create(c,i,h,s);return this.insertImpl(f.hostView,a,hA(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(pU(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[zt],c=new dR(u,u[ir],u[zt]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return EH(o,i,s,r),e.attachToViewContainerRef(),Ex(By(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=fA(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=av(this._lContainer,n);r&&(If(By(this._lContainer),n),Fx(r[ge],r))}detach(e){let n=this._adjustIndex(e,-1),r=av(this._lContainer,n);return r&&If(By(this._lContainer),n)!=null?new eo(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function fA(t){return t[mf]}function By(t){return t[mf]||(t[mf]=[])}function DH(t,e){let n,r=e[t.index];return gi(r)?n=r:(n=rR(r,e,null,t),e[t.index]=n,Xf(e,n)),bH(n,e,t,r),new dR(n,t,e)}function TH(t,e){let n=t[bt],r=n.createComment(""),i=sr(e,t),s=Jv(n,i);return Tf(n,s,r,HB(n,i),!1),r}var bH=xH,SH=()=>!1;function AH(t,e,n){return SH(t,e,n)}function xH(t,e,n,r){if(t[Ys])return;let i;n.type&8?i=Ar(r):i=TH(e,n),t[Ys]=i}function yw(t,e,n){return t[e]=n}function to(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function hR(t,e,n,r){let i=to(t,e,n);return to(t,e+1,r)||i}function fR(t,e,n,r,i){let s=hR(t,e,n,r);return to(t,e+2,i)||s}function RH(t,e,n,r,i,s,o,a,u){let c=e.consts,l=$c(e,t,4,o||null,Aa(c,a));lw(e,n,l,Aa(c,u)),Hf(e,l);let d=l.tView=cw(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function et(t,e,n,r,i,s,o,a){let u=Re(),c=mn(),l=t+Un,d=c.firstCreatePass?RH(l,c,u,e,n,r,i,s,o):c.data[l];ro(d,!1);let h=MH(c,u,d,t);Bf()&&Wf(c,u,h,d),Ki(h,u);let f=rR(h,u,h,d);return u[l]=f,Xf(u,f),AH(f,d,u),Uf(d)&&aw(c,u,d),o!=null&&uw(u,d,a),et}var MH=NH;function NH(t,e,n,r){return $f(!0),e[bt].createComment("")}function pR(t,e,n,r){return to(t,ex(),n)?e+Sc(n)+r:Pr}function PH(t,e,n,r,i,s,o,a){let u=TU(),c=fR(t,u,n,i,o);return tx(3),c?e+Sc(n)+r+Sc(i)+s+Sc(o)+a:Pr}function of(t,e){return t<<17|e<<2}function no(t){return t>>17&32767}function kH(t){return(t&2)==2}function OH(t,e){return t&131071|e<<17}function Mv(t){return t|2}function Pa(t){return(t&131068)>>2}function $y(t,e){return t&-131069|e<<2}function FH(t){return(t&1)===1}function Nv(t){return t|1}function VH(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=no(o),u=Pa(o);t[r]=n;let c=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||Bc(d,l)>0)&&(c=!0)}else l=n;if(i)if(u!==0){let h=no(t[a+1]);t[r+1]=of(h,a),h!==0&&(t[h+1]=$y(t[h+1],r)),t[a+1]=OH(t[a+1],r)}else t[r+1]=of(a,0),a!==0&&(t[a+1]=$y(t[a+1],r)),a=r;else t[r+1]=of(u,0),a===0?a=r:t[u+1]=$y(t[u+1],r),u=r;c&&(t[r+1]=Mv(t[r+1])),pA(t,l,r,!0),pA(t,l,r,!1),LH(e,l,t,r,s),o=of(a,u),s?e.classBindings=o:e.styleBindings=o}function LH(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Bc(s,e)>=0&&(n[r+1]=Nv(n[r+1]))}function pA(t,e,n,r){let i=t[n+1],s=e===null,o=r?no(i):Pa(i),a=!1;for(;o!==0&&(a===!1||s);){let u=t[o],c=t[o+1];jH(u,e)&&(a=!0,t[o+1]=r?Nv(c):Mv(c)),o=r?no(c):Pa(c)}a&&(t[n+1]=r?Mv(i):Nv(i))}function jH(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Bc(t,e)>=0:!1}function Q(t,e,n){let r=Re(),i=ex();if(to(r,i,e)){let s=mn(),o=ux();eR(s,o,r,t,e,r[bt],n,!1)}return Q}function gA(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";dw(t,n,s[o],o,r)}function vw(t,e){return UH(t,e,null,!0),vw}function UH(t,e,n,r){let i=Re(),s=mn(),o=tx(2);if(s.firstUpdatePass&&$H(s,t,o,r),e!==Pr&&to(i,o,e)){let a=s.data[io()];WH(s,a,i,i[bt],t,i[o+1]=KH(e,n),r,o)}}function BH(t,e){return e>=t.expandoStartIndex}function $H(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[io()],o=BH(t,n);QH(s,r)&&e===null&&!o&&(e=!1),e=HH(i,s,e,r),VH(i,s,e,n,o,r)}}function HH(t,e,n,r){let i=RU(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Hy(null,t,e,n,r),n=Lc(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Hy(i,t,e,n,r),s===null){let u=qH(t,e,r);u!==void 0&&Array.isArray(u)&&(u=Hy(null,t,e,u[1],r),u=Lc(u,e.attrs,r),GH(t,e,r,u))}else s=zH(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function qH(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Pa(r)!==0)return t[no(r)]}function GH(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[no(i)]=r}function zH(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Lc(r,o,n)}return Lc(r,e.attrs,n)}function Hy(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Lc(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Lc(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),XU(t,o,n?!0:e[++s]))}return t===void 0?null:t}function WH(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let u=t.data,c=u[a+1],l=FH(c)?mA(u,e,n,i,Pa(c),o):void 0;if(!Mf(l)){Mf(s)||kH(c)&&(s=mA(u,null,n,i,a,o));let d=GA(io(),n);YB(r,o,d,i,s)}}function mA(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=l===null,h=n[i+1];h===Pr&&(h=d?Ln:void 0);let f=d?Oy(h,r):l===r?h:void 0;if(c&&!Mf(f)&&(f=Oy(u,r)),Mf(f)&&(a=f,o))return a;let p=t[i+1];i=o?no(p):Pa(p)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=Oy(u,r))}return a}function Mf(t){return t!==void 0}function KH(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=en(tw(t)))),t}function QH(t,e){return(t.flags&(e?8:16))!==0}function YH(t,e,n,r,i,s){let o=e.consts,a=Aa(o,i),u=$c(e,t,2,r,a);return lw(e,n,u,Aa(o,s)),u.attrs!==null&&xf(u,u.attrs,!1),u.mergedAttrs!==null&&xf(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function S(t,e,n,r){let i=Re(),s=mn(),o=Un+t,a=i[bt],u=s.firstCreatePass?YH(o,s,i,e,n,r):s.data[o],c=ZH(s,i,u,a,e,t);i[o]=c;let l=Uf(u);return ro(u,!0),Ux(a,c,u),(u.flags&32)!==32&&Bf()&&Wf(s,i,c,u),yU()===0&&Ki(c,i),vU(),l&&(aw(s,i,u),ow(s,u,i)),r!==null&&uw(i,u),S}function b(){let t=Cn();$v()?JA():(t=t.parent,ro(t,!1));let e=t;IU(e)&&CU(),wU();let n=mn();return n.firstCreatePass&&(Hf(n,t),Uv(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&VU(e)&&gA(n,e,Re(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&LU(e)&&gA(n,e,Re(),e.stylesWithoutHost,!1),b}function Bt(t,e,n,r){return S(t,e,n,r),b(),Bt}var ZH=(t,e,n,r,i,s)=>($f(!0),Px(r,i,PU()));function XH(t,e,n,r,i){let s=e.consts,o=Aa(s,r),a=$c(e,t,8,"ng-container",o);o!==null&&xf(a,o,!0);let u=Aa(s,i);return lw(e,n,a,u),e.queries!==null&&e.queries.elementStart(e,a),a}function oo(t,e,n){let r=Re(),i=mn(),s=t+Un,o=i.firstCreatePass?XH(s,i,r,e,n):i.data[s];ro(o,!0);let a=JH(i,r,o,t);return r[s]=a,Bf()&&Wf(i,r,a,o),Ki(a,r),Uf(o)&&(aw(i,r,o),ow(i,o,r)),n!=null&&uw(r,o),oo}function ao(){let t=Cn(),e=mn();return $v()?JA():(t=t.parent,ro(t,!1)),e.firstCreatePass&&(Hf(e,t),Uv(t)&&e.queries.elementEnd(t)),ao}var JH=(t,e,n,r)=>($f(!0),NB(e[bt],""));function Dn(){return Re()}var zs=void 0;function e4(t){let e=t,n=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length;return n===1&&r===0?1:5}var t4=["en",[["a","p"],["AM","PM"],zs],[["AM","PM"],zs,zs],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],zs,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],zs,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",zs,"{1} 'at' {0}",zs],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",e4],qy={};function Bn(t){let e=n4(t),n=_A(e);if(n)return n;let r=e.split("-")[0];if(n=_A(r),n)return n;if(r==="en")return t4;throw new H(701,!1)}function _A(t){return t in qy||(qy[t]=jt.ng&&jt.ng.common&&jt.ng.common.locales&&jt.ng.common.locales[t]),qy[t]}var ot=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(ot||{});function n4(t){return t.toLowerCase().replace(/_/g,"-")}var Nf="en-US";var r4=Nf;function i4(t){Nj(t,"Expected localeId to be defined"),typeof t=="string"&&(r4=t.toLowerCase().replace(/_/g,"-"))}function uo(t){return!!t&&typeof t.then=="function"}function gR(t){return!!t&&typeof t.subscribe=="function"}function we(t,e,n,r){let i=Re(),s=mn(),o=Cn();return o4(s,i,i[bt],o,t,e,r),we}function s4(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Mc],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function o4(t,e,n,r,i,s,o){let a=Uf(r),c=t.firstCreatePass&&L$(t),l=e[rr],d=V$(e),h=!0;if(r.type&3||o){let g=sr(r,e),m=o?o(g):g,I=d.length,A=o?k=>o(Ar(k[r.index])):r.index,D=null;if(!o&&a&&(D=s4(t,e,i,r.index)),D!==null){let k=D.__ngLastListenerFn__||D;k.__ngNextListenerFn__=s,D.__ngLastListenerFn__=s,h=!1}else{s=vA(r,e,l,s,!1);let k=n.listen(m,i,s);d.push(s,k),c&&c.push(i,A,I,I+1)}}else s=vA(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let m=0;m<g;m+=2){let I=p[m],A=p[m+1],q=e[I][A].subscribe(s),W=d.length;d.push(s,q),c&&c.push(i,r.index,W,-(W+1))}}}function yA(t,e,n,r){try{return Dr(6,e,n),n(r)!==!1}catch(i){return sR(t,i),!1}finally{Dr(7,e,n)}}function vA(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Zi(t.index,e):e;hw(a);let u=yA(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=yA(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function fe(t=1){return NU(t)}function ww(t,e,n){return mR(t,"",e,"",n),ww}function mR(t,e,n,r,i){let s=Re(),o=pR(s,e,n,r);if(o!==Pr){let a=mn(),u=ux();eR(a,u,s,t,o,s[bt],i,!1)}return mR}var Jf=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=c4;let t=e;return t})(),a4=Jf,u4=class extends a4{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=wH(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new eo(i)}};function c4(){return l4(Cn(),Re())}function l4(t,e){return t.type&4?new u4(e,t,Yf(t,e)):null}function d4(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}function j(t,e=""){let n=Re(),r=mn(),i=t+Un,s=r.firstCreatePass?$c(r,i,1,e,null):r.data[i],o=h4(r,n,s,e,t);n[i]=o,Bf()&&Wf(r,n,o,s),ro(s,!1)}var h4=(t,e,n,r,i)=>($f(!0),RB(e[bt],r));function At(t){return Va("",t,""),At}function Va(t,e,n){let r=Re(),i=pR(r,t,e,n);return i!==Pr&&oR(r,io(),i),Va}function Ew(t,e,n,r,i,s,o){let a=Re(),u=PH(a,t,e,n,r,i,s,o);return u!==Pr&&oR(a,io(),u),Ew}function f4(t,e,n){let r=mn();if(r.firstCreatePass){let i=Wi(t);Pv(n,r.data,r.blueprint,i,!0),Pv(e,r.data,r.blueprint,i,!1)}}function Pv(t,e,n,r,i){if(t=Jt(t),Array.isArray(t))for(let s=0;s<t.length;s++)Pv(t[s],e,n,r,i);else{let s=mn(),o=Re(),a=Cn(),u=Ma(t)?t:Jt(t.provide),c=Sx(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Ma(t)||!t.multi){let f=new Js(c,i,K),p=zy(u,e,i?l:l+h,d);p===-1?(tv(Ef(a,o),s,u),Gy(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=zy(u,e,l+h,d),p=zy(u,e,l,l+h),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){tv(Ef(a,o),s,u);let I=m4(i?g4:p4,n.length,i,r,c);!i&&m&&(n[p].providerFactory=I),Gy(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(I),o.push(I)}else{let I=_R(n[i?p:f],c,!i&&r);Gy(s,t,f>-1?f:p,I)}!i&&r&&m&&n[p].componentProviders++}}}function Gy(t,e,n,r){let i=Ma(e),s=lB(e);if(i||s){let u=(s?Jt(e.useClass):e).prototype.ngOnDestroy;if(u){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=c.indexOf(n);l===-1?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function _R(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function zy(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function p4(t,e,n,r){return kv(this.multi,[])}function g4(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=xa(n,n[ge],this.providerFactory.index,r);s=a.slice(0,o),kv(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],kv(i,s);return s}function kv(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function m4(t,e,n,r,i){let s=new Js(t,n,K);return s.multi=[],s.index=e,s.componentProviders=0,_R(s,i,r&&!n),s}function La(t,e=[]){return n=>{n.providersResolver=(r,i)=>f4(r,i?i(t):t,e)}}var Qi=class{},jc=class{};var Pf=class extends Qi{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Rf(this);let i=FA(e);this._bootstrapComponents=Rx(i.bootstrap),this._r3Injector=Ax(e,n,[{provide:Qi,useValue:this},{provide:Qf,useValue:this.componentFactoryResolver},...r],en(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},kf=class extends jc{constructor(e){super(),this.moduleType=e}create(e){return new Pf(this.moduleType,e,[])}};function _4(t,e,n){return new Pf(t,e,n)}var Ov=class extends Qi{constructor(e){super(),this.componentFactoryResolver=new Rf(this),this.instance=null;let n=new Fc([...e.providers,{provide:Qi,useValue:this},{provide:Qf,useValue:this.componentFactoryResolver}],e.parent||Qv(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function ep(t,e,n=null){return new Ov({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var y4=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=Dx(!1,r.type),s=i.length>0?ep([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=V({token:e,providedIn:"environment",factory:()=>new e(w(In))});let t=e;return t})();function yR(t){fw("NgStandalone"),t.getStandaloneInjector=e=>e.get(y4).getOrCreateStandaloneInjector(t)}function vR(t,e,n,r,i,s){return E4(Re(),Hv(),t,e,n,r,i,s)}function Iw(t,e){let n=t[e];return n===Pr?void 0:n}function v4(t,e,n,r,i,s){let o=e+n;return to(t,o,i)?yw(t,o+1,s?r.call(s,i):r(i)):Iw(t,o+1)}function w4(t,e,n,r,i,s,o){let a=e+n;return hR(t,a,i,s)?yw(t,a+2,o?r.call(o,i,s):r(i,s)):Iw(t,a+2)}function E4(t,e,n,r,i,s,o,a){let u=e+n;return fR(t,u,i,s,o)?yw(t,u+3,a?r.call(a,i,s,o):r(i,s,o)):Iw(t,u+3)}function es(t,e){let n=mn(),r,i=t+Un;n.firstCreatePass?(r=I4(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks??=[]).push(i,r.onDestroy)):r=n.data[i];let s=r.factory||(r.factory=Zs(r.type,!0)),o,a=gn(K);try{let u=wf(!1),c=s();return wf(u),d4(n,Re(),i,c),c}finally{gn(a)}}function I4(t,e){if(e)for(let n=e.length-1;n>=0;n--){let r=e[n];if(t===r.name)return r}}function co(t,e,n){let r=t+Un,i=Re(),s=WA(i,r);return ER(i,r)?v4(i,Hv(),e,s.transform,n,s):s.transform(n)}function wR(t,e,n,r){let i=t+Un,s=Re(),o=WA(s,i);return ER(s,i)?w4(s,Hv(),e,o.transform,n,r,o):o.transform(n,r)}function ER(t,e){return t[ge].data[e].pure}var af=null;function C4(t){af!==null&&(t.defaultEncapsulation!==af.defaultEncapsulation||t.preserveWhitespaces!==af.preserveWhitespaces)||(af=t)}var fi=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},IR=new fi("17.1.2");var tp=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Fv=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},np=(()=>{let e=class e{compileModuleSync(r){return new kf(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=FA(r),o=Rx(s.declarations).reduce((a,u)=>{let c=Gi(u);return c&&a.push(new Na(c)),a},[]);return new Fv(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),D4=new P("");var rp=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Lt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Cw=new P(""),Hc=new P(""),ip=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Dw||(T4(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(w(de),w(sp),w(Hc))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),sp=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return Dw?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function T4(t){Dw=t}var Dw,op=new P(""),CR=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=O(op,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(uo(o))r.push(o);else if(gR(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Tw=new P("");function b4(t,e,n){let r=new kf(n);return Promise.resolve(r)}function S4(){gS(()=>{throw new H(600,!1)})}function A4(t){return t.isBoundToModule}function x4(t,e,n){try{let r=n();return uo(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function DR(t,e){return Array.isArray(e)?e.reduce(DR,t):N(N({},t),e)}var ja=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=O(zx),this.afterRenderEffectManager=O(mw),this.componentTypes=[],this.components=[],this.isStable=O(rp).hasPendingTasks.pipe(U(r=>!r)),this._injector=O(In)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof bf;if(!this._injector.get(CR).done){let f=!s&&OA(r),p=!1;throw new H(405,p)}let a;s?a=r:a=this._injector.get(Qf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=A4(a)?void 0:this._injector.get(Qi),c=i||a.selector,l=a.create(or.NULL,[],c,u),d=l.location.nativeElement,h=l.injector.get(Cw,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),hf(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new H(101,!1);try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this.internalErrorHandler(r)}finally{try{let r=this.afterRenderEffectManager.execute()}catch(r){this.internalErrorHandler(r)}this._runningTick=!1}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;hf(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(Tw,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>hf(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new H(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function hf(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function wA(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var R4=(()=>{let e=class e{constructor(){this.zone=O(de),this.applicationRef=O(ja)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function M4(t){return[{provide:de,useFactory:t},{provide:Ra,multi:!0,useFactory:()=>{let e=O(R4,{optional:!0});return()=>e.initialize()}},{provide:Ra,multi:!0,useFactory:()=>{let e=O(k4);return()=>{e.initialize()}}},{provide:zx,useFactory:N4}]}function N4(){let t=O(de),e=O(xr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function P4(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var k4=(()=>{let e=class e{constructor(){this.subscription=new it,this.initialized=!1,this.zone=O(de),this.pendingTasks=O(rp)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{de.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function O4(){return typeof $localize<"u"&&$localize.locale||Nf}var ap=new P("",{providedIn:"root",factory:()=>O(ap,le.Optional|le.SkipSelf)||O4()});var TR=new P(""),bR=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=eH(i?.ngZone,P4({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=_4(r.moduleType,this.injector,M4(()=>s)),a=o.injector.get(xr,null);return s.runOutsideAngular(()=>{let u=s.onError.subscribe({next:c=>{a.handleError(c)}});o.onDestroy(()=>{hf(this._modules,o),u.unsubscribe()})}),x4(a,s,()=>{let u=o.injector.get(CR);return u.runInitializers(),u.donePromise.then(()=>{let c=o.injector.get(ap,Nf);return i4(c||Nf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=DR({},i);return b4(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(ja);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new H(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new H(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(TR,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(w(or))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Ac=null,SR=new P("");function F4(t){if(Ac&&!Ac.get(SR,!1))throw new H(400,!1);S4(),Ac=t;let e=t.get(bR);return j4(t),e}function bw(t,e,n=[]){let r=`Platform: ${e}`,i=new P(r);return(s=[])=>{let o=AR();if(!o||o.injector.get(SR,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):F4(V4(a,r))}return L4(i)}}function V4(t=[],e){return or.create({name:e,providers:[{provide:Gf,useValue:"platform"},{provide:TR,useValue:new Set([()=>Ac=null])},...t]})}function L4(t){let e=AR();if(!e)throw new H(401,!1);return e}function AR(){return Ac?.get(bR)??null}function j4(t){t.get(Yv,null)?.forEach(n=>n())}function Sw(){return!1}var xR=bw(null,"core",[]),RR=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(w(ja))},e.\u0275mod=He({type:e}),e.\u0275inj=$e({});let t=e;return t})();function up(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function MR(t){let e=Gi(t);if(!e)return null;let n=new Na(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var jR=null;function kr(){return jR}function UR(t){jR??=t}var _p=class{},_n=new P(""),Fw=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>O($4),providedIn:"platform"});let t=e;return t})(),BR=new P(""),$4=(()=>{let e=class e extends Fw{constructor(){super(),this._doc=O(_n),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return kr().getBaseHref(this._doc)}onPopState(r){let i=kr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=kr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function Vw(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function NR(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function wi(t){return t&&t[0]!=="?"?"?"+t:t}var Ci=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>O(Lw),providedIn:"root"});let t=e;return t})(),$R=new P(""),Lw=(()=>{let e=class e extends Ci{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??O(_n).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Vw(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+wi(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+wi(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+wi(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(w(Fw),w($R,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),wp=(()=>{let e=class e extends Ci{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Vw(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+wi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+wi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(w(Fw),w($R,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Ua=(()=>{let e=class e{constructor(r){this._subject=new It,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=G4(NR(PR(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+wi(i))}normalize(r){return e.stripTrailingSlash(q4(this._basePath,PR(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+wi(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+wi(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=wi,e.joinWithSlash=Vw,e.stripTrailingSlash=NR,e.\u0275fac=function(i){return new(i||e)(w(Ci))},e.\u0275prov=V({token:e,factory:()=>H4(),providedIn:"root"});let t=e;return t})();function H4(){return new Ua(w(Ci))}function q4(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function PR(t){return t.replace(/\/index.html$/,"")}function G4(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}var tn=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(tn||{}),ke=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(ke||{}),Tn=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(Tn||{}),Ei=function(t){return t[t.Decimal=0]="Decimal",t[t.Group=1]="Group",t[t.List=2]="List",t[t.PercentSign=3]="PercentSign",t[t.PlusSign=4]="PlusSign",t[t.MinusSign=5]="MinusSign",t[t.Exponential=6]="Exponential",t[t.SuperscriptingExponent=7]="SuperscriptingExponent",t[t.PerMille=8]="PerMille",t[t.Infinity=9]="Infinity",t[t.NaN=10]="NaN",t[t.TimeSeparator=11]="TimeSeparator",t[t.CurrencyDecimal=12]="CurrencyDecimal",t[t.CurrencyGroup=13]="CurrencyGroup",t}(Ei||{});function z4(t){return Bn(t)[ot.LocaleId]}function W4(t,e,n){let r=Bn(t),i=[r[ot.DayPeriodsFormat],r[ot.DayPeriodsStandalone]],s=$n(i,e);return $n(s,n)}function K4(t,e,n){let r=Bn(t),i=[r[ot.DaysFormat],r[ot.DaysStandalone]],s=$n(i,e);return $n(s,n)}function Q4(t,e,n){let r=Bn(t),i=[r[ot.MonthsFormat],r[ot.MonthsStandalone]],s=$n(i,e);return $n(s,n)}function Y4(t,e){let r=Bn(t)[ot.Eras];return $n(r,e)}function cp(t,e){let n=Bn(t);return $n(n[ot.DateFormat],e)}function lp(t,e){let n=Bn(t);return $n(n[ot.TimeFormat],e)}function dp(t,e){let r=Bn(t)[ot.DateTimeFormat];return $n(r,e)}function Ep(t,e){let n=Bn(t),r=n[ot.NumberSymbols][e];if(typeof r>"u"){if(e===Ei.CurrencyDecimal)return n[ot.NumberSymbols][Ei.Decimal];if(e===Ei.CurrencyGroup)return n[ot.NumberSymbols][Ei.Group]}return r}function HR(t){if(!t[ot.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[ot.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Z4(t){let e=Bn(t);return HR(e),(e[ot.ExtraData][2]||[]).map(r=>typeof r=="string"?Aw(r):[Aw(r[0]),Aw(r[1])])}function X4(t,e,n){let r=Bn(t);HR(r);let i=[r[ot.ExtraData][0],r[ot.ExtraData][1]],s=$n(i,e)||[];return $n(s,n)||[]}function $n(t,e){for(let n=e;n>-1;n--)if(typeof t[n]<"u")return t[n];throw new Error("Locale data API: locale data undefined")}function Aw(t){let[e,n]=t.split(":");return{hours:+e,minutes:+n}}var J4=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,hp={},eq=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,Ii=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}(Ii||{}),Te=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}(Te||{}),De=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}(De||{});function tq(t,e,n,r){let i=lq(t);e=vi(n,e)||e;let o=[],a;for(;e;)if(a=eq.exec(e),a){o=o.concat(a.slice(1));let l=o.pop();if(!l)break;e=l}else{o.push(e);break}let u=i.getTimezoneOffset();r&&(u=GR(r,u),i=cq(i,r,!0));let c="";return o.forEach(l=>{let d=aq(l);c+=d?d(i,n,u):l==="''"?"'":l.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function yp(t,e,n){let r=new Date(0);return r.setFullYear(t,e,n),r.setHours(0,0,0),r}function vi(t,e){let n=z4(t);if(hp[n]??={},hp[n][e])return hp[n][e];let r="";switch(e){case"shortDate":r=cp(t,Tn.Short);break;case"mediumDate":r=cp(t,Tn.Medium);break;case"longDate":r=cp(t,Tn.Long);break;case"fullDate":r=cp(t,Tn.Full);break;case"shortTime":r=lp(t,Tn.Short);break;case"mediumTime":r=lp(t,Tn.Medium);break;case"longTime":r=lp(t,Tn.Long);break;case"fullTime":r=lp(t,Tn.Full);break;case"short":let i=vi(t,"shortTime"),s=vi(t,"shortDate");r=fp(dp(t,Tn.Short),[i,s]);break;case"medium":let o=vi(t,"mediumTime"),a=vi(t,"mediumDate");r=fp(dp(t,Tn.Medium),[o,a]);break;case"long":let u=vi(t,"longTime"),c=vi(t,"longDate");r=fp(dp(t,Tn.Long),[u,c]);break;case"full":let l=vi(t,"fullTime"),d=vi(t,"fullDate");r=fp(dp(t,Tn.Full),[l,d]);break}return r&&(hp[n][e]=r),r}function fp(t,e){return e&&(t=t.replace(/\{([^}]+)}/g,function(n,r){return e!=null&&r in e?e[r]:n})),t}function ar(t,e,n="-",r,i){let s="";(t<0||i&&t<=0)&&(i?t=-t+1:(t=-t,s=n));let o=String(t);for(;o.length<e;)o="0"+o;return r&&(o=o.slice(o.length-e)),s+o}function nq(t,e){return ar(t,3).substring(0,e)}function ft(t,e,n=0,r=!1,i=!1){return function(s,o){let a=rq(t,s);if((n>0||a>-n)&&(a+=n),t===Te.Hours)a===0&&n===-12&&(a=12);else if(t===Te.FractionalSeconds)return nq(a,e);let u=Ep(o,Ei.MinusSign);return ar(a,e,u,r,i)}}function rq(t,e){switch(t){case Te.FullYear:return e.getFullYear();case Te.Month:return e.getMonth();case Te.Date:return e.getDate();case Te.Hours:return e.getHours();case Te.Minutes:return e.getMinutes();case Te.Seconds:return e.getSeconds();case Te.FractionalSeconds:return e.getMilliseconds();case Te.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}function Ve(t,e,n=tn.Format,r=!1){return function(i,s){return iq(i,s,t,e,n,r)}}function iq(t,e,n,r,i,s){switch(n){case De.Months:return Q4(e,i,r)[t.getMonth()];case De.Days:return K4(e,i,r)[t.getDay()];case De.DayPeriods:let o=t.getHours(),a=t.getMinutes();if(s){let c=Z4(e),l=X4(e,i,r),d=c.findIndex(h=>{if(Array.isArray(h)){let[f,p]=h,g=o>=f.hours&&a>=f.minutes,m=o<p.hours||o===p.hours&&a<p.minutes;if(f.hours<p.hours){if(g&&m)return!0}else if(g||m)return!0}else if(h.hours===o&&h.minutes===a)return!0;return!1});if(d!==-1)return l[d]}return W4(e,i,r)[o<12?0:1];case De.Eras:return Y4(e,r)[t.getFullYear()<=0?0:1];default:let u=n;throw new Error(`unexpected translation type ${u}`)}}function pp(t){return function(e,n,r){let i=-1*r,s=Ep(n,Ei.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(t){case Ii.Short:return(i>=0?"+":"")+ar(o,2,s)+ar(Math.abs(i%60),2,s);case Ii.ShortGMT:return"GMT"+(i>=0?"+":"")+ar(o,1,s);case Ii.Long:return"GMT"+(i>=0?"+":"")+ar(o,2,s)+":"+ar(Math.abs(i%60),2,s);case Ii.Extended:return r===0?"Z":(i>=0?"+":"")+ar(o,2,s)+":"+ar(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${t}"`)}}}var sq=0,mp=4;function oq(t){let e=yp(t,sq,1).getDay();return yp(t,0,1+(e<=mp?mp:mp+7)-e)}function qR(t){let e=t.getDay(),n=e===0?-3:mp-e;return yp(t.getFullYear(),t.getMonth(),t.getDate()+n)}function xw(t,e=!1){return function(n,r){let i;if(e){let s=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+s)/7)}else{let s=qR(n),o=oq(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return ar(i,t,Ep(r,Ei.MinusSign))}}function gp(t,e=!1){return function(n,r){let s=qR(n).getFullYear();return ar(s,t,Ep(r,Ei.MinusSign),e)}}var Rw={};function aq(t){if(Rw[t])return Rw[t];let e;switch(t){case"G":case"GG":case"GGG":e=Ve(De.Eras,ke.Abbreviated);break;case"GGGG":e=Ve(De.Eras,ke.Wide);break;case"GGGGG":e=Ve(De.Eras,ke.Narrow);break;case"y":e=ft(Te.FullYear,1,0,!1,!0);break;case"yy":e=ft(Te.FullYear,2,0,!0,!0);break;case"yyy":e=ft(Te.FullYear,3,0,!1,!0);break;case"yyyy":e=ft(Te.FullYear,4,0,!1,!0);break;case"Y":e=gp(1);break;case"YY":e=gp(2,!0);break;case"YYY":e=gp(3);break;case"YYYY":e=gp(4);break;case"M":case"L":e=ft(Te.Month,1,1);break;case"MM":case"LL":e=ft(Te.Month,2,1);break;case"MMM":e=Ve(De.Months,ke.Abbreviated);break;case"MMMM":e=Ve(De.Months,ke.Wide);break;case"MMMMM":e=Ve(De.Months,ke.Narrow);break;case"LLL":e=Ve(De.Months,ke.Abbreviated,tn.Standalone);break;case"LLLL":e=Ve(De.Months,ke.Wide,tn.Standalone);break;case"LLLLL":e=Ve(De.Months,ke.Narrow,tn.Standalone);break;case"w":e=xw(1);break;case"ww":e=xw(2);break;case"W":e=xw(1,!0);break;case"d":e=ft(Te.Date,1);break;case"dd":e=ft(Te.Date,2);break;case"c":case"cc":e=ft(Te.Day,1);break;case"ccc":e=Ve(De.Days,ke.Abbreviated,tn.Standalone);break;case"cccc":e=Ve(De.Days,ke.Wide,tn.Standalone);break;case"ccccc":e=Ve(De.Days,ke.Narrow,tn.Standalone);break;case"cccccc":e=Ve(De.Days,ke.Short,tn.Standalone);break;case"E":case"EE":case"EEE":e=Ve(De.Days,ke.Abbreviated);break;case"EEEE":e=Ve(De.Days,ke.Wide);break;case"EEEEE":e=Ve(De.Days,ke.Narrow);break;case"EEEEEE":e=Ve(De.Days,ke.Short);break;case"a":case"aa":case"aaa":e=Ve(De.DayPeriods,ke.Abbreviated);break;case"aaaa":e=Ve(De.DayPeriods,ke.Wide);break;case"aaaaa":e=Ve(De.DayPeriods,ke.Narrow);break;case"b":case"bb":case"bbb":e=Ve(De.DayPeriods,ke.Abbreviated,tn.Standalone,!0);break;case"bbbb":e=Ve(De.DayPeriods,ke.Wide,tn.Standalone,!0);break;case"bbbbb":e=Ve(De.DayPeriods,ke.Narrow,tn.Standalone,!0);break;case"B":case"BB":case"BBB":e=Ve(De.DayPeriods,ke.Abbreviated,tn.Format,!0);break;case"BBBB":e=Ve(De.DayPeriods,ke.Wide,tn.Format,!0);break;case"BBBBB":e=Ve(De.DayPeriods,ke.Narrow,tn.Format,!0);break;case"h":e=ft(Te.Hours,1,-12);break;case"hh":e=ft(Te.Hours,2,-12);break;case"H":e=ft(Te.Hours,1);break;case"HH":e=ft(Te.Hours,2);break;case"m":e=ft(Te.Minutes,1);break;case"mm":e=ft(Te.Minutes,2);break;case"s":e=ft(Te.Seconds,1);break;case"ss":e=ft(Te.Seconds,2);break;case"S":e=ft(Te.FractionalSeconds,1);break;case"SS":e=ft(Te.FractionalSeconds,2);break;case"SSS":e=ft(Te.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=pp(Ii.Short);break;case"ZZZZZ":e=pp(Ii.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=pp(Ii.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=pp(Ii.Long);break;default:return null}return Rw[t]=e,e}function GR(t,e){t=t.replace(/:/g,"");let n=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(n)?e:n}function uq(t,e){return t=new Date(t.getTime()),t.setMinutes(t.getMinutes()+e),t}function cq(t,e,n){let r=n?-1:1,i=t.getTimezoneOffset(),s=GR(e,i);return uq(t,r*(s-i))}function lq(t){if(kR(t))return t;if(typeof t=="number"&&!isNaN(t))return new Date(t);if(typeof t=="string"){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){let[i,s=1,o=1]=t.split("-").map(a=>+a);return yp(i,s-1,o)}let n=parseFloat(t);if(!isNaN(t-n))return new Date(n);let r;if(r=t.match(J4))return dq(r)}let e=new Date(t);if(!kR(e))throw new Error(`Unable to convert "${t}" into a date`);return e}function dq(t){let e=new Date(0),n=0,r=0,i=t[8]?e.setUTCFullYear:e.setFullYear,s=t[8]?e.setUTCHours:e.setHours;t[9]&&(n=Number(t[9]+t[10]),r=Number(t[9]+t[11])),i.call(e,Number(t[1]),Number(t[2])-1,Number(t[3]));let o=Number(t[4]||0)-n,a=Number(t[5]||0)-r,u=Number(t[6]||0),c=Math.floor(parseFloat("0."+(t[7]||0))*1e3);return s.call(e,o,a,u,c),e}function kR(t){return t instanceof Date&&!isNaN(t.valueOf())}function zR(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Mw=/\s+/,OR=[],WR=(()=>{let e=class e{constructor(r,i){this._ngEl=r,this._renderer=i,this.initialClasses=OR,this.stateMap=new Map}set klass(r){this.initialClasses=r!=null?r.trim().split(Mw):OR}set ngClass(r){this.rawClass=typeof r=="string"?r.trim().split(Mw):r}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let r=this.rawClass;if(Array.isArray(r)||r instanceof Set)for(let i of r)this._updateState(i,!0);else if(r!=null)for(let i of Object.keys(r))this._updateState(i,!!r[i]);this._applyStateDiff()}_updateState(r,i){let s=this.stateMap.get(r);s!==void 0?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(r,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let r of this.stateMap){let i=r[0],s=r[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(r,i){r=r.trim(),r.length>0&&r.split(Mw).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}};e.\u0275fac=function(i){return new(i||e)(K(Nr),K(mi))},e.\u0275dir=Ut({type:e,selectors:[["","ngClass",""]],inputs:{klass:[En.None,"class","klass"],ngClass:"ngClass"},standalone:!0});let t=e;return t})();var Nw=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Ip=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new Nw(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let u=i.get(o);i.move(u,a),FR(u,s)}});for(let s=0,o=i.length;s<o;s++){let u=i.get(s).context;u.index=s,u.count=o,u.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);FR(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(K(Fa),K(Jf),K(iw))},e.\u0275dir=Ut({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function FR(t,e){t.context.$implicit=e.item}var Ba=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new Pw,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){VR("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){VR("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(K(Fa),K(Jf))},e.\u0275dir=Ut({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),Pw=class{constructor(){this.$implicit=null,this.ngIf=null}};function VR(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${en(e)}'.`)}function hq(t,e){return new H(2100,!1)}var fq="mediumDate",pq=new P(""),gq=new P(""),KR=(()=>{let e=class e{constructor(r,i,s){this.locale=r,this.defaultTimezone=i,this.defaultOptions=s}transform(r,i,s,o){if(r==null||r===""||r!==r)return null;try{let a=i??this.defaultOptions?.dateFormat??fq,u=s??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return tq(r,a,o||this.locale,u)}catch(a){throw hq(e,a.message)}}};e.\u0275fac=function(i){return new(i||e)(K(ap,16),K(pq,24),K(gq,24))},e.\u0275pipe=Mr({name:"date",type:e,pure:!0,standalone:!0});let t=e;return t})();function mq(t,e){return{key:t,value:e}}var QR=(()=>{let e=class e{constructor(r){this.differs=r,this.keyValues=[],this.compareFn=LR}transform(r,i=LR){if(!r||!(r instanceof Map)&&typeof r!="object")return null;this.differ??=this.differs.find(r).create();let s=this.differ.diff(r),o=i!==this.compareFn;return s&&(this.keyValues=[],s.forEachItem(a=>{this.keyValues.push(mq(a.key,a.currentValue))})),(s||o)&&(this.keyValues.sort(i),this.compareFn=i),this.keyValues}};e.\u0275fac=function(i){return new(i||e)(K(sw,16))},e.\u0275pipe=Mr({name:"keyvalue",type:e,pure:!1,standalone:!0});let t=e;return t})();function LR(t,e){let n=t.key,r=e.key;if(n===r)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(n===null)return 1;if(r===null)return-1;if(typeof n=="string"&&typeof r=="string")return n<r?-1:1;if(typeof n=="number"&&typeof r=="number")return n-r;if(typeof n=="boolean"&&typeof r=="boolean")return n<r?-1:1;let i=String(n),s=String(r);return i==s?0:i<s?-1:1}var YR=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=He({type:e}),e.\u0275inj=$e({});let t=e;return t})(),jw="browser",_q="server";function yq(t){return t===jw}function lo(t){return t===_q}var ZR=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>yq(O(St))?new kw(O(_n),window):new Ow});let t=e;return t})(),kw=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=vq(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function vq(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Ow=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},vp=class{};var Hw=class extends _p{constructor(){super(...arguments),this.supportsDOMEvents=!0}},qw=class t extends Hw{static makeCurrent(){UR(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=Eq();return n==null?null:Iq(n)}resetBaseElement(){qc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return zR(document.cookie,e)}},qc=null;function Eq(){return qc=qc||document.querySelector("base"),qc?qc.getAttribute("href"):null}function Iq(t){return new URL(t,document.baseURI).pathname}var Gw=class{addToWindow(e){jt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new H(5103,!1);return s},jt.getAllAngularTestabilities=()=>e.getAllTestabilities(),jt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=jt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};jt.frameworkStabilizers||(jt.frameworkStabilizers=[]),jt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?kr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},Cq=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),zw=new P(""),tM=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new H(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(w(zw),w(de))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Cp=class{constructor(e){this._doc=e}},Bw="ng-app-id",nM=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=lo(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${Bw}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(Bw),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Bw,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(w(_n),w(zf),w(Zv,8),w(St))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),$w={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Kw=/%COMP%/g,rM="%COMP%",Dq=`_nghost-${rM}`,Tq=`_ngcontent-${rM}`,bq=!0,Sq=new P("",{providedIn:"root",factory:()=>bq});function Aq(t){return Tq.replace(Kw,t)}function xq(t){return Dq.replace(Kw,t)}function iM(t,e){return e.map(n=>n.replace(Kw,t))}var XR=(()=>{let e=class e{constructor(r,i,s,o,a,u,c,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=lo(u),this.defaultRenderer=new Gc(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===br.ShadowDom&&(i=Ce(N({},i),{encapsulation:br.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Dp?s.applyToHost(r):s instanceof zc&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case br.Emulated:o=new Dp(c,l,i,this.appId,d,a,u,h);break;case br.ShadowDom:return new Ww(c,l,r,i,a,u,this.nonce,h);default:o=new zc(c,l,i,d,a,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(w(tM),w(nM),w(zf),w(Sq),w(_n),w(St),w(de),w(Zv))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),Gc=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS($w[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(JR(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(JR(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new H(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=$w[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=$w[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(hi.DashCase|hi.Important)?e.style.setProperty(n,r,i&hi.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&hi.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=kr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function JR(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Ww=class extends Gc{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=iM(i.id,i.styles);for(let l of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},zc=class extends Gc{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?iM(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Dp=class extends zc{constructor(e,n,r,i,s,o,a,u){let c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=Aq(c),this.hostAttr=xq(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},Rq=(()=>{let e=class e extends Cp{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(w(_n))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),eM=["alt","control","meta","shift"],Mq={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Nq={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Pq=(()=>{let e=class e extends Cp{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>kr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),eM.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=Mq[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),eM.forEach(a=>{if(a!==s){let u=Nq[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(w(_n))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function kq(){qw.makeCurrent()}function Oq(){return new xr}function Fq(){return xx(document),document}var Vq=[{provide:St,useValue:jw},{provide:Yv,useValue:kq,multi:!0},{provide:_n,useFactory:Fq,deps:[]}],sM=bw(xR,"browser",Vq),Lq=new P(""),jq=[{provide:Hc,useClass:Gw,deps:[]},{provide:Cw,useClass:ip,deps:[de,sp,Hc]},{provide:ip,useClass:ip,deps:[de,sp,Hc]}],Uq=[{provide:Gf,useValue:"root"},{provide:xr,useFactory:Oq,deps:[]},{provide:zw,useClass:Rq,multi:!0,deps:[_n,de,St]},{provide:zw,useClass:Pq,multi:!0,deps:[_n]},XR,nM,tM,{provide:Vc,useExisting:XR},{provide:vp,useClass:Cq,deps:[]},[]],oM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:zf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(w(Lq,12))},e.\u0275mod=He({type:e}),e.\u0275inj=$e({providers:[...Uq,...jq],imports:[YR,RR]});let t=e;return t})();var aM=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(w(_n))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var oe="primary",al=Symbol("RouteTitle"),Jw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function za(t){return new Jw(t)}function $q(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function Hq(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!Or(t[n],e[n]))return!1;return!0}function Or(t,e){let n=t?eE(t):void 0,r=e?eE(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!_M(t[i],e[i]))return!1;return!0}function eE(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function _M(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function yM(t){return t.length>0?t[t.length-1]:null}function is(t){return Cy(t)?t:uo(t)?ce(Promise.resolve(t)):B(t)}var qq={exact:wM,subset:EM},vM={exact:Gq,subset:zq,ignored:()=>!0};function cM(t,e,n){return qq[n.paths](t.root,e.root,n.matrixParams)&&vM[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function Gq(t,e){return Or(t,e)}function wM(t,e,n){if(!fo(t.segments,e.segments)||!Sp(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!wM(t.children[r],e.children[r],n))return!1;return!0}function zq(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>_M(t[n],e[n]))}function EM(t,e,n){return IM(t,e,e.segments,n)}function IM(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!fo(i,n)||e.hasChildren()||!Sp(i,n,r))}else if(t.segments.length===n.length){if(!fo(t.segments,n)||!Sp(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!EM(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!fo(t.segments,i)||!Sp(t.segments,i,r)||!t.children[oe]?!1:IM(t.children[oe],e,s,r)}}function Sp(t,e,n){return e.every((r,i)=>vM[n](t[i].parameters,r.parameters))}var ts=class{constructor(e=new be([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=za(this.queryParams),this._queryParamMap}toString(){return Qq.serialize(this)}},be=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ap(this)}},ho=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=za(this.parameters),this._parameterMap}toString(){return DM(this)}};function Wq(t,e){return fo(t,e)&&t.every((n,r)=>Or(n.parameters,e[r].parameters))}function fo(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function Kq(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===oe&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==oe&&(n=n.concat(e(i,r)))}),n}var ul=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new Jc,providedIn:"root"});let t=e;return t})(),Jc=class{parse(e){let n=new nE(e);return new ts(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Wc(e.root,!0)}`,r=Xq(e.queryParams),i=typeof e.fragment=="string"?`#${Yq(e.fragment)}`:"";return`${n}${r}${i}`}},Qq=new Jc;function Ap(t){return t.segments.map(e=>DM(e)).join("/")}function Wc(t,e){if(!t.hasChildren())return Ap(t);if(e){let n=t.children[oe]?Wc(t.children[oe],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==oe&&r.push(`${i}:${Wc(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=Kq(t,(r,i)=>i===oe?[Wc(t.children[oe],!1)]:[`${i}:${Wc(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[oe]!=null?`${Ap(t)}/${n[0]}`:`${Ap(t)}/(${n.join("//")})`}}function CM(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Tp(t){return CM(t).replace(/%3B/gi,";")}function Yq(t){return encodeURI(t)}function tE(t){return CM(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xp(t){return decodeURIComponent(t)}function lM(t){return xp(t.replace(/\+/g,"%20"))}function DM(t){return`${tE(t.path)}${Zq(t.parameters)}`}function Zq(t){return Object.entries(t).map(([e,n])=>`;${tE(e)}=${tE(n)}`).join("")}function Xq(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Tp(n)}=${Tp(i)}`).join("&"):`${Tp(n)}=${Tp(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var Jq=/^[^\/()?;#]+/;function Qw(t){let e=t.match(Jq);return e?e[0]:""}var eG=/^[^\/()?;=#]+/;function tG(t){let e=t.match(eG);return e?e[0]:""}var nG=/^[^=?&#]+/;function rG(t){let e=t.match(nG);return e?e[0]:""}var iG=/^[^&#]+/;function sG(t){let e=t.match(iG);return e?e[0]:""}var nE=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new be([],{}):new be([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[oe]=new be(e,n)),r}parseSegment(){let e=Qw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new H(4009,!1);return this.capture(e),new ho(xp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=tG(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Qw(this.remaining);i&&(r=i,this.capture(r))}e[xp(n)]=xp(r)}parseQueryParam(e){let n=rG(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=sG(this.remaining);o&&(r=o,this.capture(r))}let i=lM(n),s=lM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Qw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new H(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=oe);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[oe]:new be([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new H(4011,!1)}};function TM(t){return t.segments.length>0?new be([],{[oe]:t}):t}function bM(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=bM(i);if(r===oe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new be(t.segments,e);return oG(n)}function oG(t){if(t.numberOfChildren===1&&t.children[oe]){let e=t.children[oe];return new be(t.segments.concat(e.segments),e.children)}return t}function Wa(t){return t instanceof ts}function aG(t,e,n=null,r=null){let i=SM(t);return AM(i,e,n,r)}function SM(t){let e;function n(s){let o={};for(let u of s.children){let c=n(u);o[u.outlet]=c}let a=new be(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=TM(r);return e??i}function AM(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Yw(i,i,i,n,r);let s=uG(e);if(s.toRoot())return Yw(i,i,new be([],{}),n,r);let o=cG(s,i,t),a=o.processChildren?Yc(o.segmentGroup,o.index,s.commands):RM(o.segmentGroup,o.index,s.commands);return Yw(i,o.segmentGroup,a,n,r)}function Rp(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function el(t){return typeof t=="object"&&t!=null&&t.outlets}function Yw(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;t===e?o=n:o=xM(t,e,n);let a=TM(bM(o));return new ts(a,s,i)}function xM(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=xM(s,e,n)}),new be(t.segments,r)}var Mp=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&Rp(r[0]))throw new H(4003,!1);let i=r.find(el);if(i&&i!==yM(r))throw new H(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function uG(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Mp(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Mp(n,e,r)}var qa=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function cG(t,e,n){if(t.isAbsolute)return new qa(e,!0,0);if(!n)return new qa(e,!1,NaN);if(n.parent===null)return new qa(n,!0,0);let r=Rp(t.commands[0])?0:1,i=n.segments.length-1+r;return lG(n,i,t.numberOfDoubleDots)}function lG(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new H(4005,!1);i=r.segments.length}return new qa(r,!1,i-s)}function dG(t){return el(t[0])?t[0].outlets:{[oe]:t}}function RM(t,e,n){if(t??=new be([],{}),t.segments.length===0&&t.hasChildren())return Yc(t,e,n);let r=hG(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new be(t.segments.slice(0,r.pathIndex),{});return s.children[oe]=new be(t.segments.slice(r.pathIndex),t.children),Yc(s,0,i)}else return r.match&&i.length===0?new be(t.segments,{}):r.match&&!t.hasChildren()?rE(t,e,n):r.match?Yc(t,0,i):rE(t,e,n)}function Yc(t,e,n){if(n.length===0)return new be(t.segments,{});{let r=dG(n),i={};if(Object.keys(r).some(s=>s!==oe)&&t.children[oe]&&t.numberOfChildren===1&&t.children[oe].segments.length===0){let s=Yc(t.children[oe],e,n);return new be(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=RM(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new be(t.segments,i)}}function hG(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(el(a))break;let u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!hM(u,c,o))return s;r+=2}else{if(!hM(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function rE(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(el(s)){let u=fG(s.outlets);return new be(r,u)}if(i===0&&Rp(n[0])){let u=t.segments[e];r.push(new ho(u.path,dM(n[0]))),i++;continue}let o=el(s)?s.outlets[oe]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&Rp(a)?(r.push(new ho(o,dM(a))),i+=2):(r.push(new ho(o,{})),i++)}return new be(r,{})}function fG(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=rE(new be([],{}),0,r))}),e}function dM(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function hM(t,e,n){return t==n.path&&Or(e,n.parameters)}var Zc="imperative",xt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(xt||{}),qn=class{constructor(e,n){this.id=e,this.url=n}},Ka=class extends qn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=xt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ur=class extends qn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=xt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Hn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Hn||{}),Np=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Np||{}),ns=class extends qn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=xt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},rs=class extends qn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=xt.NavigationSkipped}},tl=class extends qn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=xt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Pp=class extends qn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=xt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},iE=class extends qn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=xt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},sE=class extends qn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=xt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},oE=class extends qn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=xt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},aE=class extends qn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=xt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uE=class{constructor(e){this.route=e,this.type=xt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},cE=class{constructor(e){this.route=e,this.type=xt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},lE=class{constructor(e){this.snapshot=e,this.type=xt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},dE=class{constructor(e){this.snapshot=e,this.type=xt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},hE=class{constructor(e){this.snapshot=e,this.type=xt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},fE=class{constructor(e){this.snapshot=e,this.type=xt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kp=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=xt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},nl=class{},rl=class{constructor(e){this.url=e}};var pE=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new cl,this.attachRef=null}},cl=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new pE,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Op=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=gE(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=gE(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=mE(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return mE(e,this._root).map(n=>n.value)}};function gE(t,e){if(t===e.value)return e;for(let n of e.children){let r=gE(t,n);if(r)return r}return null}function mE(t,e){if(t===e.value)return[e];for(let n of e.children){let r=mE(t,n);if(r.length)return r.unshift(e),r}return[]}var bn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Ha(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Fp=class extends Op{constructor(e,n){super(e),this.snapshot=n,bE(this,e)}toString(){return this.snapshot.toString()}};function MM(t){let e=pG(t),n=new Lt([new ho("",{})]),r=new Lt({}),i=new Lt({}),s=new Lt({}),o=new Lt(""),a=new Fr(n,r,s,o,i,oe,t,e.root);return a.snapshot=e.root,new Fp(new bn(a,[]),e)}function pG(t){let e={},n={},r={},i="",s=new il([],e,r,i,n,oe,t,null,{});return new Vp("",new bn(s,[]))}var Fr=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(U(c=>c[al]))??B(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(U(e=>za(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(U(e=>za(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function TE(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:N(N({},e.params),t.params),data:N(N({},e.data),t.data),resolve:N(N(N(N({},t.data),e.data),i?.data),t._resolvedData)}:r={params:N({},t.params),data:N({},t.data),resolve:N(N({},t.data),t._resolvedData??{})},i&&PM(i)&&(r.resolve[al]=i.title),r}var il=class{get title(){return this.data?.[al]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=za(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=za(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Vp=class extends Op{constructor(e,n){super(n),this.url=e,bE(this,n)}toString(){return NM(this._root)}};function bE(t,e){e.value._routerState=t,e.children.forEach(n=>bE(t,n))}function NM(t){let e=t.children.length>0?` { ${t.children.map(NM).join(", ")} } `:"";return`${t.value}${e}`}function Zw(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,Or(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),Or(e.params,n.params)||t.paramsSubject.next(n.params),Hq(e.url,n.url)||t.urlSubject.next(n.url),Or(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function _E(t,e){let n=Or(t.params,e.params)&&Wq(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||_E(t.parent,e.parent))}function PM(t){return typeof t.title=="string"||t.title===null}var SE=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=oe,this.activateEvents=new It,this.deactivateEvents=new It,this.attachEvents=new It,this.detachEvents=new It,this.parentContexts=O(cl),this.location=O(Fa),this.changeDetector=O(_i),this.environmentInjector=O(In),this.inputBinder=O($p,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new H(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new H(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new H(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new H(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new yE(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Ut({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Oa]});let t=e;return t})(),yE=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Fr?this.route:e===cl?this.childContexts:this.parent.get(e,n)}},$p=new P(""),fM=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Ec([i.queryParams,i.params,i.data]).pipe(Ne(([o,a,u],c)=>(u=N(N(N({},o),a),u),c===0?B(u):Promise.resolve(u)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=MR(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:u}of a.inputs)r.activatedComponentRef.setInput(u,o[u])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function gG(t,e,n){let r=sl(t,e._root,n?n._root:void 0);return new Fp(r,e)}function sl(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=mG(t,e,n);return new bn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>sl(t,a)),o}}let r=_G(e.value),i=e.children.map(s=>sl(t,s));return new bn(r,i)}}function mG(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return sl(t,r,i);return sl(t,r)})}function _G(t){return new Fr(new Lt(t.url),new Lt(t.params),new Lt(t.queryParams),new Lt(t.fragment),new Lt(t.data),t.outlet,t.component,t)}var kM="ngNavigationCancelingError";function OM(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=Wa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=FM(!1,Hn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function FM(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[kM]=!0,n.cancellationCode=e,n}function yG(t){return VM(t)&&Wa(t.url)}function VM(t){return!!t&&t[kM]}var vG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rr({type:e,selectors:[["ng-component"]],standalone:!0,features:[yR],decls:1,vars:0,template:function(i,s){i&1&&Bt(0,"router-outlet")},dependencies:[SE],encapsulation:2});let t=e;return t})();function wG(t,e){return t.providers&&!t._injector&&(t._injector=ep(t.providers,e,`Route: ${t.path}`)),t._injector??e}function AE(t){let e=t.children&&t.children.map(AE),n=e?Ce(N({},t),{children:e}):N({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==oe&&(n.component=vG),n}function Vr(t){return t.outlet||oe}function EG(t,e){let n=t.filter(r=>Vr(r)===e);return n.push(...t.filter(r=>Vr(r)!==e)),n}function ll(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var IG=(t,e,n,r)=>U(i=>(new vE(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),vE=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Zw(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Ha(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Ha(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Ha(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Ha(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new fE(s.value.snapshot))}),e.children.length&&this.forwardEvent(new dE(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Zw(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Zw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=ll(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Lp=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ga=class{constructor(e,n){this.component=e,this.route=n}};function CG(t,e,n){let r=t._root,i=e?e._root:null;return Kc(r,i,n,[r.value])}function DG(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Ya(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!CA(t)?t:e.get(t):r}function Kc(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Ha(e);return t.children.forEach(o=>{TG(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Xc(a,n.getContext(o),i)),i}function TG(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=bG(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Lp(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Kc(t,e,a?a.children:null,r,i):Kc(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ga(a.outlet.component,o))}else o&&Xc(e,a,i),i.canActivateChecks.push(new Lp(r)),s.component?Kc(t,null,a?a.children:null,r,i):Kc(t,null,n,r,i);return i}function bG(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!fo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!fo(t.url,e.url)||!Or(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!_E(t,e)||!Or(t.queryParams,e.queryParams);case"paramsChange":default:return!_E(t,e)}}function Xc(t,e,n){let r=Ha(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Xc(o,e.children.getContext(s),n):Xc(o,null,n):Xc(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Ga(e.outlet.component,i)):n.canDeactivateChecks.push(new Ga(null,i)):n.canDeactivateChecks.push(new Ga(null,i))}function dl(t){return typeof t=="function"}function SG(t){return typeof t=="boolean"}function AG(t){return t&&dl(t.canLoad)}function xG(t){return t&&dl(t.canActivate)}function RG(t){return t&&dl(t.canActivateChild)}function MG(t){return t&&dl(t.canDeactivate)}function NG(t){return t&&dl(t.canMatch)}function LM(t){return t instanceof li||t?.name==="EmptyError"}var bp=Symbol("INITIAL_VALUE");function Qa(){return Ne(t=>Ec(t.map(e=>e.pipe(di(1),Gs(bp)))).pipe(U(e=>{for(let n of e)if(n!==!0){if(n===bp)return bp;if(n===!1||n instanceof ts)return n}return!0}),Et(e=>e!==bp),di(1)))}function PG(t,e){return dt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?B(Ce(N({},n),{guardsResult:!0})):kG(o,r,i,t).pipe(dt(a=>a&&SG(a)?OG(r,s,t,e):B(a)),U(a=>Ce(N({},n),{guardsResult:a})))})}function kG(t,e,n,r){return ce(t).pipe(dt(i=>UG(i.component,i.route,n,e,r)),Vn(i=>i!==!0,!0))}function OG(t,e,n,r){return ce(e).pipe(qs(i=>_a(VG(i.route.parent,r),FG(i.route,r),jG(t,i.path,n),LG(t,i.route,n))),Vn(i=>i!==!0,!0))}function FG(t,e){return t!==null&&e&&e(new hE(t)),B(!0)}function VG(t,e){return t!==null&&e&&e(new lE(t)),B(!0)}function LG(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return B(!0);let i=r.map(s=>Jh(()=>{let o=ll(e)??n,a=Ya(s,o),u=xG(a)?a.canActivate(e,t):Ji(o,()=>a(e,t));return is(u).pipe(Vn())}));return B(i).pipe(Qa())}function jG(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>DG(o)).filter(o=>o!==null).map(o=>Jh(()=>{let a=o.guards.map(u=>{let c=ll(o.node)??n,l=Ya(u,c),d=RG(l)?l.canActivateChild(r,t):Ji(c,()=>l(r,t));return is(d).pipe(Vn())});return B(a).pipe(Qa())}));return B(s).pipe(Qa())}function UG(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return B(!0);let o=s.map(a=>{let u=ll(e)??i,c=Ya(a,u),l=MG(c)?c.canDeactivate(t,e,n,r):Ji(u,()=>c(t,e,n,r));return is(l).pipe(Vn())});return B(o).pipe(Qa())}function BG(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return B(!0);let s=i.map(o=>{let a=Ya(o,t),u=AG(a)?a.canLoad(e,n):Ji(t,()=>a(e,n));return is(u)});return B(s).pipe(Qa(),jM(r))}function jM(t){return _y(st(e=>{if(Wa(e))throw OM(t,e)}),U(e=>e===!0))}function $G(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return B(!0);let s=i.map(o=>{let a=Ya(o,t),u=NG(a)?a.canMatch(e,n):Ji(t,()=>a(e,n));return is(u)});return B(s).pipe(Qa(),jM(r))}var ol=class{constructor(e){this.segmentGroup=e||null}},jp=class extends Error{constructor(e){super(),this.urlTree=e}};function $a(t){return ma(new ol(t))}function HG(t){return ma(new H(4e3,!1))}function qG(t){return ma(FM(!1,Hn.GuardRejected))}var wE=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return B(r);if(i.numberOfChildren>1||!i.children[oe])return HG(e.redirectTo);i=i.children[oe]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new jp(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new ts(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new be(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new H(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},EE={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function GG(t,e,n,r,i){let s=xE(t,e,n);return s.matched?(r=wG(e,r),$G(r,e,n,i).pipe(U(o=>o===!0?s:N({},EE)))):B(s)}function xE(t,e,n){if(e.path==="**")return zG(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?N({},EE):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||$q)(n,t,e);if(!i)return N({},EE);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?N(N({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function zG(t){return{matched:!0,parameters:t.length>0?yM(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function pM(t,e,n,r){return n.length>0&&QG(t,n,r)?{segmentGroup:new be(e,KG(r,new be(n,t.children))),slicedSegments:[]}:n.length===0&&YG(t,n,r)?{segmentGroup:new be(t.segments,WG(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new be(t.segments,t.children),slicedSegments:n}}function WG(t,e,n,r){let i={};for(let s of n)if(Hp(t,e,s)&&!r[Vr(s)]){let o=new be([],{});i[Vr(s)]=o}return N(N({},r),i)}function KG(t,e){let n={};n[oe]=e;for(let r of t)if(r.path===""&&Vr(r)!==oe){let i=new be([],{});n[Vr(r)]=i}return n}function QG(t,e,n){return n.some(r=>Hp(t,e,r)&&Vr(r)!==oe)}function YG(t,e,n){return n.some(r=>Hp(t,e,r))}function Hp(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function ZG(t,e,n,r){return Vr(t)!==r&&(r===oe||!Hp(e,n,t))?!1:xE(e,t,n).matched}function XG(t,e,n){return e.length===0&&!t.children[n]}var IE=class{};function JG(t,e,n,r,i,s,o="emptyOnly"){return new CE(t,e,n,r,i,o,s).recognize()}var ez=31,CE=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new wE(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new H(4002,`'${e.segmentGroup}'`)}recognize(){let e=pM(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(U(n=>{let r=new il([],Object.freeze({}),Object.freeze(N({},this.urlTree.queryParams)),this.urlTree.fragment,{},oe,this.rootComponentType,null,{}),i=new bn(r,n),s=new Vp("",i),o=aG(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,oe).pipe(Bi(r=>{if(r instanceof jp)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ol?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=TE(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(U(s=>s instanceof bn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return ce(i).pipe(qs(s=>{let o=r.children[s],a=EG(n,s);return this.processSegmentGroup(e,a,o,s)}),Cr((s,o)=>(s.push(...o),s)),$i(null),Sy(),dt(s=>{if(s===null)return $a(r);let o=UM(s);return tz(o),B(o)}))}processSegment(e,n,r,i,s,o){return ce(n).pipe(qs(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Bi(u=>{if(u instanceof ol)return B(null);throw u}))),Vn(a=>!!a),Bi(a=>{if(LM(a))return XG(r,i,s)?B(new IE):$a(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return ZG(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):$a(i):$a(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:c,remainingSegments:l}=xE(n,i,s);if(!a)return $a(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>ez&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(dt(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=GG(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Ne(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Ne(({routes:u})=>{let c=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new il(l,h,Object.freeze(N({},this.urlTree.queryParams)),this.urlTree.fragment,rz(r),Vr(r),r.component??r._loadedComponent??null,r,iz(r)),{segmentGroup:p,slicedSegments:g}=pM(n,l,d,u);if(g.length===0&&p.hasChildren())return this.processChildren(c,u,p).pipe(U(I=>I===null?null:new bn(f,I)));if(u.length===0&&g.length===0)return B(new bn(f,[]));let m=Vr(r)===s;return this.processSegment(c,u,p,g,m?oe:s,!0).pipe(U(I=>new bn(f,I instanceof bn?[I]:[])))}))):$a(n)))}getChildConfig(e,n,r){return n.children?B({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?B({routes:n._loadedRoutes,injector:n._loadedInjector}):BG(e,n,r,this.urlSerializer).pipe(dt(i=>i?this.configLoader.loadChildren(e,n).pipe(st(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):qG(n))):B({routes:[],injector:e})}};function tz(t){t.sort((e,n)=>e.value.outlet===oe?-1:n.value.outlet===oe?1:e.value.outlet.localeCompare(n.value.outlet))}function nz(t){let e=t.value.routeConfig;return e&&e.path===""}function UM(t){let e=[],n=new Set;for(let r of t){if(!nz(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=UM(r.children);e.push(new bn(r.value,i))}return e.filter(r=>!n.has(r))}function rz(t){return t.data||{}}function iz(t){return t.resolve||{}}function sz(t,e,n,r,i,s){return dt(o=>JG(t,e,n,r,o.extractedUrl,i,s).pipe(U(({state:a,tree:u})=>Ce(N({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function oz(t,e){return dt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return B(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of BM(u))o.add(c);let a=0;return ce(o).pipe(qs(u=>s.has(u)?az(u,r,t,e):(u.data=TE(u,u.parent,t).resolve,B(void 0))),st(()=>a++),va(1),dt(u=>a===o.size?B(n):fn))})}function BM(t){let e=t.children.map(n=>BM(n)).flat();return[t,...e]}function az(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!PM(i)&&(s[al]=i.title),uz(s,t,e,r).pipe(U(o=>(t._resolvedData=o,t.data=TE(t,t.parent,n).resolve,null)))}function uz(t,e,n,r){let i=eE(t);if(i.length===0)return B({});let s={};return ce(i).pipe(dt(o=>cz(t[o],e,n,r).pipe(Vn(),st(a=>{s[o]=a}))),va(1),by(s),Bi(o=>LM(o)?fn:ma(o)))}function cz(t,e,n,r){let i=ll(e)??r,s=Ya(t,i),o=s.resolve?s.resolve(e,n):Ji(i,()=>s(e,n));return is(o)}function Xw(t){return Ne(e=>{let n=t(e);return n?ce(n).pipe(U(()=>e)):B(e)})}var $M=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===oe);return i}getResolvedTitleForRoute(r){return r.data[al]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>O(lz),providedIn:"root"});let t=e;return t})(),lz=(()=>{let e=class e extends $M{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(w(aM))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),hl=new P("",{providedIn:"root",factory:()=>({})}),Up=new P(""),RE=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=O(np)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return B(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=is(r.loadComponent()).pipe(U(HM),st(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Cc(()=>{this.componentLoaders.delete(r)})),s=new da(i,()=>new wt).pipe(la());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return B({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=dz(i,this.compiler,r,this.onLoadEndListener).pipe(Cc(()=>{this.childrenLoaders.delete(i)})),a=new da(o,()=>new wt).pipe(la());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function dz(t,e,n,r){return is(t.loadChildren()).pipe(U(HM),dt(i=>i instanceof jc||Array.isArray(i)?B(i):ce(e.compileModuleAsync(i))),U(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Up,[],{optional:!0,self:!0}).flat()),{routes:o.map(AE),injector:s}}))}function hz(t){return t&&typeof t=="object"&&"default"in t}function HM(t){return hz(t)?t.default:t}var ME=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>O(fz),providedIn:"root"});let t=e;return t})(),fz=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),qM=new P(""),GM=new P("");function pz(t,e,n){let r=t.get(GM),i=t.get(_n);return t.get(de).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),gz(t))),{onViewTransitionCreated:u}=r;return u&&Ji(t,()=>u({transition:a,from:e,to:n})),o})}function gz(t){return new Promise(e=>{gw(e,{injector:t})})}var NE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new wt,this.transitionAbortSubject=new wt,this.configLoader=O(RE),this.environmentInjector=O(In),this.urlSerializer=O(ul),this.rootContexts=O(cl),this.location=O(Ua),this.inputBindingEnabled=O($p,{optional:!0})!==null,this.titleStrategy=O($M),this.options=O(hl,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=O(ME),this.createViewTransition=O(qM,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>B(void 0),this.rootComponentType=null;let r=s=>this.events.next(new uE(s)),i=s=>this.events.next(new cE(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Ce(N(N({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Lt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Zc,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Et(o=>o.id!==0),U(o=>Ce(N({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ne(o=>{this.currentTransition=o;let a=!1,u=!1;return B(o).pipe(st(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Ce(N({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Ne(c=>{let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new rs(c.id,this.urlSerializer.serialize(c.rawUrl),h,Np.IgnoredSameUrlNavigation)),c.resolve(null),fn}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return B(c).pipe(Ne(h=>{let f=this.transitions?.getValue();return this.events.next(new Ka(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?fn:Promise.resolve(h)}),sz(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),st(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=Ce(N({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Pp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:m}=c,I=new Ka(h,this.urlSerializer.serialize(f),p,g);this.events.next(I);let A=MM(this.rootComponentType).snapshot;return this.currentTransition=o=Ce(N({},c),{targetSnapshot:A,urlAfterRedirects:f,extras:Ce(N({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,B(o)}else{let h="";return this.events.next(new rs(c.id,this.urlSerializer.serialize(c.extractedUrl),h,Np.IgnoredByUrlHandlingStrategy)),c.resolve(null),fn}}),st(c=>{let l=new iE(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),U(c=>(this.currentTransition=o=Ce(N({},c),{guards:CG(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),PG(this.environmentInjector,c=>this.events.next(c)),st(c=>{if(o.guardsResult=c.guardsResult,Wa(c.guardsResult))throw OM(this.urlSerializer,c.guardsResult);let l=new sE(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Et(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Hn.GuardRejected),!1)),Xw(c=>{if(c.guards.canActivateChecks.length)return B(c).pipe(st(l=>{let d=new oE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Ne(l=>{let d=!1;return B(l).pipe(oz(this.paramsInheritanceStrategy,this.environmentInjector),st({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",Hn.NoDataFromResolver)}}))}),st(l=>{let d=new aE(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),Xw(c=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(st(f=>{d.component=f}),U(()=>{})));for(let f of d.children)h.push(...l(f));return h};return Ec(l(c.targetSnapshot.root)).pipe($i(null),di(1))}),Xw(()=>this.afterPreactivation()),Ne(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?ce(d).pipe(U(()=>o)):B(o)}),U(c=>{let l=gG(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=Ce(N({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),st(()=>{this.events.next(new nl)}),IG(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),di(1),st({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ur(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),Ry(this.transitionAbortSubject.pipe(st(c=>{throw c}))),Cc(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",Hn.SupersededByNewNavigation),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Bi(c=>{if(u=!0,VM(c))this.events.next(new ns(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),yG(c)?this.events.next(new rl(c.url)):o.resolve(!1);else{this.events.next(new tl(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return fn}))}))}cancelNavigationTransition(r,i,s){let o=new ns(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function mz(t){return t!==Zc}var _z=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>O(yz),providedIn:"root"});let t=e;return t})(),DE=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},yz=(()=>{let e=class e extends DE{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Xi(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),zM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>O(vz),providedIn:"root"});let t=e;return t})(),vz=(()=>{let e=class e extends zM{constructor(){super(...arguments),this.location=O(Ua),this.urlSerializer=O(ul),this.options=O(hl,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=O(ME),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ts,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=MM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Ka)this.stateMemento=this.createStateMemento();else if(r instanceof rs)this.rawUrlTree=i.initialUrl;else if(r instanceof Pp){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof nl?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof ns&&(r.code===Hn.GuardRejected||r.code===Hn.NoDataFromResolver)?this.restoreHistory(i):r instanceof tl?this.restoreHistory(i,!0):r instanceof ur&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=N(N({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=N(N({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Xi(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Qc=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Qc||{});function WM(t,e){t.events.pipe(Et(n=>n instanceof ur||n instanceof ns||n instanceof tl||n instanceof rs),U(n=>n instanceof ur||n instanceof rs?Qc.COMPLETE:(n instanceof ns?n.code===Hn.Redirect||n.code===Hn.SupersededByNewNavigation:!1)?Qc.REDIRECTING:Qc.FAILED),Et(n=>n!==Qc.REDIRECTING),di(1)).subscribe(()=>{e()})}function wz(t){throw t}var Ez={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Iz={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},cr=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=O(tp),this.stateManager=O(zM),this.options=O(hl,{optional:!0})||{},this.pendingTasks=O(rp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=O(NE),this.urlSerializer=O(ul),this.location=O(Ua),this.urlHandlingStrategy=O(ME),this._events=new wt,this.errorHandler=this.options.errorHandler||wz,this.navigated=!1,this.routeReuseStrategy=O(_z),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=O(Up,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!O($p,{optional:!0}),this.eventsSubscription=new it,this.isNgZoneEnabled=O(de)instanceof de&&de.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof ns&&i.code!==Hn.Redirect&&i.code!==Hn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ur)this.navigated=!0;else if(i instanceof rl){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||mz(s.source)};this.scheduleNavigation(a,Zc,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}Dz(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Zc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=N({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(AE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:a,d=null;switch(u){case"merge":d=N(N({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=SM(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return AM(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Wa(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Zc,null,i)}navigate(r,i={skipLocationChange:!1}){return Cz(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=N({},Ez):i===!1?s=N({},Iz):s=i,Wa(r))return cM(this.currentUrlTree,r,s);let o=this.parseUrl(r);return cM(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,l;a?(u=a.resolve,c=a.reject,l=a.promise):l=new Promise((h,f)=>{u=h,c=f});let d=this.pendingTasks.add();return WM(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Cz(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new H(4008,!1)}function Dz(t){return!(t instanceof nl)&&!(t instanceof rl)}var Bp=class{};var Tz=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Et(r=>r instanceof ur),qs(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=ep(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(u,o.children??o._loadedRoutes))}return ce(s).pipe(Ui())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=B(null);let o=s.pipe(dt(a=>a===null?B(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return ce([o,a]).pipe(Ui())}else return o})}};e.\u0275fac=function(i){return new(i||e)(w(cr),w(np),w(In),w(Bp),w(RE))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),KM=new P(""),bz=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Ka?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof ur?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof rs&&r.code===Np.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof kp&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new kp(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){Qx()},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function Sz(t){return t.routerState.root}function fl(t,e){return{\u0275kind:t,\u0275providers:e}}function Az(){let t=O(or);return e=>{let n=t.get(ja);if(e!==n.components[0])return;let r=t.get(cr),i=t.get(QM);t.get(PE)===1&&r.initialNavigation(),t.get(YM,null,le.Optional)?.setUpPreloading(),t.get(KM,null,le.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var QM=new P("",{factory:()=>new wt}),PE=new P("",{providedIn:"root",factory:()=>1});function xz(){return fl(2,[{provide:PE,useValue:0},{provide:op,multi:!0,deps:[or],useFactory:e=>{let n=e.get(BR,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(cr),s=e.get(QM);WM(i,()=>{r(!0)}),e.get(NE).afterPreactivation=()=>(r(!0),s.closed?B(void 0):s),i.initialNavigation()}))}}])}function Rz(){return fl(3,[{provide:op,multi:!0,useFactory:()=>{let e=O(cr);return()=>{e.setUpLocationChangeListener()}}},{provide:PE,useValue:2}])}var YM=new P("");function Mz(t){return fl(0,[{provide:YM,useExisting:Tz},{provide:Bp,useExisting:t}])}function Nz(){return fl(8,[fM,{provide:$p,useExisting:fM}])}function Pz(t){let e=[{provide:qM,useValue:pz},{provide:GM,useValue:N({skipNextTransition:!!t?.skipInitialTransition},t)}];return fl(9,e)}var gM=new P("ROUTER_FORROOT_GUARD"),kz=[Ua,{provide:ul,useClass:Jc},cr,cl,{provide:Fr,useFactory:Sz,deps:[cr]},RE,[]],kE=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[kz,[],{provide:Up,multi:!0,useValue:r},{provide:gM,useFactory:Lz,deps:[[cr,new so,new qf]]},{provide:hl,useValue:i||{}},i?.useHash?Fz():Vz(),Oz(),i?.preloadingStrategy?Mz(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?jz(i):[],i?.bindToComponentInputs?Nz().\u0275providers:[],i?.enableViewTransitions?Pz().\u0275providers:[],Uz()]}}static forChild(r){return{ngModule:e,providers:[{provide:Up,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(w(gM,8))},e.\u0275mod=He({type:e}),e.\u0275inj=$e({});let t=e;return t})();function Oz(){return{provide:KM,useFactory:()=>{let t=O(ZR),e=O(de),n=O(hl),r=O(NE),i=O(ul);return n.scrollOffset&&t.setOffset(n.scrollOffset),new bz(i,r,t,e,n)}}}function Fz(){return{provide:Ci,useClass:wp}}function Vz(){return{provide:Ci,useClass:Lw}}function Lz(t){return"guarded"}function jz(t){return[t.initialNavigation==="disabled"?Rz().\u0275providers:[],t.initialNavigation==="enabledBlocking"?xz().\u0275providers:[]]}var mM=new P("");function Uz(){return[{provide:mM,useFactory:Az},{provide:Tw,multi:!0,useExisting:mM}]}var Bz="firebase",$z="10.8.0";hn(Bz,$z,"app");var Lr=new fi("ANGULARFIRE2_VERSION");var Hz=(t,e)=>{let n=e?[e]:uS(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},lr=class{constructor(){return Hz(qz)}},qz="app-check";function FE(){}var qp=class{zone;delegate;constructor(e,n=Ey){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},VE=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",FE,{},FE,FE)),n.pipe(st({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ss=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new qp(Zone.current)),this.insideAngular=n.run(()=>new qp(Zone.current,ci)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(w(de))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ZM(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function LE(t){return t.pipe(wn(ZM().outsideAngular))}function ze(t){return Gz(ZM())(t)}function Gz(t){return function(n){return n=n.lift(new VE(t.ngZone)),n.pipe(er(t.outsideAngular),wn(t.insideAngular))}}var zz=new Map,Wz={activated:!1,tokenObservers:[]},Kz={initialized:!1,enabled:!1};function dr(t){return zz.get(t)||Object.assign({},Wz)}function nN(){return Kz}var Qz="https://content-firebaseappcheck.googleapis.com/v1";var Yz="exchangeDebugToken",XM={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},ise=24*60*60*1e3;var UE=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return v(this,null,function*(){this.stop();try{this.pending=new Tt,this.pending.promise.catch(n=>{}),yield Zz(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Tt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function Zz(t){return new Promise(e=>{setTimeout(e,t)})}var Xz={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},os=new nS("appCheck","AppCheck",Xz);function rN(t){if(!dr(t).activated)throw os.create("use-before-activation",{appName:t.name})}function iN(r,i){return v(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(t,a)}catch(f){throw os.create("fetch-network-error",{originalErrorMessage:f?.message})}if(u.status!==200)throw os.create("fetch-status-error",{httpStatus:u.status});let c;try{c=yield u.json()}catch(f){throw os.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=c.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw os.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function sN(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${Qz}/projects/${n}/apps/${r}:${Yz}?key=${i}`,body:{debug_token:e}}}var Jz="firebase-app-check-database",e6=1,BE="firebase-app-check-store";var zp=null;function t6(){return zp||(zp=new Promise((t,e)=>{try{let n=indexedDB.open(Jz,e6);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(os.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(BE,{keyPath:"compositeKey"})}}}catch(n){e(os.create("storage-open",{originalErrorMessage:n?.message}))}}),zp)}function n6(t,e){return r6(i6(t),e)}function r6(t,e){return v(this,null,function*(){let r=(yield t6()).transaction(BE,"readwrite"),s=r.objectStore(BE).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var c;a(os.create("storage-set",{originalErrorMessage:(c=u.target.error)===null||c===void 0?void 0:c.message}))}})})}function i6(t){return`${t.options.appId}-${t.name}`}var $E=new ji("@firebase/app-check");function jE(t,e){return Th()?n6(t,e).catch(n=>{$E.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function oN(){return nN().enabled}function aN(){return v(this,null,function*(){let t=nN();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var s6={error:"UNKNOWN_ERROR"};function o6(t){return Dh.encodeString(JSON.stringify(t),!1)}function HE(t,e=!1){return v(this,null,function*(){let n=t.app;rN(n);let r=dr(n),i=r.token,s;if(i&&!pl(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(pl(u)?i=u:yield jE(n,void 0))}if(!e&&i&&pl(i))return{token:i.token};let o=!1;if(oN()){r.exchangeTokenPromise||(r.exchangeTokenPromise=iN(sN(n,yield aN()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield jE(n,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield dr(n).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?$E.warn(u.message):$E.error(u),s=u}let a;return i?s?pl(i)?a={token:i.token,internalError:s}:a=eN(s):(a={token:i.token},r.token=i,yield jE(n,i)):a=eN(s),o&&l6(n,a),a})}function a6(t){return v(this,null,function*(){let e=t.app;rN(e);let{provider:n}=dr(e);if(oN()){let r=yield aN(),{token:i}=yield iN(sN(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function u6(t,e,n,r){let{app:i}=t,s=dr(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&pl(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),JM(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>JM(t))}function uN(t,e){let n=dr(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function JM(t){let{app:e}=t,n=dr(e),r=n.tokenRefresher;r||(r=c6(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function c6(t){let{app:e}=t;return new UE(()=>v(this,null,function*(){let n=dr(e),r;if(n.token?r=yield HE(t,!0):r=yield HE(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=dr(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},XM.RETRIAL_MIN_WAIT,XM.RETRIAL_MAX_WAIT)}function l6(t,e){let n=dr(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function pl(t){return t.expireTimeMillis-Date.now()>0}function eN(t){return{token:o6(s6),error:t}}var qE=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=dr(this.app);for(let n of e)uN(this.app,n.next);return Promise.resolve()}};function d6(t,e){return new qE(t,e)}function h6(t){return{getToken:e=>HE(t,e),getLimitedUseToken:()=>a6(t),addTokenListener:e=>u6(t,"INTERNAL",e),removeTokenListener:e=>uN(t.app,e)}}var f6="@firebase/app-check",p6="0.8.2";var g6="app-check",tN="app-check-internal";function m6(){ai(new Ft(g6,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return d6(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(tN).initialize()})),ai(new Ft(tN,t=>{let e=t.getProvider("app-check").getImmediate();return h6(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),hn(f6,p6)}m6();var _6=["localhost","0.0.0.0","127.0.0.1"],mse=typeof window<"u"&&_6.includes(window.location.hostname);var y6="firebase",v6="10.8.0";Je.registerVersion(y6,v6,"app-compat");var w6=["ngOnDestroy"],lN=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(w6.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(l=>{let d=l?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var Kp=class{constructor(e){return e}},jr=new P("angularfire2.app.options"),Ur=new P("angularfire2.app.name");function Di(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=Je.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Je.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;E6("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Kp(o)}var E6=(t,...e)=>{Sw()&&typeof console<"u"&&console[t](...e)},I6={provide:Kp,useFactory:Di,deps:[jr,de,[new so,Ur]]},dN=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:jr,useValue:n},{provide:Ur,useValue:r}]}}constructor(n){Je.registerVersion("angularfire",Lr.full,"core"),Je.registerVersion("angularfire",Lr.full,"app-compat"),Je.registerVersion("angular",IR.full,n.toString())}static \u0275fac=function(r){return new(r||t)(w(St))};static \u0275mod=He({type:t});static \u0275inj=$e({providers:[I6]})}return t})();function as(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return C6(i,o)||(cN("error",`${e} was already initialized on the ${n} Firebase App with different settings.${D6?" You may need to reload as Firebase is not HMR aware.":""}`),cN("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function C6(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var D6=typeof module<"u"&&!!module.hot,cN=(t,...e)=>{Sw()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var gl=new P("angularfire2.auth.use-emulator"),ml=new P("angularfire2.auth.settings"),_l=new P("angularfire2.auth.tenant-id"),yl=new P("angularfire2.auth.langugage-code"),vl=new P("angularfire2.auth.use-device-language"),wl=new P("angularfire.auth.persistence"),El=(t,e,n,r,i,s,o,a)=>as(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[c,l]of Object.entries(o))u.settings[c]=l;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]),Qp=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,l,d,h,f){let p=new wt,g=B(void 0).pipe(wn(o.outsideAngular),Ne(()=>s.runOutsideAngular(()=>import("./chunk-2UTFESB6.js"))),U(()=>Di(n,s,r)),U(m=>El(m,s,a,c,l,d,u,h)),tf({bufferSize:1,refCount:!1}));if(lo(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=B(null);else{g.pipe(Vn()).subscribe();let m=g.pipe(Ne(D=>D.getRedirectResult().then(k=>k,()=>null)),ze,tf({bufferSize:1,refCount:!1})),I=g.pipe(Ne(D=>new se(k=>({unsubscribe:s.runOutsideAngular(()=>D.onAuthStateChanged(q=>k.next(q),q=>k.error(q),()=>k.complete()))})))),A=g.pipe(Ne(D=>new se(k=>({unsubscribe:s.runOutsideAngular(()=>D.onIdTokenChanged(q=>k.next(q),q=>k.error(q),()=>k.complete()))}))));this.authState=m.pipe(nf(I),er(o.outsideAngular),wn(o.insideAngular)),this.user=m.pipe(nf(A),er(o.outsideAngular),wn(o.insideAngular)),this.idToken=this.user.pipe(Ne(D=>D?ce(D.getIdToken()):B(null))),this.idTokenResult=this.user.pipe(Ne(D=>D?ce(D.getIdTokenResult()):B(null))),this.credential=ya(m,p,this.authState.pipe(Et(D=>!D))).pipe(U(D=>D?.user?D:null),er(o.outsideAngular),wn(o.insideAngular))}return lN(this,g,s,{spy:{apply:(m,I,A)=>{(m.startsWith("signIn")||m.startsWith("createUser"))&&A.then(D=>p.next(D))}}})}static \u0275fac=function(r){return new(r||t)(w(jr),w(Ur,8),w(St),w(de),w(ss),w(gl,8),w(ml,8),w(_l,8),w(yl,8),w(vl,8),w(wl,8),w(lr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var fN="@firebase/database",pN="1.0.3";var iC="";function sC(t){iC=t}var eI=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),lt(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Sh(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var tI=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return On(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var zN=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new eI(e)}}catch{}return new tI},go=zN("localStorage"),nI=zN("sessionStorage");var eu=new ji("@firebase/database"),WN=function(){let t=1;return function(){return t++}}(),KN=function(t){let e=aS(t),n=new oS;n.update(e);let r=n.digest();return Dh.encodeByteArray(r)},Gl=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Gl.apply(null,r):typeof r=="object"?e+=lt(r):e+=r,e+=" "}return e},mo=null,gN=!0,QN=function(t,e){T(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(eu.logLevel=Fn.VERBOSE,mo=eu.log.bind(eu),e&&nI.set("logging_enabled",!0)):typeof t=="function"?mo=t:(mo=null,nI.remove("logging_enabled"))},Rt=function(...t){if(gN===!0&&(gN=!1,mo===null&&nI.get("logging_enabled")===!0&&QN(!0)),mo){let e=Gl.apply(null,t);mo(e)}},zl=function(t){return function(...e){Rt(t,...e)}},rI=function(...t){let e="FIREBASE INTERNAL ERROR: "+Gl(...t);eu.error(e)},Hr=function(...t){let e=`FIREBASE FATAL ERROR: ${Gl(...t)}`;throw eu.error(e),new Error(e)},Wt=function(...t){let e="FIREBASE WARNING: "+Gl(...t);eu.warn(e)},T6=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Wt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Cg=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},b6=function(t){if(Er()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ds="[MIN_NAME]",Ti="[MAX_NAME]",yo=function(t,e){if(t===e)return 0;if(t===ds||e===Ti)return-1;if(e===ds||t===Ti)return 1;{let n=mN(t),r=mN(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},S6=function(t,e){return t===e?0:t<e?-1:1},Il=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+lt(e))},oC=function(t){if(typeof t!="object"||t===null)return lt(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=lt(e[r]),n+=":",n+=oC(t[e[r]]);return n+="}",n},YN=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Mt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var ZN=function(t){T(!Cg(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,u;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(u=n;u;u-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let l=c.join(""),d="";for(u=0;u<64;u+=8){let h=parseInt(l.substr(u,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},A6=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},x6=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function R6(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var M6=new RegExp("^-?(0*)\\d{1,10}$"),N6=-2147483648,P6=2147483647,mN=function(t){if(M6.test(t)){let e=Number(t);if(e>=N6&&e<=P6)return e}return null},cu=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Wt("Exception was thrown by user callback.",n),e},Math.floor(0))}},k6=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},bl=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var iI=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Wt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var sI=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Rt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Wt(e)}},Sl=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Zp="5",XN="v",JN="s",eP="r",tP="f",nP=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,rP="ls",iP="p",oI="ac",sP="websocket",oP="long_polling";var Xp=class{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=go.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&go.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function O6(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function aP(t,e,n){T(typeof e=="string","typeof type must == string"),T(typeof n=="object","typeof params must == object");let r;if(e===sP)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===oP)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);O6(t)&&(n.ns=t.namespace);let i=[];return Mt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var aI=class{constructor(){this.counters_={}}incrementCounter(e,n=1){On(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return eS(this.counters_)}};var WE={},KE={};function aC(t){let e=t.toString();return WE[e]||(WE[e]=new aI),WE[e]}function F6(t,e){let n=t.toString();return KE[n]||(KE[n]=e()),KE[n]}var uI=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&cu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var _N="start",V6="close",L6="pLPCommand",j6="pRTLPCB",uP="id",cP="pw",lP="ser",U6="cb",B6="seg",$6="ts",H6="d",q6="dframe",dP=1870,hP=30,G6=dP-hP,z6=25e3,W6=3e4,Ml=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=zl(e),this.stats_=aC(n),this.urlFn=u=>(this.appCheckToken&&(u[oI]=this.appCheckToken),aP(n,oP,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new uI(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(W6)),b6(()=>{if(this.isClosed_)return;this.scriptTagHolder=new cI((...s)=>{let[o,a,u,c,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===_N)this.id=a,this.password=u;else if(o===V6)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[_N]="t",r[lP]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[U6]=this.scriptTagHolder.uniqueCallbackIdentifier),r[XN]=Zp,this.transportSessionId&&(r[JN]=this.transportSessionId),this.lastSessionId&&(r[rP]=this.lastSessionId),this.applicationId&&(r[iP]=this.applicationId),this.appCheckToken&&(r[oI]=this.appCheckToken),typeof location<"u"&&location.hostname&&nP.test(location.hostname)&&(r[eP]=tP);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return Er()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!A6()&&!x6()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=lt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=Jb(n),i=YN(r,G6);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(Er())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[q6]="t",r[uP]=e,r[cP]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=lt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},cI=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Er())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=WN(),window[L6+this.uniqueCallbackIdentifier]=e,window[j6+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Rt("frame writing exception"),a.stack&&Rt(a.stack),Rt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Rt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[uP]=this.myID,e[cP]=this.myPW,e[lP]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+hP+r.length<=dP;){let o=this.pendingSegs.shift();r=r+"&"+B6+i+"="+o.seg+"&"+$6+i+"="+o.ts+"&"+H6+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(z6)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){Er()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Rt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var K6=16384,Q6=45e3,Jp=null;typeof MozWebSocket<"u"?Jp=MozWebSocket:typeof WebSocket<"u"&&(Jp=WebSocket);var Xa=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=zl(this.connId),this.stats_=aC(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[XN]=Zp,!Er()&&typeof location<"u"&&location.hostname&&nP.test(location.hostname)&&(a[eP]=tP),r&&(a[JN]=r),i&&(a[rP]=i),s&&(a[oI]=s),o&&(a[iP]=o),aP(n,sP,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,go.set("previous_websocket_failure",!0);try{let i;if(Er()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Zp}/${iC}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Jp(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Jp!==null&&!t.forceDisallow_}static previouslyFailed(){return go.isInMemoryStorage||go.get("previous_websocket_failure")===!0}markConnectionHealthy(){go.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Sh(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(T(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=lt(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=YN(r,K6);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Q6))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),fP=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Ml,Xa]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Xa&&Xa.isAvailable(),i=r&&!Xa.previouslyFailed();if(n.webSocketOnly&&(r||Wt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Xa];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),Y6=6e4,Z6=5e3,X6=10*1024,J6=100*1024,QE="t",yN="d",e3="s",vN="r",t3="e",wN="o",EN="a",IN="n",CN="p",n3="h",lI=class{constructor(e,n,r,i,s,o,a,u,c,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=zl("c:"+this.id+":"),this.transportManager_=new fP(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=bl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>J6?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>X6?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(QE in e){let n=e[QE];n===EN?this.upgradeIfSecondaryHealthy_():n===vN?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===wN&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Il("t",e),r=Il("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:CN,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:EN,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:IN,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Il("t",e),r=Il("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Il(QE,e);if(yN in e){let r=e[yN];if(n===n3){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===IN){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===e3?this.onConnectionShutdown_(r):n===vN?this.onReset_(r):n===t3?rI("Server Error: "+r):n===wN?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rI("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Zp!==r&&Wt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),bl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Y6))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):bl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Z6))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:CN,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(go.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var eg=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var tg=class{constructor(e){this.allowedEvents_=e,this.listeners_={},T(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){T(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var ng=class t extends tg{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ry()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return T(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var DN=32,TN=768,Ie=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function Ee(){return new Ie("")}function ae(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function hs(t){return t.pieces_.length-t.pieceNum_}function Oe(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ie(t.pieces_,e)}function uC(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function r3(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Nl(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function pP(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ie(e,0)}function We(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ie)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Ie(n,0)}function ue(t){return t.pieceNum_>=t.pieces_.length}function nn(t,e){let n=ae(t),r=ae(e);if(n===null)return e;if(n===r)return nn(Oe(t),Oe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function i3(t,e){let n=Nl(t,0),r=Nl(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=yo(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function cC(t,e){if(hs(t)!==hs(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Gn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(hs(t)>hs(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var dI=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Nl(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=yc(this.parts_[r]);gP(this)}};function s3(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=yc(e),gP(t)}function o3(t){let e=t.parts_.pop();t.byteLength_-=yc(e),t.parts_.length>0&&(t.byteLength_-=1)}function gP(t){if(t.byteLength_>TN)throw new Error(t.errorPrefix_+"has a key path longer than "+TN+" bytes ("+t.byteLength_+").");if(t.parts_.length>DN)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+DN+") or object contains a cycle "+po(t))}function po(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var hI=class t extends tg{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return T(e==="visible","Unknown event type: "+e),[this.visible_]}};var Cl=1e3,a3=60*5*1e3,bN=30*1e3,u3=1.3,c3=3e4,l3="server_kill",SN=3,lC=(()=>{class t extends eg{constructor(n,r,i,s,o,a,u,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=zl("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Cl,this.maxReconnectDelay_=a3,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!Er())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");hI.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&ng.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(lt(o)),T(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new Tt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),T(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),T(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,u=>{let c=u.d,l=u.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&On(n,"w")){let i=Li(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Wt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||iS(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=bN)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=rS(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),T(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+lt(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):rI("Unrecognized action received from server: "+lt(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){T(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Cl,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Cl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>c3&&(this.reconnectDelay_=Cl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*u3)}this.onConnectStatus_(!1)}establishConnection_(){return v(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,i())},l=function(h){T(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(h)};this.realtime_={close:c,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?Rt("getToken() completed but was canceled"):(Rt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,u=new lI(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{Wt(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(l3)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Wt(h),c())}}})}interrupt(n){Rt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Rt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Ah(this.interruptReasons_)&&(this.reconnectDelay_=Cl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>oC(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new Ie(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Rt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=SN&&(this.reconnectDelay_=bN,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Rt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=SN&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";Er()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+iC.replace(/\./g,"-")]=1,ry()?n["framework.cordova"]=1:tS()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=ng.getInstance().currentlyOnline();return Ah(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),pe=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var tu=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new pe(ds,e),i=new pe(ds,n);return this.compare(r,i)!==0}minPost(){return pe.MIN}};var Yp,rg=class extends tu{static get __EMPTY_NODE(){return Yp}static set __EMPTY_NODE(e){Yp=e}compare(e,n){return yo(e.name,n.name)}isDefinedOn(e){throw ra("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return pe.MIN}maxPost(){return new pe(Ti,Yp)}makePost(e,n){return T(typeof e=="string","KeyIndex indexValue must always be a string."),new pe(e,Yp)}toString(){return".key"}},$r=new rg;var Ja=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},hr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??zn.EMPTY_NODE,this.right=o??zn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return zn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return zn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),fI=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new hr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},zn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,hr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,hr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ja(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Ja(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Ja(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Ja(this.root_,null,this.comparator_,!0,e)}};zn.EMPTY_NODE=new fI;function d3(t,e){return yo(t.name,e.name)}function dC(t,e){return yo(t,e)}var pI;function h3(t){pI=t}var mP=function(t){return typeof t=="number"?"number:"+ZN(t):"string:"+t},_P=function(t){if(t.isLeafNode()){let e=t.val();T(typeof e=="string"||typeof e=="number"||typeof e=="object"&&On(e,".sv"),"Priority must be a string or number.")}else T(t===pI||t.isEmpty(),"priority of unexpected type.");T(t===pI||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var AN,nu=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,T(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),_P(this.priorityNode_)}static set __childrenNodeConstructor(n){AN=n}static get __childrenNodeConstructor(){return AN}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ue(n)?this:ae(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ae(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(T(i!==".priority"||hs(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Oe(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+mP(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=ZN(this.value_):n+=this.value_,this.lazyHash_=KN(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(T(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return T(s>=0,"Unknown leaf type: "+r),T(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),yP,vP;function f3(t){yP=t}function p3(t){vP=t}var gI=class extends tu{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?yo(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return pe.MIN}maxPost(){return new pe(Ti,new nu("[PRIORITY-POST]",vP))}makePost(e,n){let r=yP(e);return new pe(n,new nu("[PRIORITY-POST]",r))}toString(){return".priority"}},Le=new gI;var g3=Math.log(2),mI=class{constructor(e){let n=s=>parseInt(Math.log(s)/g3,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},ig=function(t,e,n,r){t.sort(e);let i=function(u,c){let l=c-u,d,h;if(l===0)return null;if(l===1)return d=t[u],h=n?n(d):d,new hr(h,d.node,hr.BLACK,null,null);{let f=parseInt(l/2,10)+u,p=i(u,f),g=i(f+1,c);return d=t[f],h=n?n(d):d,new hr(h,d.node,hr.BLACK,p,g)}},s=function(u){let c=null,l=null,d=t.length,h=function(p,g){let m=d-p,I=d;d-=p;let A=i(m+1,I),D=t[m],k=n?n(D):D;f(new hr(k,D.node,g,null,A))},f=function(p){c?(c.left=p,c=p):(l=p,c=p)};for(let p=0;p<u.count;++p){let g=u.nextBitIsOne(),m=Math.pow(2,u.count-(p+1));g?h(m,hr.BLACK):(h(m,hr.BLACK),h(m,hr.RED))}return l},o=new mI(t.length),a=s(o);return new zn(r||e,a)};var YE,Za={},ru=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return T(Za&&Le,"ChildrenNode.ts has not been loaded"),YE=YE||new t({".priority":Za},{".priority":Le}),YE}get(e){let n=Li(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof zn?n:null}hasIndex(e){return On(this.indexSet_,e.toString())}addIndex(e,n){T(e!==$r,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(pe.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=ig(r,e.getCompare()):a=Za;let u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;let l=Object.assign({},this.indexes_);return l[u]=a,new t(l,c)}addToIndexes(e,n){let r=_c(this.indexes_,(i,s)=>{let o=Li(this.indexSet_,s);if(T(o,"Missing index implementation for "+s),i===Za)if(o.isDefinedOn(e.node)){let a=[],u=n.getIterator(pe.Wrap),c=u.getNext();for(;c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),ig(a,o.getCompare())}else return Za;else{let a=n.get(e.name),u=i;return a&&(u=u.remove(new pe(e.name,a))),u.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=_c(this.indexes_,i=>{if(i===Za)return i;{let s=n.get(e.name);return s?i.remove(new pe(e.name,s)):i}});return new t(r,this.indexSet_)}};var Dl,ne=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&_P(this.priorityNode_),this.children_.isEmpty()&&T(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Dl||(Dl=new t(new zn(dC),null,ru.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Dl}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Dl:r}}getChild(n){let r=ae(n);return r===null?this:this.getImmediateChild(r).getChild(Oe(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(T(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new pe(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Dl:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ae(n);if(i===null)return r;{T(ae(n)!==".priority"||hs(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Oe(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Le,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+mP(this.getPriority().val())+":"),this.forEachChild(Le,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":KN(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new pe(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new pe(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new pe(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,pe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,pe.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Wl?-1:0}withIndex(n){if(n===$r||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===$r||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Le),s=r.getIterator(Le),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===$r?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),_I=class extends ne{constructor(){super(new zn(dC),ne.EMPTY_NODE,ru.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ne.EMPTY_NODE}isEmpty(){return!1}},Wl=new _I;Object.defineProperties(pe,{MIN:{value:new pe(ds,ne.EMPTY_NODE)},MAX:{value:new pe(Ti,Wl)}});rg.__EMPTY_NODE=ne.EMPTY_NODE;nu.__childrenNodeConstructor=ne;h3(Wl);p3(Wl);var m3=!0;function Ye(t,e=null){if(t===null)return ne.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),T(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new nu(n,Ye(e))}if(!(t instanceof Array)&&m3){let n=[],r=!1;if(Mt(t,(o,a)=>{if(o.substring(0,1)!=="."){let u=Ye(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new pe(o,u)))}}),n.length===0)return ne.EMPTY_NODE;let s=ig(n,d3,o=>o.name,dC);if(r){let o=ig(n,Le.getCompare());return new ne(s,Ye(e),new ru({".priority":o},{".priority":Le}))}else return new ne(s,Ye(e),ru.Default)}else{let n=ne.EMPTY_NODE;return Mt(t,(r,i)=>{if(On(t,r)&&r.substring(0,1)!=="."){let s=Ye(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Ye(e))}}f3(Ye);var Pl=class extends tu{constructor(e){super(),this.indexPath_=e,T(!ue(e)&&ae(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?yo(e.name,n.name):s}makePost(e,n){let r=Ye(e),i=ne.EMPTY_NODE.updateChild(this.indexPath_,r);return new pe(n,i)}maxPost(){let e=ne.EMPTY_NODE.updateChild(this.indexPath_,Wl);return new pe(Ti,e)}toString(){return Nl(this.indexPath_,0).join("/")}};var yI=class extends tu{compare(e,n){let r=e.node.compareTo(n.node);return r===0?yo(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return pe.MIN}maxPost(){return pe.MAX}makePost(e,n){let r=Ye(e);return new pe(n,r)}toString(){return".value"}},hC=new yI;function wP(t){return{type:"value",snapshotNode:t}}function iu(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function kl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Ol(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function _3(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Fl=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){T(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(kl(n,a)):T(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(iu(n,r)):o.trackChildChange(Ol(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Le,(i,s)=>{n.hasChild(i)||r.trackChildChange(kl(i,s))}),n.isLeafNode()||n.forEachChild(Le,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Ol(i,s,o))}else r.trackChildChange(iu(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ne.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var sg=class t{constructor(e){this.indexedFilter_=new Fl(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new pe(n,r))||(r=ne.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=ne.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(ne.EMPTY_NODE);let s=this;return n.forEachChild(Le,(o,a)=>{s.matches(new pe(o,a))||(i=i.updateImmediateChild(o,ne.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var vI=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new sg(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new pe(n,r))||(r=ne.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=ne.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=ne.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(ne.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ne.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;T(a.numChildren()===this.limit_,"");let u=new pe(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,u);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(Ol(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(kl(n,d));let g=a.updateImmediateChild(n,ne.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(iu(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(c,u)>=0?(s!=null&&(s.trackChildChange(kl(c.name,c.node)),s.trackChildChange(iu(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,ne.EMPTY_NODE)):e}};var Vl=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Le}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return T(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return T(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ds}hasEnd(){return this.endSet_}getIndexEndValue(){return T(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return T(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ti}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return T(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Le}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function y3(t){return t.loadsAllData()?new Fl(t.getIndex()):t.hasLimit()?new vI(t):new sg(t)}function v3(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function w3(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function wI(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function E3(t,e,n){let r;return t.index_===$r||n?r=wI(t,e,n):r=wI(t,e,Ti),r.startAfterSet_=!0,r}function EI(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function I3(t,e,n){let r;return t.index_===$r||n?r=EI(t,e,n):r=EI(t,e,ds),r.endBeforeSet_=!0,r}function Dg(t,e){let n=t.copy();return n.index_=e,n}function xN(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Le?n="$priority":t.index_===hC?n="$value":t.index_===$r?n="$key":(T(t.index_ instanceof Pl,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=lt(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=lt(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+lt(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=lt(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+lt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function RN(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Le&&(e.i=t.index_.toString()),e}var II=class t extends eg{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=zl("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(T(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let u=xN(e._queryParams);this.restRequest_(s+".json",u,(c,l)=>{let d=l;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),Li(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=xN(e._queryParams),r=e._path.toString(),i=new Tt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+sS(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=Sh(a.responseText)}catch{Wt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&Wt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var CI=class{constructor(){this.rootNode_=ne.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function og(){return{value:null,children:new Map}}function lu(t,e,n){if(ue(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ae(e);t.children.has(r)||t.children.set(r,og());let i=t.children.get(r);e=Oe(e),lu(i,e,n)}}function DI(t,e){if(ue(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Le,(r,i)=>{lu(t,new Ie(r),i)}),DI(t,e)}}else if(t.children.size>0){let n=ae(e);return e=Oe(e),t.children.has(n)&&DI(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function TI(t,e,n){t.value!==null?n(e,t.value):C3(t,(r,i)=>{let s=new Ie(e.toString()+"/"+r);TI(i,s,n)})}function C3(t,e){t.children.forEach((n,r)=>{e(r,n)})}var bI=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Mt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var MN=10*1e3,D3=30*1e3,T3=5*60*1e3,SI=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new bI(e);let r=MN+(D3-MN)*Math.random();bl(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;Mt(e,(i,s)=>{s>0&&On(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),bl(this.reportStats_.bind(this),Math.floor(Math.random()*2*T3))}};var Br=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Br||{});function fC(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function pC(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function gC(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var AI=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Br.ACK_USER_WRITE,this.source=fC()}operationForChild(e){if(ue(this.path)){if(this.affectedTree.value!=null)return T(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new Ie(e));return new t(Ee(),n,this.revert)}}else return T(ae(this.path)===e,"operationForChild called for unrelated child."),new t(Oe(this.path),this.affectedTree,this.revert)}};var ag=class t{constructor(e,n){this.source=e,this.path=n,this.type=Br.LISTEN_COMPLETE}operationForChild(e){return ue(this.path)?new t(this.source,Ee()):new t(this.source,Oe(this.path))}};var su=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Br.OVERWRITE}operationForChild(e){return ue(this.path)?new t(this.source,Ee(),this.snap.getImmediateChild(e)):new t(this.source,Oe(this.path),this.snap)}};var Ll=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Br.MERGE}operationForChild(e){if(ue(this.path)){let n=this.children.subtree(new Ie(e));return n.isEmpty()?null:n.value?new su(this.source,Ee(),n.value):new t(this.source,Ee(),n)}else return T(ae(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Oe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var qr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ue(e))return this.isFullyInitialized()&&!this.filtered_;let n=ae(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var xI=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function b3(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(_3(o.childName,o.snapshotNode))}),Tl(t,i,"child_removed",e,r,n),Tl(t,i,"child_added",e,r,n),Tl(t,i,"child_moved",s,r,n),Tl(t,i,"child_changed",e,r,n),Tl(t,i,"value",e,r,n),i}function Tl(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,u)=>A3(t,a,u)),o.forEach(a=>{let u=S3(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(u,t.query_))})})}function S3(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function A3(t,e,n){if(e.childName==null||n.childName==null)throw ra("Should only compare child_ events.");let r=new pe(e.childName,e.snapshotNode),i=new pe(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Tg(t,e){return{eventCache:t,serverCache:e}}function Al(t,e,n,r){return Tg(new qr(e,n,r),t.serverCache)}function EP(t,e,n,r){return Tg(t.eventCache,new qr(e,n,r))}function ug(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function _o(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var ZE,x3=()=>(ZE||(ZE=new zn(S6)),ZE),rn=class t{constructor(e,n=x3()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return Mt(e,(r,i)=>{n=n.set(new Ie(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Ee(),value:this.value};if(ue(e))return null;{let r=ae(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Oe(e),n);return s!=null?{path:We(new Ie(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ue(e))return this;{let n=ae(e),r=this.children.get(n);return r!==null?r.subtree(Oe(e)):new t(null)}}set(e,n){if(ue(e))return new t(n,this.children);{let r=ae(e),s=(this.children.get(r)||new t(null)).set(Oe(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(ue(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ae(e),r=this.children.get(n);if(r){let i=r.remove(Oe(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(ue(e))return this.value;{let n=ae(e),r=this.children.get(n);return r?r.get(Oe(e)):null}}setTree(e,n){if(ue(e))return n;{let r=ae(e),s=(this.children.get(r)||new t(null)).setTree(Oe(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(Ee(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(We(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Ee(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(ue(e))return null;{let s=ae(e),o=this.children.get(s);return o?o.findOnPath_(Oe(e),We(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Ee(),n)}foreachOnPath_(e,n,r){if(ue(e))return this;{this.value&&r(n,this.value);let i=ae(e),s=this.children.get(i);return s?s.foreachOnPath_(Oe(e),We(n,i),r):new t(null)}}foreach(e){this.foreach_(Ee(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(We(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var fr=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new rn(null))}};function xl(t,e,n){if(ue(e))return new fr(new rn(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=nn(i,e);return s=s.updateChild(o,n),new fr(t.writeTree_.set(i,s))}else{let i=new rn(n),s=t.writeTree_.setTree(e,i);return new fr(s)}}}function RI(t,e,n){let r=t;return Mt(n,(i,s)=>{r=xl(r,We(e,i),s)}),r}function NN(t,e){if(ue(e))return fr.empty();{let n=t.writeTree_.setTree(e,new rn(null));return new fr(n)}}function MI(t,e){return vo(t,e)!=null}function vo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(nn(n.path,e)):null}function PN(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Le,(r,i)=>{e.push(new pe(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new pe(r,i.value))}),e}function cs(t,e){if(ue(e))return t;{let n=vo(t,e);return n!=null?new fr(new rn(n)):new fr(t.writeTree_.subtree(e))}}function NI(t){return t.writeTree_.isEmpty()}function ou(t,e){return IP(Ee(),t.writeTree_,e)}function IP(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(T(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=IP(We(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(We(t,".priority"),r)),n}}function bg(t,e){return bP(e,t)}function R3(t,e,n,r,i){T(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=xl(t.visibleWrites,e,n)),t.lastWriteId=r}function M3(t,e,n,r){T(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=RI(t.visibleWrites,e,n),t.lastWriteId=r}function N3(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function P3(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);T(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&k3(a,r.path)?i=!1:Gn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return O3(t),!0;if(r.snap)t.visibleWrites=NN(t.visibleWrites,r.path);else{let a=r.children;Mt(a,u=>{t.visibleWrites=NN(t.visibleWrites,We(r.path,u))})}return!0}else return!1}function k3(t,e){if(t.snap)return Gn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Gn(We(t.path,n),e))return!0;return!1}function O3(t){t.visibleWrites=CP(t.allWrites,F3,Ee()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function F3(t){return t.visible}function CP(t,e,n){let r=fr.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)Gn(n,o)?(a=nn(n,o),r=xl(r,a,s.snap)):Gn(o,n)&&(a=nn(o,n),r=xl(r,Ee(),s.snap.getChild(a)));else if(s.children){if(Gn(n,o))a=nn(n,o),r=RI(r,a,s.children);else if(Gn(o,n))if(a=nn(o,n),ue(a))r=RI(r,Ee(),s.children);else{let u=Li(s.children,ae(a));if(u){let c=u.getChild(Oe(a));r=xl(r,Ee(),c)}}}else throw ra("WriteRecord should have .snap or .children")}}return r}function DP(t,e,n,r,i){if(!r&&!i){let s=vo(t.visibleWrites,e);if(s!=null)return s;{let o=cs(t.visibleWrites,e);if(NI(o))return n;if(n==null&&!MI(o,Ee()))return null;{let a=n||ne.EMPTY_NODE;return ou(o,a)}}}else{let s=cs(t.visibleWrites,e);if(!i&&NI(s))return n;if(!i&&n==null&&!MI(s,Ee()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(Gn(c.path,e)||Gn(e,c.path))},a=CP(t.allWrites,o,e),u=n||ne.EMPTY_NODE;return ou(a,u)}}}function V3(t,e,n){let r=ne.EMPTY_NODE,i=vo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Le,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=cs(t.visibleWrites,e);return n.forEachChild(Le,(o,a)=>{let u=ou(cs(s,new Ie(o)),a);r=r.updateImmediateChild(o,u)}),PN(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=cs(t.visibleWrites,e);return PN(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function L3(t,e,n,r,i){T(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=We(e,n);if(MI(t.visibleWrites,s))return null;{let o=cs(t.visibleWrites,s);return NI(o)?i.getChild(n):ou(o,i.getChild(n))}}function j3(t,e,n,r){let i=We(e,n),s=vo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=cs(t.visibleWrites,i);return ou(o,r.getNode().getImmediateChild(n))}else return null}function U3(t,e){return vo(t.visibleWrites,e)}function B3(t,e,n,r,i,s,o){let a,u=cs(t.visibleWrites,e),c=vo(u,Ee());if(c!=null)a=c;else if(n!=null)a=ou(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function $3(){return{visibleWrites:fr.empty(),allWrites:[],lastWriteId:-1}}function cg(t,e,n,r){return DP(t.writeTree,t.treePath,e,n,r)}function mC(t,e){return V3(t.writeTree,t.treePath,e)}function kN(t,e,n,r){return L3(t.writeTree,t.treePath,e,n,r)}function lg(t,e){return U3(t.writeTree,We(t.treePath,e))}function H3(t,e,n,r,i,s){return B3(t.writeTree,t.treePath,e,n,r,i,s)}function _C(t,e,n){return j3(t.writeTree,t.treePath,e,n)}function TP(t,e){return bP(We(t.treePath,e),t.writeTree)}function bP(t,e){return{treePath:t,writeTree:e}}var PI=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;T(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),T(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Ol(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,kl(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,iu(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Ol(r,e.snapshotNode,i.oldSnap));else throw ra("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var kI=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},SP=new kI,jl=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new qr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return _C(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:_o(this.viewCache_),s=H3(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function q3(t){return{filter:t}}function G3(t,e){T(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),T(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function z3(t,e,n,r,i){let s=new PI,o,a;if(n.type===Br.OVERWRITE){let c=n;c.source.fromUser?o=OI(t,e,c.path,c.snap,r,i,s):(T(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!ue(c.path),o=dg(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===Br.MERGE){let c=n;c.source.fromUser?o=K3(t,e,c.path,c.children,r,i,s):(T(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=FI(t,e,c.path,c.children,r,i,a,s))}else if(n.type===Br.ACK_USER_WRITE){let c=n;c.revert?o=Z3(t,e,c.path,r,i,s):o=Q3(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===Br.LISTEN_COMPLETE)o=Y3(t,e,n.path,r,s);else throw ra("Unknown operation type: "+n.type);let u=s.getChanges();return W3(e,o,u),{viewCache:o,changes:u}}function W3(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=ug(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(wP(ug(e)))}}function AP(t,e,n,r,i,s){let o=e.eventCache;if(lg(r,n)!=null)return e;{let a,u;if(ue(n))if(T(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=_o(e),l=c instanceof ne?c:ne.EMPTY_NODE,d=mC(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=cg(r,_o(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=ae(n);if(c===".priority"){T(hs(n)===1,"Can't have a priority with additional path components");let l=o.getNode();u=e.serverCache.getNode();let d=kN(r,n,l,u);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Oe(n),d;if(o.isCompleteForChild(c)){u=e.serverCache.getNode();let h=kN(r,n,o.getNode(),u);h!=null?d=o.getNode().getImmediateChild(c).updateChild(l,h):d=o.getNode().getImmediateChild(c)}else d=_C(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,l,i,s):a=o.getNode()}}return Al(e,a,o.isFullyInitialized()||ue(n),t.filter.filtersNodes())}}function dg(t,e,n,r,i,s,o,a){let u=e.serverCache,c,l=o?t.filter:t.filter.getIndexedFilter();if(ue(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){let f=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),f,null)}else{let f=ae(n);if(!u.isCompleteForPath(n)&&hs(n)>1)return e;let p=Oe(n),m=u.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?c=l.updatePriority(u.getNode(),m):c=l.updateChild(u.getNode(),f,m,p,SP,null)}let d=EP(e,c,u.isFullyInitialized()||ue(n),l.filtersNodes()),h=new jl(i,d,s);return AP(t,d,n,i,h,a)}function OI(t,e,n,r,i,s,o){let a=e.eventCache,u,c,l=new jl(i,e,s);if(ue(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=Al(e,c,!0,t.filter.filtersNodes());else{let d=ae(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),u=Al(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=Oe(n),f=a.getNode().getImmediateChild(d),p;if(ue(h))p=r;else{let g=l.getCompleteChild(d);g!=null?uC(h)===".priority"&&g.getChild(pP(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=ne.EMPTY_NODE}if(f.equals(p))u=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);u=Al(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function ON(t,e){return t.eventCache.isCompleteForChild(e)}function K3(t,e,n,r,i,s,o){let a=e;return r.foreach((u,c)=>{let l=We(n,u);ON(e,ae(l))&&(a=OI(t,a,l,c,i,s,o))}),r.foreach((u,c)=>{let l=We(n,u);ON(e,ae(l))||(a=OI(t,a,l,c,i,s,o))}),a}function FN(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function FI(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,c;ue(n)?c=r:c=new rn(null).setTree(n,r);let l=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=FN(t,f,h);u=dg(t,u,new Ie(d),p,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=FN(t,p,h);u=dg(t,u,new Ie(d),g,i,s,o,a)}}),u}function Q3(t,e,n,r,i,s,o){if(lg(i,n)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(ue(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return dg(t,e,n,u.getNode().getChild(n),i,s,a,o);if(ue(n)){let c=new rn(null);return u.getNode().forEachChild($r,(l,d)=>{c=c.set(new Ie(l),d)}),FI(t,e,n,c,i,s,a,o)}else return e}else{let c=new rn(null);return r.foreach((l,d)=>{let h=We(n,l);u.isCompleteForPath(h)&&(c=c.set(l,u.getNode().getChild(h)))}),FI(t,e,n,c,i,s,a,o)}}function Y3(t,e,n,r,i){let s=e.serverCache,o=EP(e,s.getNode(),s.isFullyInitialized()||ue(n),s.isFiltered());return AP(t,o,n,r,SP,i)}function Z3(t,e,n,r,i,s){let o;if(lg(r,n)!=null)return e;{let a=new jl(r,e,i),u=e.eventCache.getNode(),c;if(ue(n)||ae(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=cg(r,_o(e));else{let d=e.serverCache.getNode();T(d instanceof ne,"serverChildren would be complete if leaf node"),l=mC(r,d)}l=l,c=t.filter.updateFullNode(u,l,s)}else{let l=ae(n),d=_C(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=u.getImmediateChild(l)),d!=null?c=t.filter.updateChild(u,l,d,Oe(n),a,s):e.eventCache.getNode().hasChild(l)?c=t.filter.updateChild(u,l,ne.EMPTY_NODE,Oe(n),a,s):c=u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=cg(r,_o(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||lg(r,Ee())!=null,Al(e,c,o,t.filter.filtersNodes())}}var VI=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Fl(r.getIndex()),s=y3(r);this.processor_=q3(s);let o=n.serverCache,a=n.eventCache,u=i.updateFullNode(ne.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(ne.EMPTY_NODE,a.getNode(),null),l=new qr(u,o.isFullyInitialized(),i.filtersNodes()),d=new qr(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Tg(d,l),this.eventGenerator_=new xI(this.query_)}get query(){return this.query_}};function X3(t){return t.viewCache_.serverCache.getNode()}function J3(t){return ug(t.viewCache_)}function e9(t,e){let n=_o(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ue(e)&&!n.getImmediateChild(ae(e)).isEmpty())?n.getChild(e):null}function VN(t){return t.eventRegistrations_.length===0}function t9(t,e){t.eventRegistrations_.push(e)}function LN(t,e,n){let r=[];if(n){T(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function jN(t,e,n,r){e.type===Br.MERGE&&e.source.queryId!==null&&(T(_o(t.viewCache_),"We should always have a full cache before handling merges"),T(ug(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=z3(t.processor_,i,e,n,r);return G3(t.processor_,s.viewCache),T(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,xP(t,s.changes,s.viewCache.eventCache.getNode(),null)}function n9(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Le,(s,o)=>{r.push(iu(s,o))}),n.isFullyInitialized()&&r.push(wP(n.getNode())),xP(t,r,n.getNode(),e)}function xP(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return b3(t.eventGenerator_,e,n,i)}var hg,fg=class{constructor(){this.views=new Map}};function r9(t){T(!hg,"__referenceConstructor has already been defined"),hg=t}function i9(){return T(hg,"Reference.ts has not been loaded"),hg}function s9(t){return t.views.size===0}function yC(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return T(s!=null,"SyncTree gave us an op for an invalid query."),jN(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(jN(o,e,n,r));return s}}function RP(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=cg(n,i?r:null),u=!1;a?u=!0:r instanceof ne?(a=mC(n,r),u=!1):(a=ne.EMPTY_NODE,u=!1);let c=Tg(new qr(a,u,!1),new qr(r,i,!1));return new VI(e,c)}return o}function o9(t,e,n,r,i,s){let o=RP(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),t9(o,n),n9(o,n)}function a9(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=fs(t);if(i==="default")for(let[u,c]of t.views.entries())o=o.concat(LN(c,n,r)),VN(c)&&(t.views.delete(u),c.query._queryParams.loadsAllData()||s.push(c.query));else{let u=t.views.get(i);u&&(o=o.concat(LN(u,n,r)),VN(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!fs(t)&&s.push(new(i9())(e._repo,e._path)),{removed:s,events:o}}function MP(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ls(t,e){let n=null;for(let r of t.views.values())n=n||e9(r,e);return n}function NP(t,e){if(e._queryParams.loadsAllData())return Sg(t);{let r=e._queryIdentifier;return t.views.get(r)}}function PP(t,e){return NP(t,e)!=null}function fs(t){return Sg(t)!=null}function Sg(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var pg;function u9(t){T(!pg,"__referenceConstructor has already been defined"),pg=t}function c9(){return T(pg,"Reference.ts has not been loaded"),pg}var l9=1,gg=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new rn(null),this.pendingWriteTree_=$3(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function vC(t,e,n,r,i){return R3(t.pendingWriteTree_,e,n,r,i),i?du(t,new su(fC(),e,n)):[]}function d9(t,e,n,r){M3(t.pendingWriteTree_,e,n,r);let i=rn.fromObject(n);return du(t,new Ll(fC(),e,i))}function us(t,e,n=!1){let r=N3(t.pendingWriteTree_,e);if(P3(t.pendingWriteTree_,e)){let s=new rn(null);return r.snap!=null?s=s.set(Ee(),!0):Mt(r.children,o=>{s=s.set(new Ie(o),!0)}),du(t,new AI(r.path,s,n))}else return[]}function Kl(t,e,n){return du(t,new su(pC(),e,n))}function h9(t,e,n){let r=rn.fromObject(n);return du(t,new Ll(pC(),e,r))}function f9(t,e){return du(t,new ag(pC(),e))}function p9(t,e,n){let r=wC(t,n);if(r){let i=EC(r),s=i.path,o=i.queryId,a=nn(s,e),u=new ag(gC(o),a);return IC(t,s,u)}else return[]}function mg(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||PP(o,e))){let u=a9(o,e,n,r);s9(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=u.removed;if(a=u.events,!i){let l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>fs(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=_9(h);for(let p=0;p<f.length;++p){let g=f[p],m=g.query,I=VP(t,g);t.listenProvider_.startListening(Rl(m),Ul(t,m),I.hashFn,I.onComplete)}}}!d&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(Rl(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(xg(h));t.listenProvider_.stopListening(Rl(h),f)}))}y9(t,c)}return a}function kP(t,e,n,r){let i=wC(t,r);if(i!=null){let s=EC(i),o=s.path,a=s.queryId,u=nn(o,e),c=new su(gC(a),u,n);return IC(t,o,c)}else return[]}function g9(t,e,n,r){let i=wC(t,r);if(i){let s=EC(i),o=s.path,a=s.queryId,u=nn(o,e),c=rn.fromObject(n),l=new Ll(gC(a),u,c);return IC(t,o,l)}else return[]}function LI(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=nn(h,i);s=s||ls(f,p),o=o||fs(f)});let a=t.syncPointTree_.get(i);a?(o=o||fs(a),s=s||ls(a,Ee())):(a=new fg,t.syncPointTree_=t.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=ne.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=ls(p,Ee());g&&(s=s.updateImmediateChild(f,g))}));let c=PP(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=xg(e);T(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=v9();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=bg(t.pendingWriteTree_,i),d=o9(a,e,n,l,s,u);if(!c&&!o&&!r){let h=NP(a,e);d=d.concat(w9(t,e,h))}return d}function Ag(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let u=nn(o,e),c=ls(a,u);if(c)return c});return DP(i,e,s,n,!0)}function m9(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,l)=>{let d=nn(c,n);r=r||ls(l,d)});let i=t.syncPointTree_.get(n);i?r=r||ls(i,Ee()):(i=new fg,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new qr(r,!0,!1):null,a=bg(t.pendingWriteTree_,e._path),u=RP(i,e,a,s?o.getNode():ne.EMPTY_NODE,s);return J3(u)}function du(t,e){return OP(e,t.syncPointTree_,null,bg(t.pendingWriteTree_,Ee()))}function OP(t,e,n,r){if(ue(t.path))return FP(t,e,n,r);{let i=e.get(Ee());n==null&&i!=null&&(n=ls(i,Ee()));let s=[],o=ae(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){let c=n?n.getImmediateChild(o):null,l=TP(r,o);s=s.concat(OP(a,u,c,l))}return i&&(s=s.concat(yC(i,t,r,n))),s}}function FP(t,e,n,r){let i=e.get(Ee());n==null&&i!=null&&(n=ls(i,Ee()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=n?n.getImmediateChild(o):null,c=TP(r,o),l=t.operationForChild(o);l&&(s=s.concat(FP(l,a,u,c)))}),i&&(s=s.concat(yC(i,t,r,n))),s}function VP(t,e){let n=e.query,r=Ul(t,n);return{hashFn:()=>(X3(e)||ne.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?p9(t,n._path,r):f9(t,n._path);{let s=R6(i,n);return mg(t,n,null,s)}}}}function Ul(t,e){let n=xg(e);return t.queryToTagMap.get(n)}function xg(t){return t._path.toString()+"$"+t._queryIdentifier}function wC(t,e){return t.tagToQueryMap.get(e)}function EC(t){let e=t.indexOf("$");return T(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ie(t.substr(0,e))}}function IC(t,e,n){let r=t.syncPointTree_.get(e);T(r,"Missing sync point for query tag that we're tracking");let i=bg(t.pendingWriteTree_,e);return yC(r,n,i,null)}function _9(t){return t.fold((e,n,r)=>{if(n&&fs(n))return[Sg(n)];{let i=[];return n&&(i=MP(n)),Mt(r,(s,o)=>{i=i.concat(o)}),i}})}function Rl(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(c9())(t._repo,t._path):t}function y9(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=xg(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function v9(){return l9++}function w9(t,e,n){let r=e._path,i=Ul(t,e),s=VP(t,n),o=t.listenProvider_.startListening(Rl(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)T(!fs(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((c,l,d)=>{if(!ue(c)&&l&&fs(l))return[Sg(l).query];{let h=[];return l&&(h=h.concat(MP(l).map(f=>f.query))),Mt(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<u.length;++c){let l=u[c];t.listenProvider_.stopListening(Rl(l),Ul(t,l))}}return o}var jI=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},UI=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=We(this.path_,e);return new t(this.syncTree_,n)}node(){return Ag(this.syncTree_,this.path_)}},E9=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},UN=function(t,e,n){if(!t||typeof t!="object")return t;if(T(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return I9(t[".sv"],e,n);if(typeof t[".sv"]=="object")return C9(t[".sv"],e);T(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},I9=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:T(!1,"Unexpected server value: "+t)}},C9=function(t,e,n){t.hasOwnProperty("increment")||T(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&T(!1,"Unexpected increment value: "+r);let i=e.node();if(T(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},LP=function(t,e,n,r){return DC(e,new UI(n,t),r)},CC=function(t,e,n){return DC(t,new jI(e),n)};function DC(t,e,n){let r=t.getPriority().val(),i=UN(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=UN(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new nu(a,Ye(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new nu(i))),o.forEachChild(Le,(a,u)=>{let c=DC(u,e.getImmediateChild(a),n);c!==u&&(s=s.updateImmediateChild(a,c))}),s}}var Bl=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Rg(t,e){let n=e instanceof Ie?e:new Ie(e),r=t,i=ae(n);for(;i!==null;){let s=Li(r.node.children,i)||{children:{},childCount:0};r=new Bl(i,r,s),n=Oe(n),i=ae(n)}return r}function wo(t){return t.node.value}function TC(t,e){t.node.value=e,BI(t)}function jP(t){return t.node.childCount>0}function D9(t){return wo(t)===void 0&&!jP(t)}function Mg(t,e){Mt(t.node.children,(n,r)=>{e(new Bl(n,t,r))})}function UP(t,e,n,r){n&&!r&&e(t),Mg(t,i=>{UP(i,e,!0,r)}),n&&r&&e(t)}function T9(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Ql(t){return new Ie(t.parent===null?t.name:Ql(t.parent)+"/"+t.name)}function BI(t){t.parent!==null&&b9(t.parent,t.name,t)}function b9(t,e,n){let r=D9(n),i=On(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,BI(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,BI(t))}var S9=/[\[\].#$\/\u0000-\u001F\u007F]/,A9=/[\[\].#$\u0000-\u001F\u007F]/,XE=10*1024*1024,Ng=function(t){return typeof t=="string"&&t.length!==0&&!S9.test(t)},BP=function(t){return typeof t=="string"&&t.length!==0&&!A9.test(t)},x9=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),BP(t)},$l=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Cg(t)||t&&typeof t=="object"&&On(t,".sv")},Gr=function(t,e,n,r){r&&e===void 0||Yl(dn(t,"value"),e,n)},Yl=function(t,e,n){let r=n instanceof Ie?new dI(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+po(r));if(typeof e=="function")throw new Error(t+"contains a function "+po(r)+" with contents = "+e.toString());if(Cg(e))throw new Error(t+"contains "+e.toString()+" "+po(r));if(typeof e=="string"&&e.length>XE/3&&yc(e)>XE)throw new Error(t+"contains a string greater than "+XE+" utf8 bytes "+po(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Mt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Ng(o)))throw new Error(t+" contains an invalid key ("+o+") "+po(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);s3(r,o),Yl(t,a,r),o3(r)}),i&&s)throw new Error(t+' contains ".value" child '+po(r)+" in addition to actual children.")}},R9=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=Nl(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Ng(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(i3);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&Gn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},$P=function(t,e,n,r){if(r&&e===void 0)return;let i=dn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Mt(e,(o,a)=>{let u=new Ie(o);if(Yl(i,a,We(n,u)),uC(u)===".priority"&&!$l(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),R9(i,s)},bC=function(t,e,n){if(!(n&&e===void 0)){if(Cg(e))throw new Error(dn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!$l(e))throw new Error(dn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Zl=function(t,e,n,r){if(!(r&&n===void 0)&&!Ng(n))throw new Error(dn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},hu=function(t,e,n,r){if(!(r&&n===void 0)&&!BP(n))throw new Error(dn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},M9=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),hu(t,e,n,r)},Sn=function(t,e){if(ae(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},HP=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ng(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!x9(n))throw new Error(dn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var $I=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Pg(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!cC(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function qP(t,e,n){Pg(t,n),GP(t,r=>cC(r,e))}function An(t,e,n){Pg(t,n),GP(t,r=>Gn(r,e)||Gn(e,r))}function GP(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(N9(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function N9(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();mo&&Rt("event: "+n.toString()),cu(r)}}}var zP="repo_interrupt",P9=25,HI=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new $I,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=og(),this.transactionQueueTree_=new Bl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function k9(t,e,n){if(t.stats_=aC(t.repoInfo_),t.forceRestClient_||k6())t.server_=new II(t.repoInfo_,(r,i,s,o)=>{BN(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>$N(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{lt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new lC(t.repoInfo_,e,(r,i,s,o)=>{BN(t,r,i,s,o)},r=>{$N(t,r)},r=>{O9(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=F6(t.repoInfo_,()=>new SI(t.stats_,t.server_)),t.infoData_=new CI,t.infoSyncTree_=new gg({startListening:(r,i,s,o)=>{let a=[],u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=Kl(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),SC(t,"connected",!1),t.serverSyncTree_=new gg({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{let c=o(a,u);An(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function WP(t){let n=t.infoData_.getNode(new Ie(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Xl(t){return E9({timestamp:WP(t)})}function BN(t,e,n,r,i){t.dataUpdateCount++;let s=new Ie(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let u=_c(n,c=>Ye(c));o=g9(t.serverSyncTree_,s,u,i)}else{let u=Ye(n);o=kP(t.serverSyncTree_,s,u,i)}else if(r){let u=_c(n,c=>Ye(c));o=h9(t.serverSyncTree_,s,u)}else{let u=Ye(n);o=Kl(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=au(t,s)),An(t.eventQueue_,a,o)}function $N(t,e){SC(t,"connected",e),e===!1&&L9(t)}function O9(t,e){Mt(e,(n,r)=>{SC(t,n,r)})}function SC(t,e,n){let r=new Ie("/.info/"+e),i=Ye(n);t.infoData_.updateSnapshot(r,i);let s=Kl(t.infoSyncTree_,r,i);An(t.eventQueue_,r,s)}function kg(t){return t.nextWriteId_++}function F9(t,e,n){let r=m9(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Ye(i).withIndex(e._queryParams.getIndex());LI(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Kl(t.serverSyncTree_,e._path,s);else{let a=Ul(t.serverSyncTree_,e);o=kP(t.serverSyncTree_,e._path,s,a)}return An(t.eventQueue_,e._path,o),mg(t.serverSyncTree_,e,n,null,!0),s},i=>(fu(t,"get for query "+lt(e)+" failed: "+i),Promise.reject(new Error(i))))}function AC(t,e,n,r,i){fu(t,"set",{path:e.toString(),value:n,priority:r});let s=Xl(t),o=Ye(n,r),a=Ag(t.serverSyncTree_,e),u=CC(o,a,s),c=kg(t),l=vC(t.serverSyncTree_,e,u,c,!0);Pg(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||Wt("set at "+e+" failed: "+h);let g=us(t.serverSyncTree_,c,!p);An(t.eventQueue_,e,g),ps(t,i,h,f)});let d=RC(t,e);au(t,d),An(t.eventQueue_,d,[])}function V9(t,e,n,r){fu(t,"update",{path:e.toString(),value:n});let i=!0,s=Xl(t),o={};if(Mt(n,(a,u)=>{i=!1,o[a]=LP(We(e,a),Ye(u),t.serverSyncTree_,s)}),i)Rt("update() called with empty data.  Don't do anything."),ps(t,r,"ok",void 0);else{let a=kg(t),u=d9(t.serverSyncTree_,e,o,a);Pg(t.eventQueue_,u),t.server_.merge(e.toString(),n,(c,l)=>{let d=c==="ok";d||Wt("update at "+e+" failed: "+c);let h=us(t.serverSyncTree_,a,!d),f=h.length>0?au(t,e):e;An(t.eventQueue_,f,h),ps(t,r,c,l)}),Mt(n,c=>{let l=RC(t,We(e,c));au(t,l)}),An(t.eventQueue_,e,[])}}function L9(t){fu(t,"onDisconnectEvents");let e=Xl(t),n=og();TI(t.onDisconnect_,Ee(),(i,s)=>{let o=LP(i,s,t.serverSyncTree_,e);lu(n,i,o)});let r=[];TI(n,Ee(),(i,s)=>{r=r.concat(Kl(t.serverSyncTree_,i,s));let o=RC(t,i);au(t,o)}),t.onDisconnect_=og(),An(t.eventQueue_,Ee(),r)}function j9(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&DI(t.onDisconnect_,e),ps(t,n,r,i)})}function HN(t,e,n,r){let i=Ye(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&lu(t.onDisconnect_,e,i),ps(t,r,s,o)})}function U9(t,e,n,r,i){let s=Ye(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&lu(t.onDisconnect_,e,s),ps(t,i,o,a)})}function B9(t,e,n,r){if(Ah(n)){Rt("onDisconnect().update() called with empty data.  Don't do anything."),ps(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&Mt(n,(o,a)=>{let u=Ye(a);lu(t.onDisconnect_,We(e,o),u)}),ps(t,r,i,s)})}function $9(t,e,n){let r;ae(e._path)===".info"?r=LI(t.infoSyncTree_,e,n):r=LI(t.serverSyncTree_,e,n),qP(t.eventQueue_,e._path,r)}function qI(t,e,n){let r;ae(e._path)===".info"?r=mg(t.infoSyncTree_,e,n):r=mg(t.serverSyncTree_,e,n),qP(t.eventQueue_,e._path,r)}function KP(t){t.persistentConnection_&&t.persistentConnection_.interrupt(zP)}function H9(t){t.persistentConnection_&&t.persistentConnection_.resume(zP)}function fu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Rt(n,...e)}function ps(t,e,n,r){e&&cu(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function q9(t,e,n,r,i,s){fu(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:WN(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=xC(t,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Yl("transaction failed: Data returned ",u,o.path),o.status=0;let c=Rg(t.transactionQueueTree_,e),l=wo(c)||[];l.push(o),TC(c,l);let d;typeof u=="object"&&u!==null&&On(u,".priority")?(d=Li(u,".priority"),T($l(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(Ag(t.serverSyncTree_,e)||ne.EMPTY_NODE).getPriority().val();let h=Xl(t),f=Ye(u,d),p=CC(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=kg(t);let g=vC(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);An(t.eventQueue_,e,g),Og(t,t.transactionQueueTree_)}}function xC(t,e,n){return Ag(t.serverSyncTree_,e,n)||ne.EMPTY_NODE}function Og(t,e=t.transactionQueueTree_){if(e||Fg(t,e),wo(e)){let n=YP(t,e);T(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&G9(t,Ql(e),n)}else jP(e)&&Mg(e,n=>{Og(t,n)})}function G9(t,e,n){let r=n.map(c=>c.currentWriteId),i=xC(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let l=n[c];T(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=nn(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;t.server_.put(u.toString(),a,c=>{fu(t,"transaction put response",{path:u.toString(),status:c});let l=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(us(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Fg(t,Rg(t.transactionQueueTree_,e)),Og(t,t.transactionQueueTree_),An(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)cu(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Wt("transaction at "+u.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}au(t,e)}},o)}function au(t,e){let n=QP(t,e),r=Ql(n),i=YP(t,n);return z9(t,i,r),r}function z9(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],c=nn(n,u.path),l=!1,d;if(T(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)l=!0,d=u.abortReason,i=i.concat(us(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=P9)l=!0,d="maxretry",i=i.concat(us(t.serverSyncTree_,u.currentWriteId,!0));else{let h=xC(t,u.path,o);u.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Yl("transaction failed: Data returned ",f,u.path);let p=Ye(f);typeof f=="object"&&f!=null&&On(f,".priority")||(p=p.updatePriority(h.getPriority()));let m=u.currentWriteId,I=Xl(t),A=CC(p,h,I);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=A,u.currentWriteId=kg(t),o.splice(o.indexOf(m),1),i=i.concat(vC(t.serverSyncTree_,u.path,A,u.currentWriteId,u.applyLocally)),i=i.concat(us(t.serverSyncTree_,m,!0))}else l=!0,d="nodata",i=i.concat(us(t.serverSyncTree_,u.currentWriteId,!0))}An(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Fg(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)cu(r[a]);Og(t,t.transactionQueueTree_)}function QP(t,e){let n,r=t.transactionQueueTree_;for(n=ae(e);n!==null&&wo(r)===void 0;)r=Rg(r,n),e=Oe(e),n=ae(e);return r}function YP(t,e){let n=[];return ZP(t,e,n),n.sort((r,i)=>r.order-i.order),n}function ZP(t,e,n){let r=wo(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Mg(e,i=>{ZP(t,i,n)})}function Fg(t,e){let n=wo(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,TC(e,n.length>0?n:void 0)}Mg(e,r=>{Fg(t,r)})}function RC(t,e){let n=Ql(QP(t,e)),r=Rg(t.transactionQueueTree_,e);return T9(r,i=>{JE(t,i)}),JE(t,r),UP(r,i=>{JE(t,i)}),n}function JE(t,e){let n=wo(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(T(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(T(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(us(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?TC(e,void 0):n.length=s+1,An(t.eventQueue_,Ql(e),i);for(let o=0;o<r.length;o++)cu(r[o])}}function W9(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function K9(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Wt(`Invalid query segment '${n}' in query '${t}'`)}return e}var GI=function(t,e){let n=Q9(t),r=n.namespace;n.domain==="firebase.com"&&Hr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Hr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||T6();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Xp(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Ie(n.pathString)}},Q9=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=W9(t.substring(l,d)));let h=K9(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var qN="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Y9=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=qN.charAt(n%64),n=Math.floor(n/64);T(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=qN.charAt(e[i]);return T(o.length===20,"nextPushId: Length should be 20."),o}}();var _g=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+lt(this.snapshot.exportVal())}},yg=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Hl=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return T(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var vg=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new Tt;return j9(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Sn("OnDisconnect.remove",this._path);let e=new Tt;return HN(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Sn("OnDisconnect.set",this._path),Gr("OnDisconnect.set",e,this._path,!1);let n=new Tt;return HN(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Sn("OnDisconnect.setWithPriority",this._path),Gr("OnDisconnect.setWithPriority",e,this._path,!1),bC("OnDisconnect.setWithPriority",n,!1);let r=new Tt;return U9(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){Sn("OnDisconnect.update",this._path),$P("OnDisconnect.update",e,this._path,!1);let n=new Tt;return B9(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var sn=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ue(this._path)?null:uC(this._path)}get ref(){return new xn(this._repo,this._path)}get _queryIdentifier(){let e=RN(this._queryParams),n=oC(e);return n==="{}"?"default":n}get _queryObject(){return RN(this._queryParams)}isEqual(e){if(e=Z(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=cC(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+r3(this._path)}};function Vg(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ms(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===$r){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ds)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Ti)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Le){if(e!=null&&!$l(e)||n!=null&&!$l(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(T(t.getIndex()instanceof Pl||t.getIndex()===hC,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Lg(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var xn=class t extends sn{constructor(e,n){super(e,n,new Vl,!1)}get parent(){let e=pP(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},uu=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new Ie(e),r=gs(this.ref,e);return new t(this._node.getChild(n),r,Le)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,gs(this.ref,r),Le)))}hasChild(e){let n=new Ie(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function MC(t,e){return t=Z(t),t._checkNotDeleted("ref"),e!==void 0?gs(t._root,e):t._root}function NC(t,e){t=Z(t),t._checkNotDeleted("refFromURL");let n=GI(e,t._repo.repoInfo_.nodeAdmin);HP("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Hr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),MC(t,n.path.toString())}function gs(t,e){return t=Z(t),ae(t._path)===null?M9("child","path",e,!1):hu("child","path",e,!1),new xn(t._repo,We(t._path,e))}function XP(t,e){t=Z(t),Sn("push",t._path),Gr("push",e,t._path,!0);let n=WP(t._repo),r=Y9(n),i=gs(t,r),s=gs(t,r),o;return e!=null?o=jg(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function JP(t){return Sn("remove",t._path),jg(t,null)}function jg(t,e){t=Z(t),Sn("set",t._path),Gr("set",e,t._path,!1);let n=new Tt;return AC(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function ek(t,e){t=Z(t),Sn("setPriority",t._path),bC("setPriority",e,!1);let n=new Tt;return AC(t._repo,We(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function tk(t,e,n){if(Sn("setWithPriority",t._path),Gr("setWithPriority",e,t._path,!1),bC("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new Tt;return AC(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function nk(t,e){$P("update",e,t._path,!1);let n=new Tt;return V9(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function rk(t){t=Z(t);let e=new Hl(()=>{}),n=new ql(e);return F9(t._repo,t,n).then(r=>new uu(r,new xn(t._repo,t._path),t._queryParams.getIndex()))}var ql=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new _g("value",this,new uu(e.snapshotNode,new xn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new yg(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},wg=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new yg(this,e,n):null}createEvent(e,n){T(e.childName!=null,"Child events should have a childName.");let r=gs(new xn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new _g(e.type,this,new uu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Jl(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=n,c=(l,d)=>{qI(t._repo,t,a),u(l,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new Hl(n,s||void 0),a=e==="value"?new ql(o):new wg(e,o);return $9(t._repo,t,a),()=>qI(t._repo,t,a)}function Ug(t,e,n,r){return Jl(t,"value",e,n,r)}function PC(t,e,n,r){return Jl(t,"child_added",e,n,r)}function kC(t,e,n,r){return Jl(t,"child_changed",e,n,r)}function OC(t,e,n,r){return Jl(t,"child_moved",e,n,r)}function FC(t,e,n,r){return Jl(t,"child_removed",e,n,r)}function VC(t,e,n){let r=null,i=n?new Hl(n):null;e==="value"?r=new ql(i):e&&(r=new wg(e,i)),qI(t._repo,t,r)}var Rn=class{},Eg=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Gr("endAt",this._value,e._path,!0);let n=EI(e._queryParams,this._value,this._key);if(Lg(n),ms(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new sn(e._repo,e._path,n,e._orderByCalled)}};function ik(t,e){return Zl("endAt","key",e,!0),new Eg(t,e)}var zI=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Gr("endBefore",this._value,e._path,!1);let n=I3(e._queryParams,this._value,this._key);if(Lg(n),ms(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new sn(e._repo,e._path,n,e._orderByCalled)}};function sk(t,e){return Zl("endBefore","key",e,!0),new zI(t,e)}var Ig=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Gr("startAt",this._value,e._path,!0);let n=wI(e._queryParams,this._value,this._key);if(Lg(n),ms(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new sn(e._repo,e._path,n,e._orderByCalled)}};function ok(t=null,e){return Zl("startAt","key",e,!0),new Ig(t,e)}var WI=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Gr("startAfter",this._value,e._path,!1);let n=E3(e._queryParams,this._value,this._key);if(Lg(n),ms(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new sn(e._repo,e._path,n,e._orderByCalled)}};function ak(t,e){return Zl("startAfter","key",e,!0),new WI(t,e)}var KI=class extends Rn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new sn(e._repo,e._path,v3(e._queryParams,this._limit),e._orderByCalled)}};function uk(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new KI(t)}var QI=class extends Rn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new sn(e._repo,e._path,w3(e._queryParams,this._limit),e._orderByCalled)}};function ck(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new QI(t)}var YI=class extends Rn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Vg(e,"orderByChild");let n=new Ie(this._path);if(ue(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Pl(n),i=Dg(e._queryParams,r);return ms(i),new sn(e._repo,e._path,i,!0)}};function lk(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return hu("orderByChild","path",t,!1),new YI(t)}var ZI=class extends Rn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Vg(e,"orderByKey");let n=Dg(e._queryParams,$r);return ms(n),new sn(e._repo,e._path,n,!0)}};function dk(){return new ZI}var XI=class extends Rn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Vg(e,"orderByPriority");let n=Dg(e._queryParams,Le);return ms(n),new sn(e._repo,e._path,n,!0)}};function hk(){return new XI}var JI=class extends Rn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Vg(e,"orderByValue");let n=Dg(e._queryParams,hC);return ms(n),new sn(e._repo,e._path,n,!0)}};function fk(){return new JI}var eC=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Gr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Eg(this._value,this._key)._apply(new Ig(this._value,this._key)._apply(e))}};function pk(t,e){return Zl("equalTo","key",e,!0),new eC(t,e)}function Wn(t,...e){let n=Z(t);for(let r of e)n=r._apply(n);return n}r9(xn);u9(xn);var Z9="FIREBASE_DATABASE_EMULATOR_HOST",tC={},X9=!1;function J9(t,e,n,r){t.repoInfo_=new Xp(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function LC(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Hr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=GI(s,i),a=o.repoInfo,u,c;typeof process<"u"&&process.env&&(c=process.env[Z9]),c?(u=!0,s=`http://${c}?ns=${a.namespace}`,o=GI(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let l=i&&u?new Sl(Sl.OWNER):new sI(t.name,t.options,e);HP("Invalid Firebase Database URL",o),ue(o.path)||Hr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=t5(a,t,l,new iI(t.name,n));return new nC(d,t)}function e5(t,e){let n=tC[e];(!n||n[t.key]!==t)&&Hr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),KP(t),delete n[t.key]}function t5(t,e,n,r){let i=tC[e.name];i||(i={},tC[e.name]=i);let s=i[t.toURLString()];return s&&Hr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new HI(t,X9,n,r),i[t.toURLString()]=s,s}var nC=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(k9(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new xn(this._repo,Ee())),this._rootInternal}_delete(){return this._rootInternal!==null&&(e5(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Hr("Cannot call "+e+" on a deleted database.")}};function gk(){fP.IS_TRANSPORT_INITIALIZED&&Wt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function mk(){gk(),Ml.forceDisallow()}function _k(){gk(),Xa.forceDisallow(),Ml.forceAllow()}function yk(t,e,n,r={}){t=Z(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Hr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Hr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Sl(Sl.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:ia(r.mockUserToken,t.app.options.projectId);s=new Sl(o)}J9(i,e,n,s)}function vk(t){t=Z(t),t._checkNotDeleted("goOffline"),KP(t._repo)}function wk(t){t=Z(t),t._checkNotDeleted("goOnline"),H9(t._repo)}function Ek(t,e){QN(t,e)}function n5(t){sC(sa),ai(new Ft("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return LC(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),hn(fN,pN,t),hn(fN,pN,"esm2017")}var r5={".sv":"timestamp"};function Ik(){return r5}function Ck(t){return{".sv":{increment:t}}}var rC=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function Dk(t,e,n){var r;if(t=Z(t),Sn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new Tt,o=(u,c,l)=>{let d=null;u?s.reject(u):(d=new uu(l,new xn(t._repo,t._path),Le),s.resolve(new rC(c,d)))},a=Ug(t,()=>{});return q9(t._repo,t._path,e,o,a,i),s.promise}lC.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};lC.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};n5();var i5="@firebase/database-compat",s5="1.0.3";var o5=new ji("@firebase/database-compat"),Tk=function(t){let e="FIREBASE WARNING: "+t;o5.warn(e)};var a5=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(dn(t,e)+"must be a boolean.")},u5=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(dn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var jC=class{constructor(e){this._delegate=e}cancel(e){z("OnDisconnect.cancel",0,1,arguments.length),vt("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){z("OnDisconnect.remove",0,1,arguments.length),vt("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){z("OnDisconnect.set",1,2,arguments.length),vt("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){z("OnDisconnect.setWithPriority",2,3,arguments.length),vt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(z("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Tk("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}vt("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var UC=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return z("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Eo=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return z("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return z("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return z("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return z("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return z("DataSnapshot.child",0,1,arguments.length),e=String(e),hu("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return z("DataSnapshot.hasChild",1,1,arguments.length),hu("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return z("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return z("DataSnapshot.forEach",1,1,arguments.length),vt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return z("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return z("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return z("DataSnapshot.ref",0,0,arguments.length),new bi(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Bg=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;z("Query.on",2,4,arguments.length),vt("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,l)=>{n.call(o.context,new Eo(this.database,c),l)};a.userCallback=n,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Ug(this._delegate,a,u),n;case"child_added":return PC(this._delegate,a,u),n;case"child_removed":return FC(this._delegate,a,u),n;case"child_changed":return kC(this._delegate,a,u),n;case"child_moved":return OC(this._delegate,a,u),n;default:throw new Error(dn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(z("Query.off",0,3,arguments.length),u5("Query.off",e,!0),vt("Query.off","callback",n,!0),oy("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,VC(this._delegate,e,i)}else VC(this._delegate,e)}get(){return rk(this._delegate).then(e=>new Eo(this.database,e))}once(e,n,r,i){z("Query.once",1,4,arguments.length),vt("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new Tt,a=(c,l)=>{let d=new Eo(this.database,c);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let u=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":Ug(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":PC(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":FC(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":kC(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":OC(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(dn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return z("Query.limitToFirst",1,1,arguments.length),new t(this.database,Wn(this._delegate,uk(e)))}limitToLast(e){return z("Query.limitToLast",1,1,arguments.length),new t(this.database,Wn(this._delegate,ck(e)))}orderByChild(e){return z("Query.orderByChild",1,1,arguments.length),new t(this.database,Wn(this._delegate,lk(e)))}orderByKey(){return z("Query.orderByKey",0,0,arguments.length),new t(this.database,Wn(this._delegate,dk()))}orderByPriority(){return z("Query.orderByPriority",0,0,arguments.length),new t(this.database,Wn(this._delegate,hk()))}orderByValue(){return z("Query.orderByValue",0,0,arguments.length),new t(this.database,Wn(this._delegate,fk()))}startAt(e=null,n){return z("Query.startAt",0,2,arguments.length),new t(this.database,Wn(this._delegate,ok(e,n)))}startAfter(e=null,n){return z("Query.startAfter",0,2,arguments.length),new t(this.database,Wn(this._delegate,ak(e,n)))}endAt(e=null,n){return z("Query.endAt",0,2,arguments.length),new t(this.database,Wn(this._delegate,ik(e,n)))}endBefore(e=null,n){return z("Query.endBefore",0,2,arguments.length),new t(this.database,Wn(this._delegate,sk(e,n)))}equalTo(e,n){return z("Query.equalTo",1,2,arguments.length),new t(this.database,Wn(this._delegate,pk(e,n)))}toString(){return z("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return z("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(z("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,vt(e,"cancel",i.cancel,!0),i.context=r,oy(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(dn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new bi(this.database,new xn(this._delegate._repo,this._delegate._path))}},bi=class t extends Bg{constructor(e,n){super(e,new sn(n._repo,n._path,new Vl,!1)),this.database=e,this._delegate=n}getKey(){return z("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return z("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,gs(this._delegate,e))}getParent(){z("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return z("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){z("Reference.set",1,2,arguments.length),vt("Reference.set","onComplete",n,!0);let r=jg(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(z("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,Tk("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Sn("Reference.update",this._delegate._path),vt("Reference.update","onComplete",n,!0);let r=nk(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){z("Reference.setWithPriority",2,3,arguments.length),vt("Reference.setWithPriority","onComplete",r,!0);let i=tk(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){z("Reference.remove",0,1,arguments.length),vt("Reference.remove","onComplete",e,!0);let n=JP(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){z("Reference.transaction",1,3,arguments.length),vt("Reference.transaction","transactionUpdate",e,!1),vt("Reference.transaction","onComplete",n,!0),a5("Reference.transaction","applyLocally",r,!0);let i=Dk(this._delegate,e,{applyLocally:r}).then(s=>new UC(s.committed,new Eo(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){z("Reference.setPriority",1,2,arguments.length),vt("Reference.setPriority","onComplete",n,!0);let r=ek(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){z("Reference.push",0,2,arguments.length),vt("Reference.push","onComplete",n,!0);let r=XP(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Sn("Reference.onDisconnect",this._delegate._path),new jC(new vg(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Io=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:mk,forceLongPolling:_k}}useEmulator(e,n,r={}){yk(this._delegate,e,n,r)}ref(e){if(z("database.ref",0,1,arguments.length),e instanceof bi){let n=NC(this._delegate,e.toString());return new bi(this,n)}else{let n=MC(this._delegate,e);return new bi(this,n)}}refFromURL(e){z("database.refFromURL",1,1,arguments.length);let r=NC(this._delegate,e);return new bi(this,r)}goOffline(){return z("database.goOffline",0,0,arguments.length),vk(this._delegate)}goOnline(){return z("database.goOnline",0,0,arguments.length),wk(this._delegate)}};Io.ServerValue={TIMESTAMP:Ik(),increment:t=>Ck(t)};function c5({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){sC(n);let a=new ay("database-standalone"),u=new xh("auth-internal",a);u.setComponent(new Ft("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new xh("app-check-internal",a),c.setComponent(new Ft("app-check-internal",()=>i,"PRIVATE"))),{instance:new Io(LC(t,u,c,e,o),t),namespace:s}}var l5=Object.freeze({__proto__:null,initStandalone:c5});var d5=Io.ServerValue;function h5(t){t.INTERNAL.registerComponent(new Ft("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Io(i,r)},"PUBLIC").setServiceProps({Reference:bi,Query:Bg,Database:Io,DataSnapshot:Eo,enableLogging:Ek,INTERNAL:l5,ServerValue:d5}).setMultipleInstances(!0)),t.registerVersion(i5,s5)}h5(Je);function ed(t,e,n="on",r=ci){return new se(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(U(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Tc())}function f5(t){return typeof t=="string"}function p5(t){return typeof t.exportVal=="function"}function Rk(t){return t==null}function Mk(t){return typeof t.set=="function"}function bk(t,e){return Mk(e)?e:t.ref(e)}function Nk(t,e){if(f5(t))return e.stringCase();if(Mk(t))return e.firebaseCase();if(p5(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function Pk(t){return(Rk(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function kk(t,e,n){e=Pk(e);let r=e.map(i=>ed(t,i,"on",n));return ya(...r)}function g5(t,e,n){let r=kk(t,e).pipe(Cr((i,s)=>[...i,s],[]));return _5(t,r,n)}function m5(t,e){return ed(t,"value","on",e).pipe(U(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function _5(t,e,n){return m5(t,n).pipe(My(e),U(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),xy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),U(i=>i.actions))}function Sk(t,e){return function(r,i){return Nk(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function y5(t){return function(n){return n?Nk(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function v5(t,e,n){return ed(t,"value","once",n).pipe(Ne(r=>{let i=[B(r)];return e.forEach(s=>i.push(ed(t,s,"on",n))),ya(...i).pipe(Cr(E5,[]))}),Ic())}function Ok(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function w5(t,e){if(Rk(e))return 0;{let n=Ok(t,e);return n===-1?t.length:n+1}}function E5(t,e){let{payload:n,prevKey:r,key:i}=e,s=Ok(t,i),o=w5(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let c={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function Ak(t,e,n){return e=Pk(e),v5(t,e,n)}function I5(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:Sk(r,"update"),set:Sk(r,"set"),push:i=>r.push(i),remove:y5(r),snapshotChanges(i){return Ak(t,i,n).pipe(ze)},stateChanges(i){return kk(t,i,n).pipe(ze)},auditTrail(i){return g5(t,i,n).pipe(ze)},valueChanges(i,s){return Ak(t,i,n).pipe(U(a=>a.map(u=>s&&s.idField?Ce(N({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),ze)}}}function xk(t,e){return function(){return ed(t,"value","on",e)}}function C5(t,e){return{query:t,snapshotChanges(){return xk(t,e.schedulers.outsideAngular)().pipe(ze)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return xk(t,e.schedulers.outsideAngular)().pipe(ze,U(r=>r.payload.exists()?r.payload.val():null))}}}var D5=new P("angularfire2.realtimeDatabaseURL"),T5=new P("angularfire2.database.use-emulator"),Co=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,m){this.schedulers=a;let I=u,A=Di(n,o,r);c&&El(A,o,l,h,f,p,d,g),this.database=as(`${A.name}.database.${i}`,"AngularFireDatabase",A.name,()=>{let D=o.runOutsideAngular(()=>A.database(i||void 0));return I&&D.useEmulator(...I),D},[I])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>bk(this.database,n)),s=i;return r&&(s=r(i)),I5(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>bk(this.database,n));return C5(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(w(jr),w(Ur,8),w(D5,8),w(St),w(de),w(ss),w(T5,8),w(Qp,8),w(gl,8),w(ml,8),w(_l,8),w(yl,8),w(vl,8),w(wl,8),w(lr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Fk=(()=>{class t{constructor(){Je.registerVersion("angularfire",Lr.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=He({type:t});static \u0275inj=$e({providers:[Co]})}return t})();var Gk=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(K(mi),K(Nr))},e.\u0275dir=Ut({type:e});let t=e;return t})(),Gg=(()=>{let e=class e extends Gk{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Xi(e)))(s||e)}})(),e.\u0275dir=Ut({type:e,features:[yi]});let t=e;return t})(),id=new P("");var b5={provide:id,useExisting:Yi(()=>gu),multi:!0};function S5(){let t=kr()?kr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var A5=new P(""),gu=(()=>{let e=class e extends Gk{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!S5())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(K(mi),K(Nr),K(A5,8))},e.\u0275dir=Ut({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&we("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[La([b5]),yi]});let t=e;return t})();var x5=new P(""),R5=new P("");function zk(t){return t!=null}function Wk(t){return uo(t)?ce(t):t}function Kk(t){let e={};return t.forEach(n=>{e=n!=null?N(N({},e),n):e}),Object.keys(e).length===0?null:e}function Qk(t,e){return e.map(n=>n(t))}function M5(t){return!t.validate}function Yk(t){return t.map(e=>M5(e)?e:n=>e.validate(n))}function N5(t){if(!t)return null;let e=t.filter(zk);return e.length==0?null:function(n){return Kk(Qk(n,e))}}function Zk(t){return t!=null?N5(Yk(t)):null}function P5(t){if(!t)return null;let e=t.filter(zk);return e.length==0?null:function(n){let r=Qk(n,e).map(Wk);return Dy(r).pipe(U(Kk))}}function Xk(t){return t!=null?P5(Yk(t)):null}function Vk(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function k5(t){return t._rawValidators}function O5(t){return t._rawAsyncValidators}function $C(t){return t?Array.isArray(t)?t:[t]:[]}function Hg(t,e){return Array.isArray(t)?t.includes(e):t===e}function Lk(t,e){let n=$C(e);return $C(t).forEach(i=>{Hg(n,i)||n.push(i)}),n}function jk(t,e){return $C(e).filter(n=>!Hg(t,n))}var qg=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Zk(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Xk(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},HC=class extends qg{get formDirective(){return null}get path(){return null}},rd=class extends qg{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},qC=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},F5={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},xoe=Ce(N({},F5),{"[class.ng-submitted]":"isSubmitted"}),zg=(()=>{let e=class e extends qC{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(K(rd,2))},e.\u0275dir=Ut({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&vw("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[yi]});let t=e;return t})();var td="VALID",$g="INVALID",pu="PENDING",nd="DISABLED";function V5(t){return(Wg(t)?t.validators:t)||null}function L5(t){return Array.isArray(t)?Zk(t):t||null}function j5(t,e){return(Wg(e)?e.asyncValidators:t)||null}function U5(t){return Array.isArray(t)?Xk(t):t||null}function Wg(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var GC=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===td}get invalid(){return this.status===$g}get pending(){return this.status==pu}get disabled(){return this.status===nd}get enabled(){return this.status!==nd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Lk(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Lk(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(jk(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(jk(e,this._rawAsyncValidators))}hasValidator(e){return Hg(this._rawValidators,e)}hasAsyncValidator(e){return Hg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=pu,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=nd,this.errors=null,this._forEachChild(r=>{r.disable(Ce(N({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Ce(N({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=td,this._forEachChild(r=>{r.enable(Ce(N({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Ce(N({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===td||this.status===pu)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?nd:td}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=pu,this._hasOwnPendingAsyncValidator=!0;let n=Wk(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new It,this.statusChanges=new It}_calculateStatus(){return this._allControlsDisabled()?nd:this.errors?$g:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(pu)?pu:this._anyControlsHaveStatus($g)?$g:td}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Wg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=L5(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=U5(this._rawAsyncValidators)}};var Jk=new P("CallSetDisabledState",{providedIn:"root",factory:()=>zC}),zC="always";function B5(t,e){return[...e.path,t]}function $5(t,e,n=zC){q5(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),G5(t,e),W5(t,e),z5(t,e),H5(t,e)}function Uk(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function H5(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function q5(t,e){let n=k5(t);e.validator!==null?t.setValidators(Vk(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=O5(t);e.asyncValidator!==null?t.setAsyncValidators(Vk(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();Uk(e._rawValidators,i),Uk(e._rawAsyncValidators,i)}function G5(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&eO(t,e)})}function z5(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&eO(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function eO(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function W5(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function K5(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function Q5(t){return Object.getPrototypeOf(t.constructor)===Gg}function Y5(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===gu?n=s:Q5(s)?r=s:i=s}),i||r||n||null}function Bk(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function $k(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var Z5=class extends GC{constructor(e=null,n,r){super(V5(n),j5(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Wg(n)&&(n.nonNullable||n.initialValueIsDefault)&&($k(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Bk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Bk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){$k(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var X5={provide:rd,useExisting:Yi(()=>sd)},Hk=Promise.resolve(),sd=(()=>{let e=class e extends rd{constructor(r,i,s,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new Z5,this._registered=!1,this.name="",this.update=new It,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=Y5(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),K5(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){$5(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Hk.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&up(i);Hk.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?B5(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(K(HC,9),K(x5,10),K(R5,10),K(id,10),K(_i,8),K(Jk,8))},e.\u0275dir=Ut({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[En.None,"disabled","isDisabled"],model:[En.None,"ngModel","model"],options:[En.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[La([X5]),yi,Oa]});let t=e;return t})();var J5={provide:id,useExisting:Yi(()=>od),multi:!0},od=(()=>{let e=class e extends Gg{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Xi(e)))(s||e)}})(),e.\u0275dir=Ut({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&we("input",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},features:[La([J5]),yi]});let t=e;return t})();var eW={provide:id,useExisting:Yi(()=>mu),multi:!0};function tO(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function tW(t){return t.split(":")[0]}var mu=(()=>{let e=class e extends Gg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=tO(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=tW(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Xi(e)))(s||e)}})(),e.\u0275dir=Ut({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&we("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[La([eW]),yi]});let t=e;return t})(),Kg=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(tO(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(K(Nr),K(mi),K(mu,9))},e.\u0275dir=Ut({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),nW={provide:id,useExisting:Yi(()=>nO),multi:!0};function qk(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function rW(t){return t.split(":")[0]}var nO=(()=>{let e=class e extends Gg{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let u=0;u<a.length;u++){let c=a[u],l=this._getOptionValue(c.value);s.push(l)}}else{let a=i.options;for(let u=0;u<a.length;u++){let c=a[u];if(c.selected){let l=this._getOptionValue(c.value);s.push(l)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=rW(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Xi(e)))(s||e)}})(),e.\u0275dir=Ut({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&we("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[La([nW]),yi]});let t=e;return t})(),Qg=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(qk(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(qk(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(K(Nr),K(mi),K(nO,9))},e.\u0275dir=Ut({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var iW=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=He({type:e}),e.\u0275inj=$e({});let t=e;return t})();var rO=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:Jk,useValue:r.callSetDisabledState??zC}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=He({type:e}),e.\u0275inj=$e({imports:[iW]});let t=e;return t})();var sO=(()=>{let e=class e{transform(r){let i=[],s=new Map;for(let o of r){let a=o.who,u=o.membercount;s.has(a)?s.set(a,s.get(a)+u):s.set(a,u)}for(let[o,a]of s.entries()){let u=r.filter(l=>l.who===o);if(u.length>1){let l={};for(let d of u){let h=d.member,f=d.membercount;l[h]?l[h]+=f:l[h]=f}for(let[d,h]of Object.entries(l))i.push({member:o,helper:d,totalAmount:h})}else i.push({member:o,helper:u[0].member,totalAmount:a})}return i}};e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=Mr({name:"mapMembers",type:e,pure:!0});let t=e;return t})();var oO=(()=>{let e=class e{transform(r){if(!r||r.length<2)return[];let i=[];for(let s of r){if(s.participantName)continue;let o=s.member,a=s.helper,u=s.totalAmount;if(o!==void 0&&a!==void 0&&u!==void 0){if(a&&u){let c=r.find(l=>l.member===o&&l.helper===a)?.totalAmount||0;if(c&&u>c){let l=u-c;i.push({borrower:a,helper:o,difference:l})}}if(a&&!r.some(c=>c.member===a&&c.helper===o)&&i.push({borrower:a,helper:o,difference:u}),a&&r.some(c=>c.member===a&&c.helper===o)){let c=r.find(l=>l.member===a&&l.helper===o)?.totalAmount||0;if(c&&u>c){let l=u-c;i.push({borrower:a,helper:o,difference:l})}}}}return i}};e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=Mr({name:"calculateSummary",type:e,pure:!0});let t=e;return t})();function aW(t,e){if(t&1){let n=Dn();S(0,"tr"),Bt(1,"td"),S(2,"td"),j(3),b(),S(4,"td"),j(5),b(),S(6,"td"),j(7),b(),S(8,"td"),j(9),b(),S(10,"td"),j(11),b(),S(12,"td")(13,"button",12),we("click",function(){qe(n);let i=fe().$implicit,s=fe();return Ge(s.deleteRecord(i))}),j(14,"\u522A\u9664"),b()()()}if(t&2){let n=fe().$implicit,r=fe();L(3),At(n==null?null:n.who),L(2),At(n==null?null:n.count),L(2),At(n==null?null:n.buy),L(2),At(n==null?null:n.member),L(2),At(n==null?null:n.membercount),L(2),Q("disabled",(r.accountData==null?null:r.accountData.settle)==="2")}}function uW(t,e){if(t&1&&(oo(0),et(1,aW,15,6,"tr",11),ao()),t&2){let n=e.$implicit;L(),Q("ngIf",(n==null?null:n.who)&&(n==null?null:n.count)&&(n==null?null:n.buy)&&(n==null?null:n.member)&&(n==null?null:n.membercount))}}function cW(t,e){if(t&1&&(S(0,"tr"),Bt(1,"td"),S(2,"td"),j(3),b(),S(4,"td"),j(5),b(),S(6,"td"),j(7),b(),Bt(8,"td"),b()),t&2){let n=fe().$implicit;L(3),At(n.member),L(2),At(n.helper),L(2),At(n.totalAmount)}}function lW(t,e){if(t&1&&(oo(0),et(1,cW,9,3,"tr",11),ao()),t&2){let n=e.$implicit;L(),Q("ngIf",n.member&&n.totalAmount)}}function dW(t,e){if(t&1&&(S(0,"table",2)(1,"thead")(2,"tr"),Bt(3,"th"),S(4,"th"),j(5,"\u91D1\u4E3B"),b(),S(6,"th"),j(7,"\u5E6B\u8AB0\u588A"),b(),S(8,"th"),j(9,"\u4EE3\u588A\u91D1\u984D"),b(),Bt(10,"th"),b()(),S(11,"tbody"),et(12,lW,2,1,"ng-container",3),es(13,"mapMembers"),b()()),t&2){let n=fe();L(12),Q("ngForOf",co(13,1,n.accountList))}}function hW(t,e){if(t&1&&(S(0,"span"),j(1),b()),t&2){let n=fe().$implicit;L(),Ew("",n.borrower," \u61C9\u652F\u4ED8\u7D66 ",n.helper," ",n.difference,"")}}function fW(t,e){if(t&1&&(oo(0),et(1,hW,2,3,"span",11),ao()),t&2){let n=e.$implicit;L(),Q("ngIf",n.totalAmount!==0)}}function pW(t,e){if(t&1&&(S(0,"div",13)(1,"span"),j(2,"\u7E3D\u7D50"),b(),et(3,fW,2,1,"ng-container",3),es(4,"calculateSummary"),es(5,"mapMembers"),b()),t&2){let n=fe();L(3),Q("ngForOf",co(4,1,co(5,3,n.accountList)))}}function gW(t,e){if(t&1){let n=Dn();S(0,"div",14),we("click",function(){qe(n);let i=fe();return Ge(i.toggleDialog())}),b()}}function mW(t,e){t&1&&(S(0,"span"),j(1,"\u91D1\u984D"),b())}function _W(t,e){if(t&1&&(S(0,"option",28),j(1),b()),t&2){let n=e.$implicit;Q("value",n),L(),At(n)}}function yW(t,e){if(t&1&&(S(0,"option",28),j(1),b()),t&2){let n=e.$implicit;Q("value",n),L(),At(n)}}function vW(t,e){if(t&1){let n=Dn();S(0,"input",24),we("ngModelChange",function(i){qe(n);let s=fe(2);return Ge(s.membercount=i)}),b()}if(t&2){let n=fe(2);Q("ngModel",n.membercount)}}function wW(t,e){if(t&1){let n=Dn();S(0,"div",15)(1,"div",16)(2,"p"),j(3,"\u65B0\u589E\u4E00\u7B46\u7D00\u9304"),b()(),S(4,"div",17)(5,"div",18)(6,"span"),j(7,"\u91D1\u4E3B"),b(),S(8,"span"),j(9,"\u8CB7\u4EC0\u9EBC"),b(),S(10,"span"),j(11,"\u7E3D\u984D"),b(),S(12,"span"),j(13,"\u5E6B\u8AB0\u588A"),b(),et(14,mW,2,0,"span",11),b(),S(15,"div",19)(16,"select",20),we("ngModelChange",function(i){qe(n);let s=fe();return Ge(s.selectValue=i)}),S(17,"option",21),j(18,"\u8ACB\u9078\u64C7\u91D1\u4E3B"),b(),et(19,_W,2,2,"option",22),b(),S(20,"input",23),we("ngModelChange",function(i){qe(n);let s=fe();return Ge(s.inputValue=i)}),b(),S(21,"input",24),we("ngModelChange",function(i){qe(n);let s=fe();return Ge(s.numberValue=i)}),b(),S(22,"select",20),we("ngModelChange",function(i){qe(n);let s=fe();return Ge(s.member=i)}),S(23,"option",21),j(24,"\u8ACB\u9078\u64C7\u5E6B\u8AB0\u588A"),b(),et(25,yW,2,2,"option",22),b(),et(26,vW,1,1,"input",25),b()(),S(27,"div",26)(28,"button",27),we("click",function(){qe(n);let i=fe();return Ge(i.addRecord())}),j(29,"\u65B0\u589E"),b()()()}if(t&2){let n=fe();L(14),Q("ngIf",n.member!=="\u5168\u90E8"),L(2),Q("ngModel",n.selectValue),L(3),Q("ngForOf",n.accountData.participantName),L(),Q("ngModel",n.inputValue),L(),Q("ngModel",n.numberValue),L(),Q("ngModel",n.member),L(3),Q("ngForOf",n.getAvailableHelpers()),L(),Q("ngIf",n.member!=="\u5168\u90E8")}}var aO=(()=>{let e=class e{constructor(r,i){this.db=r,this.route=i,this.addTrue=!1,this.selectValue="",this.inputValue="",this.member="",this.accountId="",this.accountList=[]}ngOnInit(){this.routeSub=this.route.params.subscribe(r=>{this.accountId=r.id,this.getAccountData(this.accountId)})}getAccountData(r){this.db.object(`account/${r}`).valueChanges().subscribe(i=>{this.accountData={date:i.date,title:i.title,settle:i.settle,participantName:i.participantName};let s=Object.keys(i).filter(o=>o!=="date"&&o!=="title");this.accountList=s.map(o=>N({$key:o},i[o])),console.log(this.accountData),console.log(this.accountList)})}toggleDialog(){this.addTrue=!this.addTrue}addRecord(){if(this.numberValue!==void 0){let r=this.numberValue,i=this.selectValue,s=this.inputValue;if(this.member==="\u5168\u90E8"){let o=this.getAvailableHelpers();o.forEach(a=>{if(a!==i){let u={who:i,buy:s,count:r,member:a,membercount:Math.floor(r/o.length)};a!=="\u5168\u90E8"&&(this.pushRecordToDatabase(u),this.addTrue=!1)}})}else if(this.member!=="\u5168\u90E8"&&i){let o={who:i,buy:s,count:r,member:this.member,membercount:this.membercount};this.pushRecordToDatabase(o),this.addTrue=!1}}}pushRecordToDatabase(r){this.db.list(`account/${this.accountId}`).push(r).then(s=>{let o=s.key;console.log("New record added with ID:",o)}).catch(s=>{console.error("Error adding new record: ",s)}),this.clearInputValues(),this.toggleDialog()}clearInputValues(){this.selectValue="",this.inputValue="",this.numberValue=void 0,this.member="",this.membercount=void 0}calculateTotalAmount(r){let i=0;for(let s of this.accountList)s.member===r&&(i+=s.membercount);return i}getAvailableHelpers(){let r=this.selectValue,i=this.accountData.participantName.filter(s=>s!==r);return i.unshift("\u5168\u90E8"),i}deleteRecord(r){let i=r.$key;if(!i)return;console.log(i),confirm("\u78BA\u5B9A\u8981\u522A\u9664\u9019\u7B46\u55CE?")&&this.db.object(`account/${this.accountId}/${i}`).remove().then(()=>{console.log(`account/${this.accountId}/${i}`),console.log("Record deleted successfully")}).catch(o=>{console.error("Error deleting record:",o)})}};e.\u0275fac=function(i){return new(i||e)(K(Co),K(Fr))},e.\u0275cmp=Rr({type:e,selectors:[["app-accounts"]],decls:33,vars:9,consts:[[1,"accounts"],[1,"accounts__top"],[1,"table","accounts__table"],[4,"ngFor","ngForOf"],[1,"accounts__spacer"],["class","table accounts__table",4,"ngIf"],["class","accounts__total",4,"ngIf"],[1,"add"],[1,"add__addBtn",3,"disabled","click"],["class","overlay",3,"click",4,"ngIf"],["class","dialog",4,"ngIf"],[4,"ngIf"],[1,"accounts__editBtn",3,"disabled","click"],[1,"accounts__total"],[1,"overlay",3,"click"],[1,"dialog"],[1,"dialog__topbar"],[1,"dialog__maintext"],[1,"dialog__left"],[1,"dialog__right"],["name","","id","",3,"ngModel","ngModelChange"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["type","text",3,"ngModel","ngModelChange"],["type","number",3,"ngModel","ngModelChange"],["type","number",3,"ngModel","ngModelChange",4,"ngIf"],[1,"dialog__btn"],[1,"dialog__add",3,"click"],[3,"value"]],template:function(i,s){i&1&&(S(0,"div",0)(1,"div",1)(2,"span"),j(3),b(),S(4,"span"),j(5),b(),S(6,"span"),j(7),b()(),S(8,"table",2)(9,"thead")(10,"tr"),Bt(11,"th"),S(12,"th"),j(13,"\u91D1\u4E3B"),b(),S(14,"th"),j(15,"\u7E3D\u984D"),b(),S(16,"th"),j(17,"\u8CB7\u4EC0\u9EBC"),b(),S(18,"th"),j(19,"\u5E6B\u8AB0\u588A"),b(),S(20,"th"),j(21,"\u91D1\u984D"),b(),Bt(22,"th"),b()(),et(23,uW,2,1,"ng-container",3),b(),S(24,"div",4),j(25," \xA0 "),b(),et(26,dW,14,3,"table",5)(27,pW,6,5,"div",6),b(),S(28,"div",7)(29,"button",8),we("click",function(){return s.toggleDialog()}),j(30,"+"),b()(),et(31,gW,1,0,"div",9)(32,wW,30,8,"div",10)),i&2&&(L(3),At(s.accountData==null?null:s.accountData.date),L(2),At(s.accountData==null?null:s.accountData.title),L(2),Va("\u53C3\u8207\u4EBA\u54E1\uFF1A",s.accountData==null?null:s.accountData.participantName,""),L(16),Q("ngForOf",s.accountList),L(3),Q("ngIf",s.accountList.length>3),L(),Q("ngIf",s.accountList.length>3),L(2),Q("disabled",s.accountData&&s.accountData.settle==="2"),L(2),Q("ngIf",s.addTrue),L(),Q("ngIf",s.addTrue))},dependencies:[Ip,Ba,Kg,Qg,gu,od,mu,zg,sd,sO,oO],styles:[".accounts[_ngcontent-%COMP%]{position:relative;color:#b86a6a}.accounts__top[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:20px;margin:20px auto;font-size:20px}.accounts__table[_ngcontent-%COMP%]{color:#b86a6a;font-size:14px;text-align:center}.accounts__editBtn[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #B86A6A;border-radius:8px;color:#b86a6a;margin-bottom:8px}.accounts[_ngcontent-%COMP%]   .accounts__editBtn[_ngcontent-%COMP%]:disabled{background-color:#b0b0b0;color:#6c6c6c;border:1px solid #6c6c6c;cursor:not-allowed}.accounts__spacer[_ngcontent-%COMP%]{margin-bottom:20px}.accounts__total[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.accounts__total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:10px;font-size:16px}.add[_ngcontent-%COMP%]{position:fixed;bottom:40px;right:20px}.add__addBtn[_ngcontent-%COMP%]{background-color:#b86a6a;font-size:16px;color:#fff;border-radius:50%;border:1px solid #F5D0D0}.add__addBtn[_ngcontent-%COMP%]:disabled{display:none}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080}.dialog[_ngcontent-%COMP%]{width:360px;background-color:#fff;position:absolute;border-radius:20px;top:50%;left:50%;transform:translate(-50%,-50%)}.dialog__topbar[_ngcontent-%COMP%]{background-color:#f5d0d0;text-align:center;font-size:20px;border-radius:20px 20px 0 0;font-weight:600;color:#b86a6a}.dialog__topbar[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:8px}.dialog__maintext[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto}.dialog__left[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;text-align:center;font-size:16px}.dialog__left[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#b86a6a;font-weight:600}.dialog__right[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.dialog__right[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:24px;width:200px;background-color:#f5d0d0;border:1px solid white;font-size:16px}.dialog__right[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px;height:24px;width:200px;background-color:#f5d0d0;border:1px solid white}.dialog__btn[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.dialog__add[_ngcontent-%COMP%]{background-color:#f5d0d0;border:1px solid #B86A6A;border-radius:20px;text-align:center;margin:20px 0;width:100px}"]});let t=e;return t})();var uO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Rr({type:e,selectors:[["app-header"]],decls:3,vars:0,consts:[[1,"header"],[1,"header__text"]],template:function(i,s){i&1&&(S(0,"div",0)(1,"h1",1),j(2,"\u5171\u7528\u8A18\u5E33"),b()())},styles:[".header[_ngcontent-%COMP%]{background-color:#f5d0d0}.header__text[_ngcontent-%COMP%]{color:#fff;font-size:28px;padding:12px;text-align:center;font-weight:600}"]});let t=e;return t})();var cO=(()=>{let e=class e{constructor(r){this.db=r}loadnewAccountData(r){return this.db.object(`account/${r}`).valueChanges()}};e.\u0275fac=function(i){return new(i||e)(w(Co))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var lO=(()=>{let e=class e{transform(r){return r?r.slice().reverse():[]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=Mr({name:"reverse",type:e,pure:!0});let t=e;return t})();function DW(t,e){if(t&1){let n=Dn();S(0,"div",7),we("click",function(){qe(n);let i=fe();return Ge(i.toggleDialog())}),b()}}function TW(t,e){t&1&&Bt(0,"div",8)}function bW(t,e){t&1&&(S(0,"div",17)(1,"span"),j(2,"\u65E5\u671F"),b(),S(3,"span"),j(4,"\u540D\u7A31"),b(),S(5,"span"),j(6,"\u4EBA\u6578"),b()())}function SW(t,e){if(t&1){let n=Dn();S(0,"div",18)(1,"input",19),we("ngModelChange",function(i){qe(n);let s=fe(2);return Ge(s.dateValue=i)}),es(2,"date"),b(),S(3,"input",20),we("ngModelChange",function(i){qe(n);let s=fe(2);return Ge(s.titleValue=i)}),b(),S(4,"input",21),we("ngModelChange",function(i){qe(n);let s=fe(2);return Ge(s.numberOfPeople=i)}),b()()}if(t&2){let n=fe(2);L(),ww("min",wR(2,4,n.minDate,"yyyy-MM-dd")),Q("ngModel",n.dateValue),L(2),Q("ngModel",n.titleValue),L(),Q("ngModel",n.numberOfPeople)}}function AW(t,e){if(t&1){let n=Dn();oo(0),S(1,"input",23),we("ngModelChange",function(i){let o=qe(n).index,a=fe(3);return Ge(a.participantName[o]=i)}),b(),ao()}if(t&2){let n=e.index,r=fe(3);L(),Q("ngModel",r.participantName[n])}}function xW(t,e){if(t&1&&(S(0,"div",22),et(1,AW,2,1,"ng-container",5),b()),t&2){let n=fe(2);L(),Q("ngForOf",n.countPeople(n.numberOfPeople))}}function RW(t,e){if(t&1){let n=Dn();S(0,"div",24)(1,"button",25),we("click",function(){qe(n);let i=fe(2);return Ge(i.toNewAccount())}),j(2,"\u65B0\u589E"),b()()}}function MW(t,e){if(t&1){let n=Dn();S(0,"div",26)(1,"button",27),we("click",function(){qe(n);let i=fe(2);return Ge(i.goNextPage())}),j(2,"\u4E0B\u4E00\u6B65"),b()()}}function NW(t,e){if(t&1&&(S(0,"div",9)(1,"div",10)(2,"p"),j(3,"\u65B0\u589E\u4E00\u7B46\u7D00\u9304"),b()(),S(4,"div",11),et(5,bW,7,0,"div",12)(6,SW,5,7,"div",13),b(),et(7,xW,2,1,"div",14)(8,RW,3,0,"div",15)(9,MW,3,0,"div",16),b()),t&2){let n=fe();L(5),Q("ngIf",n.mainPage),L(),Q("ngIf",n.mainPage),L(),Q("ngIf",n.showNameInput),L(),Q("ngIf",n.showNameInput),L(),Q("ngIf",n.mainPage)}}var PW=(t,e,n)=>({editSettle:t,"fade-out":e,"fade-out-active":n});function kW(t,e){if(t&1){let n=Dn();S(0,"div")(1,"div",28)(2,"div",29)(3,"div",30)(4,"span"),j(5),b(),S(6,"span"),j(7),b(),S(8,"span"),j(9),b()(),S(10,"div",31)(11,"button",32),we("click",function(){let s=qe(n).$implicit,o=fe();return Ge(o.viewAccountDetails(s.key))}),j(12,"\u67E5\u770B"),b(),S(13,"button",33),we("click",function(){let s=qe(n).$implicit,o=fe();return Ge(o.editAccount(s.key))}),j(14,"\u7DE8\u8F2F"),b()()()()()}if(t&2){let n=e.$implicit;L(),Q("ngClass",vR(5,PW,n.value.settle==="2",n.value.isDelete,n.value.isDelete)),L(4),At(n.value.date),L(2),At(n.value.title),L(2),Va("\u53C3\u8207\u4EBA\u54E1\uFF1A",n.value.participantName,""),L(4),Q("disabled",n.value.settle==="2")}}function OW(t,e){if(t&1){let n=Dn();S(0,"div",34)(1,"div",35)(2,"p"),j(3,"\u7DE8\u8F2F"),b()(),S(4,"div",36)(5,"div",37)(6,"span"),j(7,"\u65E5\u671F"),b(),S(8,"span"),j(9,"\u540D\u7A31"),b(),S(10,"span"),j(11,"\u72C0\u614B"),b()(),S(12,"div",38)(13,"span"),j(14),b(),S(15,"input",20),we("ngModelChange",function(i){qe(n);let s=fe();return Ge(s.titleValue=i)}),b(),S(16,"select",39),we("ngModelChange",function(i){qe(n);let s=fe();return Ge(s.settleValue=i)}),S(17,"option",40),j(18,"\u8ACB\u9078\u64C7"),b(),S(19,"option",41),j(20,"\u5C1A\u672A\u7D50\u6E05"),b(),S(21,"option",42),j(22,"\u5DF2\u7D93\u7D50\u6E05"),b()()()(),S(23,"div",43)(24,"button",44),we("click",function(){qe(n);let i=fe();return Ge(i.saveEdit())}),j(25,"\u5132\u5B58"),b(),S(26,"button",44),we("click",function(){qe(n);let i=fe();return Ge(i.toggleEdit())}),j(27,"\u53D6\u6D88"),b()(),S(28,"div",45)(29,"button",46),we("click",function(){qe(n);let i=fe();return Ge(i.deleteAccount(i.editAccountId))}),j(30,"\u522A\u9664"),b()()()}if(t&2){let n=fe();L(14),At(n.dateValue),L(),Q("ngModel",n.titleValue),L(),Q("ngModel",n.settleValue)}}var dO=(()=>{let e=class e{ngOnInit(){this.loadnewAccountData(this.newAccountId),this.minDate=new Date}constructor(r,i,s,o){this.router=r,this.dataService=i,this.db=s,this.cdr=o,this.addTrue=!1,this.editTrue=!1,this.dateValue="",this.titleValue="",this.settleValue="",this.newAccountId="",this.showButtons=!1,this.showNameInput=!1,this.mainPage=!0,this.numberOfPeople=0,this.participantName=[],this.newAccountData={},this.editAccountId=null,this.isDelete=!1}toNewAccount(){let r={date:this.dateValue,title:this.titleValue,settle:this.settleValue="1",isDelete:this.isDelete,participantName:this.participantName},i=this.db.createPushId();this.db.object(`account/${i}`).set(r).then(()=>{this.toggleDialog(),this.dateValue="",this.titleValue="",this.numberOfPeople=0,this.participantName=[],this.showNameInput=!1,this.mainPage=!0}).catch(s=>{console.error("Error writing new account data:",s)})}toggleDialog(){this.addTrue=!this.addTrue,this.dateValue="",this.titleValue="",this.settleValue=""}toggleEdit(){this.editTrue=!1}goNextPage(){this.showNameInput=!0,this.mainPage=!1}countPeople(r){return new Array(r)}viewAccountDetails(r){this.router.navigate(["/account",r])}loadnewAccountData(r){this.db.object(`account/${r}`).valueChanges().subscribe(i=>{i?(this.newAccountData=i,this.showButtons=!0):this.showButtons=!1},i=>{console.error("Error fetching account data:",i)})}editAccount(r){r&&(this.editTrue=!0,this.editAccountId=r,this.dateValue=this.newAccountData[r].date,this.titleValue=this.newAccountData[r].title,this.settleValue=this.newAccountData[r].settle)}saveEdit(){if(!this.editAccountId)return;let r={date:this.dateValue,title:this.titleValue,settle:this.settleValue};this.db.object(`account/${this.editAccountId}`).update(r).then(()=>{this.editAccountId=null,this.toggleEdit()}).catch(i=>{console.error("Error updating account data:",i)})}deleteAccount(r){if(!r)return;confirm("\u78BA\u5B9A\u8981\u522A\u9664\u9019\u7B46\u55CE?")&&(this.newAccountData[r].isDelete=!0,this.editTrue=!1,setTimeout(()=>{this.db.object(`account/${r}`).remove().then(()=>{delete this.newAccountData[r],this.dateValue="",this.titleValue=""}).catch(s=>{console.error("Error deleting account:",s)}).finally(()=>{})},600))}};e.\u0275fac=function(i){return new(i||e)(K(cr),K(cO),K(Co),K(_i))},e.\u0275cmp=Rr({type:e,selectors:[["app-add-button"]],decls:10,vars:9,consts:[[1,"addButton"],["type","button",1,"addButton__btn",3,"click"],["class","overlay",3,"click",4,"ngIf"],["class","overlay",4,"ngIf"],["class","dialog",4,"ngIf"],[4,"ngFor","ngForOf"],["class","editDialog",4,"ngIf"],[1,"overlay",3,"click"],[1,"overlay"],[1,"dialog"],[1,"dialog__topbar"],[1,"dialog__maintext"],["class","dialog__left",4,"ngIf"],["class","dialog__right",4,"ngIf"],["class","dialog__showName",4,"ngIf"],["class","dialog__btn",4,"ngIf"],["class","dialog__nextbtn",4,"ngIf"],[1,"dialog__left"],[1,"dialog__right"],["type","date",3,"ngModel","min","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["type","number",3,"ngModel","ngModelChange"],[1,"dialog__showName"],["type","text","placeholder","\u53C3\u8207\u4EBA\u54E1\u540D\u7A31",3,"ngModel","ngModelChange"],[1,"dialog__btn"],[1,"dialog__add",3,"click"],[1,"dialog__nextbtn"],[1,"dialog__nextPage",3,"click"],[1,"accountDetails",3,"ngClass"],[1,"accountDetails__main"],[1,"accountDetails__top"],[1,"accountDetails__btn"],["type","button",1,"accountDetails__search",3,"click"],["type","button",1,"accountDetails__search",3,"disabled","click"],[1,"editDialog"],[1,"editDialog__topbar"],[1,"editDialog__maintext"],[1,"editDialog__left"],[1,"editDialog__right"],["name","","id","",3,"ngModel","ngModelChange"],["value",""],["value","1"],["value","2"],[1,"editDialog__btn"],[1,"editDialog__add",3,"click"],[1,"editDialog__delete"],[1,"editDialog__deleteBtn",3,"click"]],template:function(i,s){i&1&&(S(0,"div",0)(1,"button",1),we("click",function(){return s.toggleDialog()}),j(2,"\u65B0\u589E\u4E00\u7B46"),b()(),et(3,DW,1,0,"div",2)(4,TW,1,0,"div",3)(5,NW,10,5,"div",4)(6,kW,15,9,"div",5),es(7,"reverse"),es(8,"keyvalue"),et(9,OW,31,3,"div",6)),i&2&&(L(3),Q("ngIf",s.addTrue),L(),Q("ngIf",s.editTrue),L(),Q("ngIf",s.addTrue),L(),Q("ngForOf",co(7,5,co(8,7,s.newAccountData))),L(3),Q("ngIf",s.editTrue===!0))},dependencies:[WR,Ip,Ba,Kg,Qg,gu,od,mu,zg,sd,KR,QR,lO],styles:[".addButton[_ngcontent-%COMP%]{margin:20px auto;display:flex;justify-content:center;align-items:center}.addButton__btn[_ngcontent-%COMP%]{background-color:#f5d0d080;border:1px solid #B86A6A;width:280px;font-size:16px;font-weight:600;color:#b86a6a;border-radius:10px;padding:4px}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080}.dialog[_ngcontent-%COMP%]{width:360px;background-color:#fff;position:absolute;border-radius:20px;font-size:16px;top:50%;left:50%;transform:translate(-50%,-50%)}.dialog__topbar[_ngcontent-%COMP%]{background-color:#f5d0d0;text-align:center;font-size:20px;border-radius:20px 20px 0 0;font-weight:600;color:#b86a6a}.dialog__maintext[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto}.dialog__left[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;text-align:center}.dialog__left[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#b86a6a;font-weight:600}.dialog__right[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.dialog__right[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:24px;width:200px;background-color:#f5d0d0;border:1px solid white}.dialog__showName[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;gap:20px;width:100%}.dialog__showName[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:24px;width:200px;background-color:#f5d0d0;border:1px solid white;text-align:center}.dialog__btn[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.dialog__add[_ngcontent-%COMP%]{background-color:#f5d0d0;border:1px solid #B86A6A;border-radius:20px;text-align:center;margin:20px 0;width:100px}.dialog__nextbtn[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.dialog__nextPage[_ngcontent-%COMP%]{background-color:#f5d0d0;border:1px solid #B86A6A;border-radius:20px;text-align:center;margin:20px 0;width:100px}.accountDetails__main[_ngcontent-%COMP%]{background-color:#f5d0d080;border:1px solid #B86A6A;border-radius:20px;display:flex;flex-direction:column;justify-content:center;align-items:center;margin:28px 16px}.accountDetails__top[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:#b86a6a;text-align:center;font-weight:600;font-size:16px}.accountDetails__btn[_ngcontent-%COMP%]{display:flex;gap:64px;margin-bottom:12px}.accountDetails__search[_ngcontent-%COMP%]{width:120px;height:27px;background-color:#fff;border:1px solid #F5D0D0;border-radius:20px;color:#b86a6a;font-size:16px;font-weight:600}.editDialog[_ngcontent-%COMP%]{width:360px;background-color:#fff;position:absolute;border-radius:20px;top:50%;left:50%;transform:translate(-50%,-50%)}.editDialog__topbar[_ngcontent-%COMP%]{background-color:#f5d0d0;text-align:center;font-size:20px;border-radius:20px 20px 0 0;font-weight:600;color:#b86a6a}.editDialog__maintext[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto auto}.editDialog__left[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;text-align:center;font-size:16px}.editDialog__left[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#b86a6a;font-weight:600}.editDialog__right[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;font-size:16px}.editDialog__right[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:24px;width:200px;background-color:#f5d0d0;border:1px solid white}.editDialog__btn[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.editDialog__add[_ngcontent-%COMP%]{background-color:#f5d0d0;border:1px solid #B86A6A;border-radius:20px;text-align:center;margin:20px 20px 0;width:100px;font-weight:600;font-size:16px}.editDialog[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{height:24px;width:200px;text-align:center;background-color:#f5d0d0;border:1px solid white}.editDialog__delete[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin:0 auto 20px}.editDialog__deleteBtn[_ngcontent-%COMP%]{background-color:#f009;border:1px solid rgba(255,0,0,.6);border-radius:20px;text-align:center;margin:20px 20px 0;width:100px;font-weight:600;font-size:16px}.editSettle[_ngcontent-%COMP%]   .accountDetails__main[_ngcontent-%COMP%]{background-color:#d9d9d980;border:1px solid rgba(217,217,217,.5);border-radius:20px;display:flex;flex-direction:column;justify-content:center;align-items:center;margin:28px 16px}.editSettle[_ngcontent-%COMP%]   .accountDetails__top[_ngcontent-%COMP%]{display:flex;flex-direction:column;color:#6c6c6c;text-align:center;font-weight:600;font-size:16px}.editSettle__btn[_ngcontent-%COMP%]{display:flex;gap:64px;margin-bottom:12px}.editSettle[_ngcontent-%COMP%]   .accountDetails__search[_ngcontent-%COMP%]:disabled{background-color:#b0b0b0;color:#6c6c6c;border:1px solid #6c6c6c;cursor:not-allowed}.fade-out[_ngcontent-%COMP%]{opacity:1;transition:opacity .5s ease-out}.fade-out.fade-out-active[_ngcontent-%COMP%]{opacity:0}"]});let t=e;return t})();function VW(t,e){t&1&&Bt(0,"router-outlet")}function LW(t,e){t&1&&Bt(0,"app-add-button")}var Yg=(()=>{let e=class e{constructor(r,i){this.router=r,this.activatedRoute=i,this.title="count",this.isAccountPage=!1}ngOnInit(){this.router.events.pipe(Et(r=>r instanceof ur)).subscribe(()=>{this.isAccountPage=this.activatedRoute.snapshot.firstChild?.routeConfig?.path==="account/:id"})}};e.\u0275fac=function(i){return new(i||e)(K(cr),K(Fr))},e.\u0275cmp=Rr({type:e,selectors:[["app-root"]],decls:3,vars:2,consts:[[4,"ngIf"]],template:function(i,s){i&1&&(Bt(0,"app-header"),et(1,VW,1,0,"router-outlet",0)(2,LW,1,0,"app-add-button",0)),i&2&&(L(),Q("ngIf",s.isAccountPage),L(),Q("ngIf",!s.isAccountPage))},dependencies:[Ba,SE,uO,dO]});let t=e;return t})();var jW=[{path:"",component:Yg},{path:"account/:id",component:aO}],hO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=He({type:e}),e.\u0275inj=$e({providers:[{provide:Ci,useClass:wp}],imports:[kE.forRoot(jW),kE]});let t=e;return t})();var UW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gr={},R,p0=p0||{},ee=UW||self;function lm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function wd(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function BW(t){return Object.prototype.hasOwnProperty.call(t,WC)&&t[WC]||(t[WC]=++$W)}var WC="closure_uid_"+(1e9*Math.random()>>>0),$W=0;function HW(t,e,n){return t.call.apply(t.bind,arguments)}function qW(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Kt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Kt=HW:Kt=qW,Kt.apply(null,arguments)}function Zg(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Pt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function _s(){this.s=this.s,this.o=this.o}var GW=0;_s.prototype.s=!1;_s.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),GW!=0)&&BW(this)};_s.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var TO=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function g0(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function fO(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(lm(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Qt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Qt.prototype.h=function(){this.defaultPrevented=!0};var zW=function(){if(!ee.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};ee.addEventListener("test",n,e),ee.removeEventListener("test",n,e)}catch{}return t}();function hd(t){return/^[\s\xa0]*$/.test(t)}function dm(){var t=ee.navigator;return t&&(t=t.userAgent)?t:""}function zr(t){return dm().indexOf(t)!=-1}function m0(t){return m0[" "](t),t}m0[" "]=function(){};function WW(t,e){var n=O8;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var KW=zr("Opera"),wu=zr("Trident")||zr("MSIE"),bO=zr("Edge"),XC=bO||wu,SO=zr("Gecko")&&!(dm().toLowerCase().indexOf("webkit")!=-1&&!zr("Edge"))&&!(zr("Trident")||zr("MSIE"))&&!zr("Edge"),QW=dm().toLowerCase().indexOf("webkit")!=-1&&!zr("Edge");function AO(){var t=ee.document;return t?t.documentMode:void 0}var JC;e:{if(Xg="",Jg=function(){var t=dm();if(SO)return/rv:([^\);]+)(\)|;)/.exec(t);if(bO)return/Edge\/([\d\.]+)/.exec(t);if(wu)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(QW)return/WebKit\/(\S+)/.exec(t);if(KW)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Jg&&(Xg=Jg?Jg[1]:""),wu&&(em=AO(),em!=null&&em>parseFloat(Xg))){JC=String(em);break e}JC=Xg}var Xg,Jg,em,e0;ee.document&&wu?(KC=AO(),e0=KC||parseInt(JC,10)||void 0):e0=void 0;var KC,YW=e0;function fd(t,e){if(Qt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(SO){e:{try{m0(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:ZW[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&fd.$.h.call(this)}}Pt(fd,Qt);var ZW={2:"touch",3:"pen",4:"mouse"};fd.prototype.h=function(){fd.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Ed="closure_listenable_"+(1e6*Math.random()|0),XW=0;function JW(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++XW,this.fa=this.ia=!1}function hm(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function _0(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function e8(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function xO(t){let e={};for(let n in t)e[n]=t[n];return e}var pO="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function RO(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<pO.length;s++)n=pO[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function fm(t){this.src=t,this.g={},this.h=0}fm.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=n0(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new JW(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function t0(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=TO(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(hm(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function n0(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var y0="closure_lm_"+(1e6*Math.random()|0),QC={};function MO(t,e,n,r,i){if(r&&r.once)return PO(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)MO(t,e[s],n,r,i);return null}return n=E0(n),t&&t[Ed]?t.O(e,n,wd(r)?!!r.capture:!!r,i):NO(t,e,n,!1,r,i)}function NO(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=wd(i)?!!i.capture:!!i,a=w0(t);if(a||(t[y0]=a=new fm(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=t8(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)zW||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(OO(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function t8(){function t(n){return e.call(t.src,t.listener,n)}let e=n8;return t}function PO(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)PO(t,e[s],n,r,i);return null}return n=E0(n),t&&t[Ed]?t.P(e,n,wd(r)?!!r.capture:!!r,i):NO(t,e,n,!0,r,i)}function kO(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)kO(t,e[s],n,r,i);else r=wd(r)?!!r.capture:!!r,n=E0(n),t&&t[Ed]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=n0(s,n,r,i),-1<n&&(hm(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=w0(t))&&(e=t.g[e.toString()],t=-1,e&&(t=n0(e,n,r,i)),(n=-1<t?e[t]:null)&&v0(n))}function v0(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Ed])t0(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(OO(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=w0(e))?(t0(n,t),n.h==0&&(n.src=null,e[y0]=null)):hm(t)}}}function OO(t){return t in QC?QC[t]:QC[t]="on"+t}function n8(t,e){if(t.fa)t=!0;else{e=new fd(e,this);var n=t.listener,r=t.la||t.src;t.ia&&v0(t),t=n.call(r,e)}return t}function w0(t){return t=t[y0],t instanceof fm?t:null}var YC="__closure_events_fn_"+(1e9*Math.random()>>>0);function E0(t){return typeof t=="function"?t:(t[YC]||(t[YC]=function(e){return t.handleEvent(e)}),t[YC])}function Nt(){_s.call(this),this.i=new fm(this),this.S=this,this.J=null}Pt(Nt,_s);Nt.prototype[Ed]=!0;Nt.prototype.removeEventListener=function(t,e,n,r){kO(this,t,e,n,r)};function Ht(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Qt(e,t);else if(e instanceof Qt)e.target=e.target||t;else{var i=e;e=new Qt(r,t),RO(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=tm(o,r,!0,e)&&i}if(o=e.g=t,i=tm(o,r,!0,e)&&i,i=tm(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=tm(o,r,!1,e)&&i}Nt.prototype.N=function(){if(Nt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)hm(n[r]);delete t.g[e],t.h--}}this.J=null};Nt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Nt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function tm(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&t0(t.i,o),i=a.call(u,r)!==!1&&i}}return i&&!r.defaultPrevented}var I0=ee.JSON.stringify,r0=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function r8(){var t=C0;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var i0=class{constructor(){this.h=this.g=null}add(e,n){let r=FO.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},FO=new r0(()=>new s0,t=>t.reset()),s0=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function i8(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function s8(t){ee.setTimeout(()=>{throw t},0)}var pd,gd=!1,C0=new i0,VO=()=>{let t=ee.Promise.resolve(void 0);pd=()=>{t.then(o8)}},o8=()=>{for(var t;t=r8();){try{t.h.call(t.g)}catch(n){s8(n)}var e=FO;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}gd=!1};function pm(t,e){Nt.call(this),this.h=t||1,this.g=e||ee,this.j=Kt(this.qb,this),this.l=Date.now()}Pt(pm,Nt);R=pm.prototype;R.ga=!1;R.T=null;R.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ht(this,"tick"),this.ga&&(D0(this),this.start()))}};R.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function D0(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}R.N=function(){pm.$.N.call(this),D0(this),delete this.g};function T0(t,e,n){if(typeof t=="function")n&&(t=Kt(t,n));else if(t&&typeof t.handleEvent=="function")t=Kt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ee.setTimeout(t,e||0)}function LO(t){t.g=T0(()=>{t.g=null,t.i&&(t.i=!1,LO(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var o0=class extends _s{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:LO(this)}N(){super.N(),this.g&&(ee.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function md(t){_s.call(this),this.h=t,this.g={}}Pt(md,_s);var gO=[];function jO(t,e,n,r){Array.isArray(n)||(n&&(gO[0]=n.toString()),n=gO);for(var i=0;i<n.length;i++){var s=MO(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function UO(t){_0(t.g,function(e,n){this.g.hasOwnProperty(n)&&v0(e)},t),t.g={}}md.prototype.N=function(){md.$.N.call(this),UO(this)};md.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function gm(){this.g=!0}gm.prototype.Ea=function(){this.g=!1};function a8(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function u8(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function yu(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+l8(t,n)+(r?" "+r:"")})}function c8(t,e){t.info(function(){return"TIMEOUT: "+e})}gm.prototype.info=function(){};function l8(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return I0(n)}catch{return e}}var So={},mO=null;function mm(){return mO=mO||new Nt}So.Ta="serverreachability";function BO(t){Qt.call(this,So.Ta,t)}Pt(BO,Qt);function _d(t){let e=mm();Ht(e,new BO(e))}So.STAT_EVENT="statevent";function $O(t,e){Qt.call(this,So.STAT_EVENT,t),this.stat=e}Pt($O,Qt);function on(t){let e=mm();Ht(e,new $O(e,t))}So.Ua="timingevent";function HO(t,e){Qt.call(this,So.Ua,t),this.size=e}Pt(HO,Qt);function Id(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ee.setTimeout(function(){t()},e)}var _m={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},qO={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function b0(){}b0.prototype.h=null;function _O(t){return t.h||(t.h=t.i())}function GO(){}var Cd={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function S0(){Qt.call(this,"d")}Pt(S0,Qt);function A0(){Qt.call(this,"c")}Pt(A0,Qt);var a0;function ym(){}Pt(ym,b0);ym.prototype.g=function(){return new XMLHttpRequest};ym.prototype.i=function(){return{}};a0=new ym;function Dd(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new md(this),this.P=d8,t=XC?125:void 0,this.V=new pm(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new zO}function zO(){this.i=null,this.g="",this.h=!1}var d8=45e3,WO={},u0={};R=Dd.prototype;R.setTimeout=function(t){this.P=t};function c0(t,e,n){t.L=1,t.A=wm(Ai(e)),t.u=n,t.S=!0,KO(t,null)}function KO(t,e){t.G=Date.now(),Td(t),t.B=Ai(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),n1(n.i,"t",r),t.o=0,n=t.l.J,t.h=new zO,t.g=C1(t.l,n?e:null,!t.u),0<t.O&&(t.M=new o0(Kt(t.Pa,t,t.g),t.O)),jO(t.U,t.g,"readystatechange",t.nb),e=t.I?xO(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),_d(),a8(t.j,t.v,t.B,t.m,t.W,t.u)}R.nb=function(t){t=t.target;let e=this.M;e&&Wr(t)==3?e.l():this.Pa(t)};R.Pa=function(t){try{if(t==this.g)e:{let l=Wr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||XC||this.g&&(this.h.h||this.g.ja()||EO(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?_d(3):_d(2)),vm(this);var n=this.g.da();this.ca=n;t:if(QO(this)){var r=EO(this.g);t="";var i=r.length,s=Wr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Do(this),dd(this);var o="";break t}this.h.i=new ee.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,u8(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!hd(a)){var c=a;break t}}c=null}if(n=c)yu(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,l0(this,n);else{this.i=!1,this.s=3,on(12),Do(this),dd(this);break e}}this.S?(YO(this,l,o),XC&&this.i&&l==3&&(jO(this.U,this.V,"tick",this.mb),this.V.start())):(yu(this.j,this.m,o,null),l0(this,o)),l==4&&Do(this),this.i&&!this.J&&(l==4?v1(this.l,this):(this.i=!1,Td(this)))}else N8(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,on(12)):(this.s=0,on(13)),Do(this),dd(this)}}}catch{}finally{}};function QO(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function YO(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=h8(t,n),i==u0){e==4&&(t.s=4,on(14),r=!1),yu(t.j,t.m,null,"[Incomplete Response]");break}else if(i==WO){t.s=4,on(15),yu(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else yu(t.j,t.m,i,null),l0(t,i);QO(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,on(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),k0(e),e.M=!0,on(11))):(yu(t.j,t.m,n,"[Invalid Chunked Response]"),Do(t),dd(t))}R.mb=function(){if(this.g){var t=Wr(this.g),e=this.g.ja();this.o<e.length&&(vm(this),YO(this,t,e),this.i&&t!=4&&Td(this))}};function h8(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?u0:(n=Number(e.substring(n,r)),isNaN(n)?WO:(r+=1,r+n>e.length?u0:(e=e.slice(r,r+n),t.o=r+n,e)))}R.cancel=function(){this.J=!0,Do(this)};function Td(t){t.Y=Date.now()+t.P,ZO(t,t.P)}function ZO(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Id(Kt(t.lb,t),e)}function vm(t){t.C&&(ee.clearTimeout(t.C),t.C=null)}R.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(c8(this.j,this.B),this.L!=2&&(_d(),on(17)),Do(this),this.s=2,dd(this)):ZO(this,this.Y-t)};function dd(t){t.l.H==0||t.J||v1(t.l,t)}function Do(t){vm(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,D0(t.V),UO(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function l0(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||d0(n.i,t))){if(!t.K&&d0(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)om(n),Cm(n);else break e;P0(n),on(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Id(Kt(n.ib,n),6e3));if(1>=s1(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else To(n,11)}else if((t.K||n.g==t)&&om(n),!hd(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let l=c[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(x0(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Ue(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=I1(r,r.J?r.pa:null,r.Y),o.K){o1(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(vm(a),Td(a)),r.g=o}else _1(r);0<n.j.length&&Dm(n)}else c[0]!="stop"&&c[0]!="close"||To(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?To(n,7):N0(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}_d(4)}catch{}}function f8(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(lm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function p8(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(lm(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function XO(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(lm(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=p8(t),r=f8(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var JO=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function g8(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function bo(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof bo){this.h=t.h,im(this,t.j),this.s=t.s,this.g=t.g,sm(this,t.m),this.l=t.l;var e=t.i,n=new yd;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),yO(this,n),this.o=t.o}else t&&(e=String(t).match(JO))?(this.h=!1,im(this,e[1]||"",!0),this.s=cd(e[2]||""),this.g=cd(e[3]||"",!0),sm(this,e[4]),this.l=cd(e[5]||"",!0),yO(this,e[6]||"",!0),this.o=cd(e[7]||"")):(this.h=!1,this.i=new yd(null,this.h))}bo.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ld(e,vO,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(ld(e,vO,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(ld(n,n.charAt(0)=="/"?y8:_8,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ld(n,w8)),t.join("")};function Ai(t){return new bo(t)}function im(t,e,n){t.j=n?cd(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function sm(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function yO(t,e,n){e instanceof yd?(t.i=e,E8(t.i,t.h)):(n||(e=ld(e,v8)),t.i=new yd(e,t.h))}function Ue(t,e,n){t.i.set(e,n)}function wm(t){return Ue(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function cd(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ld(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,m8),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function m8(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var vO=/[#\/\?@]/g,_8=/[#\?:]/g,y8=/[#\?]/g,v8=/[#\?@]/g,w8=/#/g;function yd(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ys(t){t.g||(t.g=new Map,t.h=0,t.i&&g8(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}R=yd.prototype;R.add=function(t,e){ys(this),this.i=null,t=Eu(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function e1(t,e){ys(t),e=Eu(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function t1(t,e){return ys(t),e=Eu(t,e),t.g.has(e)}R.forEach=function(t,e){ys(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};R.ta=function(){ys(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};R.Z=function(t){ys(this);let e=[];if(typeof t=="string")t1(this,t)&&(e=e.concat(this.g.get(Eu(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};R.set=function(t,e){return ys(this),this.i=null,t=Eu(this,t),t1(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};R.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function n1(t,e,n){e1(t,e),0<n.length&&(t.i=null,t.g.set(Eu(t,e),g0(n)),t.h+=n.length)}R.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Eu(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function E8(t,e){e&&!t.j&&(ys(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(e1(this,r),n1(this,i,n))},t)),t.j=e}var I8=class{constructor(t,e){this.g=t,this.map=e}};function r1(t){this.l=t||C8,ee.PerformanceNavigationTiming?(t=ee.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ee.g&&ee.g.Ka&&ee.g.Ka()&&ee.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var C8=10;function i1(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function s1(t){return t.h?1:t.g?t.g.size:0}function d0(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function x0(t,e){t.g?t.g.add(e):t.h=e}function o1(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}r1.prototype.cancel=function(){if(this.i=a1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function a1(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return g0(t.i)}var D8=class{stringify(t){return ee.JSON.stringify(t,void 0)}parse(t){return ee.JSON.parse(t,void 0)}};function T8(){this.g=new D8}function b8(t,e,n){let r=n||"";try{XO(t,function(i,s){let o=i;wd(i)&&(o=I0(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function S8(t,e){let n=new gm;if(ee.Image){let r=new Image;r.onload=Zg(nm,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Zg(nm,n,r,"TestLoadImage: error",!1,e),r.onabort=Zg(nm,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Zg(nm,n,r,"TestLoadImage: timeout",!1,e),ee.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function nm(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function bd(t){this.l=t.ec||null,this.j=t.ob||!1}Pt(bd,b0);bd.prototype.g=function(){return new Em(this.l,this.j)};bd.prototype.i=function(t){return function(){return t}}({});function Em(t,e){Nt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=R0,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Pt(Em,Nt);var R0=0;R=Em.prototype;R.open=function(t,e){if(this.readyState!=R0)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,vd(this)};R.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ee).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};R.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Sd(this)),this.readyState=R0};R.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,vd(this)),this.g&&(this.readyState=3,vd(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ee.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;u1(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function u1(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}R.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Sd(this):vd(this),this.readyState==3&&u1(this)}};R.Za=function(t){this.g&&(this.response=this.responseText=t,Sd(this))};R.Ya=function(t){this.g&&(this.response=t,Sd(this))};R.ka=function(){this.g&&Sd(this)};function Sd(t){t.readyState=4,t.l=null,t.j=null,t.A=null,vd(t)}R.setRequestHeader=function(t,e){this.v.append(t,e)};R.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};R.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function vd(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Em.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var A8=ee.JSON.parse;function tt(t){Nt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=c1,this.L=this.M=!1}Pt(tt,Nt);var c1="",x8=/^https?$/i,R8=["POST","PUT"];R=tt.prototype;R.Oa=function(t){this.M=t};R.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():a0.g(),this.C=this.u?_O(this.u):_O(a0),this.g.onreadystatechange=Kt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){wO(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=ee.FormData&&t instanceof ee.FormData,!(0<=TO(R8,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{h1(this),0<this.B&&((this.L=M8(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Kt(this.ua,this)):this.A=T0(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){wO(this,s)}};function M8(t){return wu&&typeof t.timeout=="number"&&t.ontimeout!==void 0}R.ua=function(){typeof p0<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ht(this,"timeout"),this.abort(8))};function wO(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,l1(t),Im(t)}function l1(t){t.F||(t.F=!0,Ht(t,"complete"),Ht(t,"error"))}R.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ht(this,"complete"),Ht(this,"abort"),Im(this))};R.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Im(this,!0)),tt.$.N.call(this)};R.La=function(){this.s||(this.G||this.v||this.l?d1(this):this.kb())};R.kb=function(){d1(this)};function d1(t){if(t.h&&typeof p0<"u"&&(!t.C[1]||Wr(t)!=4||t.da()!=2)){if(t.v&&Wr(t)==4)T0(t.La,0,t);else if(Ht(t,"readystatechange"),Wr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(JO)[1]||null;!i&&ee.self&&ee.self.location&&(i=ee.self.location.protocol.slice(0,-1)),r=!x8.test(i?i.toLowerCase():"")}n=r}if(n)Ht(t,"complete"),Ht(t,"success");else{t.m=6;try{var s=2<Wr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",l1(t)}}finally{Im(t)}}}}function Im(t,e){if(t.g){h1(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Ht(t,"ready");try{n.onreadystatechange=r}catch{}}}function h1(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ee.clearTimeout(t.A),t.A=null)}R.isActive=function(){return!!this.g};function Wr(t){return t.g?t.g.readyState:0}R.da=function(){try{return 2<Wr(this)?this.g.status:-1}catch{return-1}};R.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};R.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),A8(e)}};function EO(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case c1:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function N8(t){let e={};t=(t.g&&2<=Wr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(hd(t[r]))continue;var n=i8(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}e8(e,function(r){return r.join(", ")})}R.Ia=function(){return this.m};R.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function f1(t){let e="";return _0(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function M0(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=f1(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ue(t,e,n))}function ad(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function p1(t){this.Ga=0,this.j=[],this.l=new gm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ad("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ad("baseRetryDelayMs",5e3,t),this.hb=ad("retryDelaySeedMs",1e4,t),this.eb=ad("forwardChannelMaxRetries",2,t),this.xa=ad("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new r1(t&&t.concurrentRequestLimit),this.Ja=new T8,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}R=p1.prototype;R.ra=8;R.H=1;function N0(t){if(g1(t),t.H==3){var e=t.W++,n=Ai(t.I);if(Ue(n,"SID",t.K),Ue(n,"RID",e),Ue(n,"TYPE","terminate"),Ad(t,n),e=new Dd(t,t.l,e),e.L=2,e.A=wm(Ai(n)),n=!1,ee.navigator&&ee.navigator.sendBeacon)try{n=ee.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&ee.Image&&(new Image().src=e.A,n=!0),n||(e.g=C1(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Td(e)}E1(t)}function Cm(t){t.g&&(k0(t),t.g.cancel(),t.g=null)}function g1(t){Cm(t),t.u&&(ee.clearTimeout(t.u),t.u=null),om(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ee.clearTimeout(t.m),t.m=null)}function Dm(t){if(!i1(t.i)&&!t.m){t.m=!0;var e=t.Na;pd||VO(),gd||(pd(),gd=!0),C0.add(e,t),t.C=0}}function P8(t,e){return s1(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Id(Kt(t.Na,t,e),w1(t,t.C)),t.C++,!0)}R.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Dd(this,this.l,t),s=this.s;if(this.U&&(s?(s=xO(s),RO(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=m1(this,i,e),n=Ai(this.I),Ue(n,"RID",t),Ue(n,"CVER",22),this.F&&Ue(n,"X-HTTP-Session-Id",this.F),Ad(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(f1(s)))+"&"+e:this.o&&M0(n,this.o,s)),x0(this.i,i),this.bb&&Ue(n,"TYPE","init"),this.P?(Ue(n,"$req",e),Ue(n,"SID","null"),i.aa=!0,c0(i,n,null)):c0(i,n,e),this.H=2}}else this.H==3&&(t?IO(this,t):this.j.length==0||i1(this.i)||IO(this))};function IO(t,e){var n;e?n=e.m:n=t.W++;let r=Ai(t.I);Ue(r,"SID",t.K),Ue(r,"RID",n),Ue(r,"AID",t.V),Ad(t,r),t.o&&t.s&&M0(r,t.o,t.s),n=new Dd(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=m1(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),x0(t.i,n),c0(n,r,e)}function Ad(t,e){t.na&&_0(t.na,function(n,r){Ue(e,r,n)}),t.h&&XO({},function(n,r){Ue(e,r,n)})}function m1(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Kt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].g,l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{b8(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function _1(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;pd||VO(),gd||(pd(),gd=!0),C0.add(e,t),t.A=0}}function P0(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Id(Kt(t.Ma,t),w1(t,t.A)),t.A++,!0)}R.Ma=function(){if(this.u=null,y1(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Id(Kt(this.jb,this),t)}};R.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,on(10),Cm(this),y1(this))};function k0(t){t.B!=null&&(ee.clearTimeout(t.B),t.B=null)}function y1(t){t.g=new Dd(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Ai(t.wa);Ue(e,"RID","rpc"),Ue(e,"SID",t.K),Ue(e,"AID",t.V),Ue(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Ue(e,"TO",t.qa),Ue(e,"TYPE","xmlhttp"),Ad(t,e),t.o&&t.s&&M0(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=wm(Ai(e)),n.u=null,n.S=!0,KO(n,t)}R.ib=function(){this.v!=null&&(this.v=null,Cm(this),P0(this),on(19))};function om(t){t.v!=null&&(ee.clearTimeout(t.v),t.v=null)}function v1(t,e){var n=null;if(t.g==e){om(t),k0(t),t.g=null;var r=2}else if(d0(t.i,e))n=e.F,o1(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=mm(),Ht(r,new HO(r,n)),Dm(t)}else _1(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&P8(t,e)||r==2&&P0(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:To(t,5);break;case 4:To(t,10);break;case 3:To(t,6);break;default:To(t,2)}}}function w1(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function To(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Kt(t.pb,t);n||(n=new bo("//www.google.com/images/cleardot.gif"),ee.location&&ee.location.protocol=="http"||im(n,"https"),wm(n)),S8(n.toString(),r)}else on(2);t.H=0,t.h&&t.h.za(e),E1(t),g1(t)}R.pb=function(t){t?(this.l.info("Successfully pinged google.com"),on(2)):(this.l.info("Failed to ping google.com"),on(1))};function E1(t){if(t.H=0,t.ma=[],t.h){let e=a1(t.i);(e.length!=0||t.j.length!=0)&&(fO(t.ma,e),fO(t.ma,t.j),t.i.i.length=0,g0(t.j),t.j.length=0),t.h.ya()}}function I1(t,e,n){var r=n instanceof bo?Ai(n):new bo(n);if(r.g!="")e&&(r.g=e+"."+r.g),sm(r,r.m);else{var i=ee.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new bo(null);r&&im(s,r),e&&(s.g=e),i&&sm(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Ue(r,n,e),Ue(r,"VER",t.ra),Ad(t,r),r}function C1(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new tt(new bd({ob:n})):new tt(t.va),e.Oa(t.J),e}R.isActive=function(){return!!this.h&&this.h.isActive(this)};function D1(){}R=D1.prototype;R.Ba=function(){};R.Aa=function(){};R.za=function(){};R.ya=function(){};R.isActive=function(){return!0};R.Va=function(){};function am(){if(wu&&!(10<=Number(YW)))throw Error("Environmental error: no available transport.")}am.prototype.g=function(t,e){return new Mn(t,e)};function Mn(t,e){Nt.call(this),this.g=new p1(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!hd(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!hd(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Iu(this)}Pt(Mn,Nt);Mn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;on(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=I1(t,null,t.Y),Dm(t)};Mn.prototype.close=function(){N0(this.g)};Mn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=I0(t),t=n);e.j.push(new I8(e.fb++,t)),e.H==3&&Dm(e)};Mn.prototype.N=function(){this.g.h=null,delete this.j,N0(this.g),delete this.g,Mn.$.N.call(this)};function T1(t){S0.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Pt(T1,S0);function b1(){A0.call(this),this.status=1}Pt(b1,A0);function Iu(t){this.g=t}Pt(Iu,D1);Iu.prototype.Ba=function(){Ht(this.g,"a")};Iu.prototype.Aa=function(t){Ht(this.g,new T1(t))};Iu.prototype.za=function(t){Ht(this.g,new b1)};Iu.prototype.ya=function(){Ht(this.g,"b")};function k8(){this.blockSize=-1}function pr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Pt(pr,k8);pr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function ZC(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}pr.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)ZC(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){ZC(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){ZC(this,r),i=0;break}}this.h=i,this.i+=e};pr.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Se(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var O8={};function O0(t){return-128<=t&&128>t?WW(t,function(e){return new Se([e|0],0>e?-1:0)}):new Se([t|0],0>t?-1:0)}function Kr(t){if(isNaN(t)||!isFinite(t))return vu;if(0>t)return $t(Kr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=h0;return new Se(e,0)}function S1(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return $t(S1(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Kr(Math.pow(e,8)),r=vu,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Kr(Math.pow(e,s)),r=r.R(s).add(Kr(o))):(r=r.R(n),r=r.add(Kr(o)))}return r}var h0=4294967296,vu=O0(0),f0=O0(1),CO=O0(16777216);R=Se.prototype;R.ea=function(){if(Kn(this))return-$t(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:h0+r)*e,e*=h0}return t};R.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Si(this))return"0";if(Kn(this))return"-"+$t(this).toString(t);for(var e=Kr(Math.pow(t,6)),n=this,r="";;){var i=cm(n,e).g;n=um(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Si(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};R.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Si(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Kn(t){return t.h==-1}R.X=function(t){return t=um(this,t),Kn(t)?-1:Si(t)?0:1};function $t(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Se(n,~t.h).add(f0)}R.abs=function(){return Kn(this)?$t(this):this};R.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Se(n,n[n.length-1]&-2147483648?-1:0)};function um(t,e){return t.add($t(e))}R.R=function(t){if(Si(this)||Si(t))return vu;if(Kn(this))return Kn(t)?$t(this).R($t(t)):$t($t(this).R(t));if(Kn(t))return $t(this.R($t(t)));if(0>this.X(CO)&&0>t.X(CO))return Kr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,u=t.D(i)&65535;n[2*r+2*i]+=o*u,rm(n,2*r+2*i),n[2*r+2*i+1]+=s*u,rm(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,rm(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,rm(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Se(n,0)};function rm(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function ud(t,e){this.g=t,this.h=e}function cm(t,e){if(Si(e))throw Error("division by zero");if(Si(t))return new ud(vu,vu);if(Kn(t))return e=cm($t(t),e),new ud($t(e.g),$t(e.h));if(Kn(e))return e=cm(t,$t(e)),new ud($t(e.g),e.h);if(30<t.g.length){if(Kn(t)||Kn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=f0,r=e;0>=r.X(t);)n=DO(n),r=DO(r);var i=_u(n,1),s=_u(r,1);for(r=_u(r,2),n=_u(n,2);!Si(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=_u(r,1),n=_u(n,1)}return e=um(t,i.R(e)),new ud(i,e)}for(i=vu;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Kr(n),o=s.R(e);Kn(o)||0<o.X(t);)n-=r,s=Kr(n),o=s.R(e);Si(s)&&(s=f0),i=i.add(s),t=um(t,o)}return new ud(i,t)}R.gb=function(t){return cm(this,t).h};R.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Se(n,this.h&t.h)};R.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Se(n,this.h|t.h)};R.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Se(n,this.h^t.h)};function DO(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Se(n,t.h)}function _u(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Se(i,t.h)}am.prototype.createWebChannel=am.prototype.g;Mn.prototype.send=Mn.prototype.u;Mn.prototype.open=Mn.prototype.m;Mn.prototype.close=Mn.prototype.close;_m.NO_ERROR=0;_m.TIMEOUT=8;_m.HTTP_ERROR=6;qO.COMPLETE="complete";GO.EventType=Cd;Cd.OPEN="a";Cd.CLOSE="b";Cd.ERROR="c";Cd.MESSAGE="d";Nt.prototype.listen=Nt.prototype.O;tt.prototype.listenOnce=tt.prototype.P;tt.prototype.getLastError=tt.prototype.Sa;tt.prototype.getLastErrorCode=tt.prototype.Ia;tt.prototype.getStatus=tt.prototype.da;tt.prototype.getResponseJson=tt.prototype.Wa;tt.prototype.getResponseText=tt.prototype.ja;tt.prototype.send=tt.prototype.ha;tt.prototype.setWithCredentials=tt.prototype.Oa;pr.prototype.digest=pr.prototype.l;pr.prototype.reset=pr.prototype.reset;pr.prototype.update=pr.prototype.j;Se.prototype.add=Se.prototype.add;Se.prototype.multiply=Se.prototype.R;Se.prototype.modulo=Se.prototype.gb;Se.prototype.compare=Se.prototype.X;Se.prototype.toNumber=Se.prototype.ea;Se.prototype.toString=Se.prototype.toString;Se.prototype.getBits=Se.prototype.D;Se.fromNumber=Kr;Se.fromString=S1;var A1=gr.createWebChannelTransport=function(){return new am},x1=gr.getStatEventTarget=function(){return mm()},Tm=gr.ErrorCode=_m,R1=gr.EventType=qO,M1=gr.Event=So,F0=gr.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},$oe=gr.FetchXmlHttpFactory=bd,xd=gr.WebChannel=GO,N1=gr.XhrIo=tt,P1=gr.Md5=pr,Ao=gr.Integer=Se;var k1="@firebase/firestore";var mt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};mt.UNAUTHENTICATED=new mt(null),mt.GOOGLE_CREDENTIALS=new mt("google-credentials-uid"),mt.FIRST_PARTY=new mt("first-party-uid"),mt.MOCK_USER=new mt("mock-user");var Xu="10.8.0";var Ts=new ji("@firebase/firestore");function Su(){return Ts.logLevel}function PF(t){Ts.setLogLevel(t)}function C(t,...e){if(Ts.logLevel<=Fn.DEBUG){let n=e.map(LT);Ts.debug(`Firestore (${Xu}): ${t}`,...n)}}function at(t,...e){if(Ts.logLevel<=Fn.ERROR){let n=e.map(LT);Ts.error(`Firestore (${Xu}): ${t}`,...n)}}function Yn(t,...e){if(Ts.logLevel<=Fn.WARN){let n=e.map(LT);Ts.warn(`Firestore (${Xu}): ${t}`,...n)}}function LT(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function F(t="Unexpected state"){let e=`FIRESTORE (${Xu}) INTERNAL ASSERTION FAILED: `+t;throw at(e),new Error(e)}function $(t,e){t||F()}function kF(t,e){t||F()}function M(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},E=class extends bh{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var _t=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Fm=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},B0=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(mt.UNAUTHENTICATED))}shutdown(){}},$0=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},H0=class{constructor(e){this.t=e,this.currentUser=mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new _t;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new _t,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>v(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new _t)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($(typeof r.accessToken=="string"),new Fm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return $(e===null||typeof e=="string"),new mt(e)}},q0=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=mt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},G0=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new q0(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},z0=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},W0=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,C("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?($(typeof n.token=="string"),this.R=n.token,new z0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function F8(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Vm=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=F8(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function re(t,e){return t<e?-1:t>e?1:0}function Fu(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function OF(t){return t+"\0"}var Ze=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new E(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new E(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new E(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new E(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?re(this.nanoseconds,e.nanoseconds):re(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var G=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Ze(0,0))}static max(){return new t(new Ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Lm=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&F(),r===void 0?r=e.length-n:r>e.length-n&&F(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},ye=class t extends Lm{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new E(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},V8=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ut=class t extends Lm{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return V8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new E(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new E(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new E(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new E(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var x=class t{constructor(e){this.path=e}static fromPath(e){return new t(ye.fromString(e))}static fromName(e){return new t(ye.fromString(e).popFirst(5))}static empty(){return new t(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ye.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new ye(e.slice()))}};var Vu=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function K0(t){return t.fields.find(e=>e.kind===2)}function Ro(t){return t.fields.filter(e=>e.kind!==2)}Vu.UNKNOWN_ID=-1;var Pu=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Bd=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Zn.min())}};function FF(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=G.fromTimestamp(r===1e9?new Ze(n+1,0):new Ze(n,r));return new Zn(i,x.empty(),e)}function VF(t){return new Zn(t.readTime,t.key,-1)}var Zn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(G.min(),x.empty(),-1)}static max(){return new t(G.max(),x.empty(),-1)}};function jT(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=x.comparator(t.documentKey,e.documentKey),n!==0?n:re(t.largestBatchId,e.largestBatchId))}var LF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",jm=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Os(t){return v(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==LF)throw t;C("LocalStore","Unexpectedly lost primary lease")})}var _=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&F(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Um=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new _t,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Fo(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=UT(r.target.error);this.V.reject(new Fo(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Fo(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(C("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new Y0(n)}},Mi=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(mc())===12.2&&at("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return C("SimpleDb","Removing database:",e),Mo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Th())return!1;if(t.C())return!0;let e=mc(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return v(this,null,function*(){return this.db||(C("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Fo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new E(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new E(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Fo(e,o))},i.onupgradeneeded=s=>{C("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{C("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return v(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Um.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),_.reject(c))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,c=u.name!=="FirebaseError"&&o<3;if(C("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}},Q0=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Mo(this.k.delete())}},Fo=class extends E{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function Fs(t){return t.name==="IndexedDbTransactionError"}var Y0=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(C("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(C("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Mo(r)}add(e){return C("SimpleDb","ADD",this.store.name,e,e),Mo(this.store.add(e))}get(e){return Mo(this.store.get(e)).next(n=>(n===void 0&&(n=null),C("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return C("SimpleDb","DELETE",this.store.name,e),Mo(this.store.delete(e))}count(){return C("SimpleDb","COUNT",this.store.name),Mo(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new _((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,u)=>{o.push(u)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new _((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){C("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new _((r,i)=>{n.onerror=s=>{let o=UT(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new _((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new Q0(a),c=n(a.primaryKey,a.value,u);if(c instanceof _){let l=c.catch(d=>(u.done(),_.reject(d)));r.push(l)}u.isDone?i():u.$===null?a.continue():a.continue(u.$)}}).next(()=>_.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function Mo(t){return new _((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=UT(r.target.error);n(i)}})}var O1=!1;function UT(t){let e=Mi.S(mc());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new E("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return O1||(O1=!0,setTimeout(()=>{throw r},0)),r}}return t}var Z0=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){C("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>v(this,null,function*(){this.task=null;try{C("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){Fs(n)?C("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Os(n)}yield this.ee(6e4)}))}},X0=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return v(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return _.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return C("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(C("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=VF(s);jT(o,r)>0&&(r=o)}),new Zn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var Nn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function lh(t){return t==null}function $d(t){return t===0&&1/t==-1/0}function jF(t){return typeof t=="number"&&Number.isInteger(t)&&!$d(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function an(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=F1(e)),e=L8(t.get(n),e);return F1(e)}function L8(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function F1(t){return t+""}function Qr(t){let e=t.length;if($(e>=2),e===2)return $(t.charAt(0)===""&&t.charAt(1)===""),ye.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&F(),t.charAt(o+1)){case"":let a=t.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:F()}s=o+2}return new ye(r)}var V1=["userId","batchId"];function Rm(t,e){return[t,an(e)]}function UF(t,e,n){return[t,an(e),n]}var j8={},U8=["prefixPath","collectionGroup","readTime","documentId"],B8=["prefixPath","collectionGroup","documentId"],$8=["collectionGroup","readTime","prefixPath","documentId"],H8=["canonicalId","targetId"],q8=["targetId","path"],G8=["path","targetId"],z8=["collectionId","parent"],W8=["indexId","uid"],K8=["uid","sequenceNumber"],Q8=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Y8=["indexId","uid","orderedDocumentKey"],Z8=["userId","collectionPath","documentId"],X8=["userId","collectionPath","largestBatchId"],J8=["userId","collectionGroup","largestBatchId"],BF=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],eK=[...BF,"documentOverlays"],$F=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],HF=$F,tK=[...HF,"indexConfiguration","indexState","indexEntries"];var Hd=class extends jm{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function Ot(t,e){let n=M(t);return Mi.M(n.ae,e)}function L1(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ko(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function qF(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Be=class t{constructor(e,n){this.comparator=e,this.root=n||Zr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Zr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Nu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Nu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Nu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Nu(this.root,e,this.comparator,!0)}},Nu=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Zr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw F();let e=this.left.check();if(e!==this.right.check())throw F();return e+(this.isRed()?0:1)}};Zr.EMPTY=null,Zr.RED=!0,Zr.BLACK=!1;Zr.EMPTY=new class{constructor(){this.size=0}get key(){throw F()}get value(){throw F()}get color(){throw F()}get left(){throw F()}get right(){throw F()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Zr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Fe=class t{constructor(e){this.comparator=e,this.data=new Be(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Bm(this.data.getIterator())}getIteratorFrom(e){return new Bm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Bm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Cu(t){return t.hasNext()?t.getNext():void 0}var Pn=class t{constructor(e){this.fields=e,e.sort(ut.comparator)}static empty(){return new t([])}unionWith(e){let n=new Fe(ut.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Fu(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var $m=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function GF(){return typeof atob<"u"}var kt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new $m("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return re(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};kt.EMPTY_BYTE_STRING=new kt("");var nK=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bs(t){if($(!!t),typeof t=="string"){let e=0,n=nK.exec(t);if($(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ss(t){return typeof t=="string"?kt.fromBase64String(t):kt.fromUint8Array(t)}function N_(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function BT(t){let e=t.mapValue.fields.__previous_value__;return N_(e)?BT(e):e}function qd(t){let e=bs(t.mapValue.fields.__local_write_time__.timestampValue);return new Ze(e.seconds,e.nanos)}var J0=class{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}},As=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Cs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Mm={nullValue:"NULL_VALUE"};function Vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?N_(t)?4:zF(t)?9007199254740991:10:F()}function ei(t,e){if(t===e)return!0;let n=Vo(t);if(n!==Vo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return qd(t).isEqual(qd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=bs(i.timestampValue),a=bs(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ss(i.bytesValue).isEqual(Ss(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return nt(i.geoPointValue.latitude)===nt(s.geoPointValue.latitude)&&nt(i.geoPointValue.longitude)===nt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return nt(i.integerValue)===nt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=nt(i.doubleValue),a=nt(s.doubleValue);return o===a?$d(o)===$d(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Fu(t.arrayValue.values||[],e.arrayValue.values||[],ei);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(L1(o)!==L1(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!ei(o[u],a[u])))return!1;return!0}(t,e);default:return F()}}function Gd(t,e){return(t.values||[]).find(n=>ei(n,e))!==void 0}function xs(t,e){if(t===e)return 0;let n=Vo(t),r=Vo(e);if(n!==r)return re(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return re(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=nt(s.integerValue||s.doubleValue),u=nt(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return j1(t.timestampValue,e.timestampValue);case 4:return j1(qd(t),qd(e));case 5:return re(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Ss(s),u=Ss(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){let l=re(a[c],u[c]);if(l!==0)return l}return re(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=re(nt(s.latitude),nt(o.latitude));return a!==0?a:re(nt(s.longitude),nt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){let l=xs(a[c],u[c]);if(l)return l}return re(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Cs.mapValue&&o===Cs.mapValue)return 0;if(s===Cs.mapValue)return 1;if(o===Cs.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let d=0;d<u.length&&d<l.length;++d){let h=re(u[d],l[d]);if(h!==0)return h;let f=xs(a[u[d]],c[l[d]]);if(f!==0)return f}return re(u.length,l.length)}(t.mapValue,e.mapValue);default:throw F()}}function j1(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return re(t,e);let n=bs(t),r=bs(e),i=re(n.seconds,r.seconds);return i!==0?i:re(n.nanos,r.nanos)}function Lu(t){return eD(t)}function eD(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=bs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ss(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return x.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=eD(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${eD(n.fields[o])}`;return i+"}"}(t.mapValue):F()}function Lo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function tD(t){return!!t&&"integerValue"in t}function zd(t){return!!t&&"arrayValue"in t}function U1(t){return!!t&&"nullValue"in t}function B1(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Nm(t){return!!t&&"mapValue"in t}function Fd(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Ko(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Fd(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fd(t.arrayValue.values[n]);return e}return Object.assign({},t)}function zF(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function rK(t){return"nullValue"in t?Mm:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Lo(As.empty(),x.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:F()}function iK(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Lo(As.empty(),x.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Cs:F()}function $1(t,e){let n=xs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function H1(t,e){let n=xs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Zt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Nm(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fd(n)}setAll(e){let n=ut.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Fd(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Nm(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ei(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Nm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ko(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Fd(this.value))}};function WF(t){let e=[];return Ko(t.fields,(n,r)=>{let i=new ut([n]);if(Nm(r)){let s=WF(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Pn(e)}var yt=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,G.min(),G.min(),G.min(),Zt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,G.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,G.min(),G.min(),Zt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,G.min(),G.min(),Zt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(G.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=G.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var ti=class{constructor(e,n){this.position=e,this.inclusive=n}};function q1(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=x.comparator(x.fromName(o.referenceValue),n.key):r=xs(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function G1(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ei(t.position[n],e.position[n]))return!1;return!0}var jo=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function sK(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Hm=class{},me=class t extends Hm{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new iD(e,n,r):n==="array-contains"?new aD(e,r):n==="in"?new qm(e,r):n==="not-in"?new uD(e,r):n==="array-contains-any"?new cD(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new sD(e,r):new oD(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(xs(n,this.value)):n!==null&&Vo(this.value)===Vo(n)&&this.matchesComparison(xs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return F()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ae=class t extends Hm{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return ju(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function ju(t){return t.op==="and"}function nD(t){return t.op==="or"}function $T(t){return KF(t)&&ju(t)}function KF(t){for(let e of t.filters)if(e instanceof Ae)return!1;return!0}function rD(t){if(t instanceof me)return t.field.canonicalString()+t.op.toString()+Lu(t.value);if($T(t))return t.filters.map(e=>rD(e)).join(",");{let e=t.filters.map(n=>rD(n)).join(",");return`${t.op}(${e})`}}function QF(t,e){return t instanceof me?function(r,i){return i instanceof me&&r.op===i.op&&r.field.isEqual(i.field)&&ei(r.value,i.value)}(t,e):t instanceof Ae?function(r,i){return i instanceof Ae&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&QF(o,i.filters[a]),!0):!1}(t,e):void F()}function YF(t,e){let n=t.filters.concat(e);return Ae.create(n,t.op)}function ZF(t){return t instanceof me?function(n){return`${n.field.canonicalString()} ${n.op} ${Lu(n.value)}`}(t):t instanceof Ae?function(n){return n.op.toString()+" {"+n.getFilters().map(ZF).join(" ,")+"}"}(t):"Filter"}var iD=class extends me{constructor(e,n,r){super(e,n,r),this.key=x.fromName(r.referenceValue)}matches(e){let n=x.comparator(e.key,this.key);return this.matchesComparison(n)}},sD=class extends me{constructor(e,n){super(e,"in",n),this.keys=XF("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},oD=class extends me{constructor(e,n){super(e,"not-in",n),this.keys=XF("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function XF(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>x.fromName(r.referenceValue))}var aD=class extends me{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return zd(n)&&Gd(n.arrayValue,this.value)}},qm=class extends me{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&Gd(this.value.arrayValue,n)}},uD=class extends me{constructor(e,n){super(e,"not-in",n)}matches(e){if(Gd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!Gd(this.value.arrayValue,n)}},cD=class extends me{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!zd(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Gd(this.value.arrayValue,r))}};var lD=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function dD(t,e=null,n=[],r=[],i=null,s=null,o=null){return new lD(t,e,n,r,i,s,o)}function Uo(t){let e=M(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>rD(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),lh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Lu(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Lu(r)).join(",")),e.ce=n}return e.ce}function dh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!sK(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!QF(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!G1(t.startAt,e.startAt)&&G1(t.endAt,e.endAt)}function Gm(t){return x.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function zm(t,e){return t.filters.filter(n=>n instanceof me&&n.field.isEqual(e))}function z1(t,e,n){let r=Mm,i=!0;for(let s of zm(t,e)){let o=Mm,a=!0;switch(s.op){case"<":case"<=":o=rK(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Mm}$1({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];$1({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function W1(t,e,n){let r=Cs,i=!0;for(let s of zm(t,e)){let o=Cs,a=!0;switch(s.op){case">=":case">":o=iK(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Cs}H1({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];H1({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var mr=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function JF(t,e,n,r,i,s,o,a){return new mr(t,e,n,r,i,s,o,a)}function Ju(t){return new mr(t)}function K1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function HT(t){return t.collectionGroup!==null}function ku(t){let e=M(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Fe(ut.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new jo(s,r))}),n.has(ut.keyField().canonicalString())||e.le.push(new jo(ut.keyField(),r))}return e.le}function un(t){let e=M(t);return e.he||(e.he=oK(e,ku(t))),e.he}function oK(t,e){if(t.limitType==="F")return dD(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new jo(i.field,s)});let n=t.endAt?new ti(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ti(t.startAt.position,t.startAt.inclusive):null;return dD(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function hD(t,e){let n=t.filters.concat([e]);return new mr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Wm(t,e,n){return new mr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function hh(t,e){return dh(un(t),un(e))&&t.limitType===e.limitType}function eV(t){return`${Uo(un(t))}|lt:${t.limitType}`}function Au(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>ZF(i)).join(", ")}]`),lh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Lu(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Lu(i)).join(",")),`Target(${r})`}(un(t))}; limitType=${t.limitType})`}function fh(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):x.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of ku(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let c=q1(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,ku(r),i)||r.endAt&&!function(o,a,u){let c=q1(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,ku(r),i))}(t,e)}function tV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function nV(t){return(e,n)=>{let r=!1;for(let i of ku(t)){let s=aK(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function aK(t,e,n){let r=t.field.isKeyField()?x.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?xs(u,c):F()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return F()}}var ni=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ko(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return qF(this.inner)}size(){return this.innerSize}};var uK=new Be(x.comparator);function yn(){return uK}var rV=new Be(x.comparator);function kd(...t){let e=rV;for(let n of t)e=e.insert(n.key,n);return e}function iV(t){let e=rV;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Yr(){return Vd()}function sV(){return Vd()}function Vd(){return new ni(t=>t.toString(),(t,e)=>t.isEqual(e))}var cK=new Be(x.comparator),lK=new Fe(x.comparator);function ie(...t){let e=lK;for(let n of t)e=e.add(n);return e}var dK=new Fe(re);function qT(){return dK}function oV(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$d(e)?"-0":e}}function aV(t){return{integerValue:""+t}}function uV(t,e){return jF(e)?aV(e):oV(t,e)}var Uu=class{constructor(){this._=void 0}};function hK(t,e,n){return t instanceof Rs?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&N_(s)&&(s=BT(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Ni?lV(t,e):t instanceof Pi?dV(t,e):function(i,s){let o=cV(i,s),a=Q1(o)+Q1(i.Ie);return tD(o)&&tD(i.Ie)?aV(a):oV(i.serializer,a)}(t,e)}function fK(t,e,n){return t instanceof Ni?lV(t,e):t instanceof Pi?dV(t,e):n}function cV(t,e){return t instanceof Ms?function(r){return tD(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Rs=class extends Uu{},Ni=class extends Uu{constructor(e){super(),this.elements=e}};function lV(t,e){let n=hV(e);for(let r of t.elements)n.some(i=>ei(i,r))||n.push(r);return{arrayValue:{values:n}}}var Pi=class extends Uu{constructor(e){super(),this.elements=e}};function dV(t,e){let n=hV(e);for(let r of t.elements)n=n.filter(i=>!ei(i,r));return{arrayValue:{values:n}}}var Ms=class extends Uu{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function Q1(t){return nt(t.integerValue||t.doubleValue)}function hV(t){return zd(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Bo=class{constructor(e,n){this.field=e,this.transform=n}};function pK(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ni&&i instanceof Ni||r instanceof Pi&&i instanceof Pi?Fu(r.elements,i.elements,ei):r instanceof Ms&&i instanceof Ms?ei(r.Ie,i.Ie):r instanceof Rs&&i instanceof Rs}(t.transform,e.transform)}var fD=class{constructor(e,n){this.version=e,this.transformResults=n}},rt=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Pm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Bu=class{};function fV(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ps(t.key,rt.none()):new Ns(t.key,t.data,rt.none());{let n=t.data,r=Zt.empty(),i=new Fe(ut.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new _r(t.key,r,new Pn(i.toArray()),rt.none())}}function gK(t,e,n){t instanceof Ns?function(i,s,o){let a=i.value.clone(),u=Z1(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof _r?function(i,s,o){if(!Pm(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=Z1(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(pV(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ld(t,e,n,r){return t instanceof Ns?function(s,o,a,u){if(!Pm(s.precondition,o))return a;let c=s.value.clone(),l=X1(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof _r?function(s,o,a,u){if(!Pm(s.precondition,o))return a;let c=X1(s.fieldTransforms,u,o),l=o.data;return l.setAll(pV(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Pm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function mK(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=cV(r.transform,i||null);s!=null&&(n===null&&(n=Zt.empty()),n.set(r.field,s))}return n||null}function Y1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Fu(r,i,(s,o)=>pK(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Ns=class extends Bu{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},_r=class extends Bu{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function pV(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function Z1(t,e,n){let r=new Map;$(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,fK(o,a,n[i]))}return r}function X1(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,hK(s,o,e))}return r}var Ps=class extends Bu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Wd=class extends Bu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Kd=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&gK(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ld(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Ld(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=sV();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=fV(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(G.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ie())}isEqual(e){return this.batchId===e.batchId&&Fu(this.mutations,e.mutations,(n,r)=>Y1(n,r))&&Fu(this.baseMutations,e.baseMutations,(n,r)=>Y1(n,r))}},pD=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){$(e.mutations.length===r.length);let i=function(){return cK}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Qd=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var gD=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var pt,_e;function gV(t){switch(t){default:return F();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function mV(t){if(t===void 0)return at("GRPC error has no .code"),y.UNKNOWN;switch(t){case pt.OK:return y.OK;case pt.CANCELLED:return y.CANCELLED;case pt.UNKNOWN:return y.UNKNOWN;case pt.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case pt.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case pt.INTERNAL:return y.INTERNAL;case pt.UNAVAILABLE:return y.UNAVAILABLE;case pt.UNAUTHENTICATED:return y.UNAUTHENTICATED;case pt.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case pt.NOT_FOUND:return y.NOT_FOUND;case pt.ALREADY_EXISTS:return y.ALREADY_EXISTS;case pt.PERMISSION_DENIED:return y.PERMISSION_DENIED;case pt.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case pt.ABORTED:return y.ABORTED;case pt.OUT_OF_RANGE:return y.OUT_OF_RANGE;case pt.UNIMPLEMENTED:return y.UNIMPLEMENTED;case pt.DATA_LOSS:return y.DATA_LOSS;default:return F()}}(_e=pt||(pt={}))[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";var J1=null;function _V(){return new TextEncoder}var _K=new Ao([4294967295,4294967295],0);function eF(t){let e=_V().encode(t),n=new P1;return n.update(e),new Uint8Array(n.digest())}function tF(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ao([n,r],0),new Ao([i,s],0)]}var mD=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Oo(`Invalid padding: ${n}`);if(r<0)throw new Oo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Oo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Oo(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Ao.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Ao.fromNumber(r)));return i.compare(_K)===1&&(i=new Ao([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=eF(e),[r,i]=tF(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=eF(e),[r,i]=tF(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Oo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Yd=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Zd.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(G.min(),i,new Be(re),yn(),ie())}},Zd=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,ie(),ie(),ie())}};var Ou=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},Km=class{constructor(e,n){this.targetId=e,this.fe=n}},Qm=class{constructor(e,n,r=kt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Ym=class{constructor(){this.ge=0,this.pe=rF(),this.ye=kt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=ie(),n=ie(),r=ie();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:F()}}),new Zd(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=rF()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,$(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},_D=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=yn(),this.Qe=nF(),this.Ke=new Be(re)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:F()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Gm(s))if(r===0){let o=new x(s.path);this.We(n,o,yt.newNoDocument(o,G.min()))}else $(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),u=a?this.et(a,e,o):1;if(u!==0){this.He(n);let c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,c)}J1?.tt(function(l,d,h,f,p){var g,m,I,A,D,k;let q={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},W=d.unchangedNames;return W&&(q.bloomFilter={applied:p===0,hashCount:(g=W?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(A=(I=(m=W?.bits)===null||m===void 0?void 0:m.bitmap)===null||I===void 0?void 0:I.length)!==null&&A!==void 0?A:0,padding:(k=(D=W?.bits)===null||D===void 0?void 0:D.padding)!==null&&k!==void 0?k:0,mightContain:xe=>{var Dt;return(Dt=f?.mightContain(xe))!==null&&Dt!==void 0&&Dt}}),q}(o,e.fe,this.Le.nt(),a,u))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Ss(r).toUint8Array()}catch(u){if(u instanceof $m)return Yn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new mD(o,i,s)}catch(u){return Yn(u instanceof Oo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Gm(a.target)){let u=new x(a.target.path);this.qe.get(u)!==null||this.st(o,u)||this.We(o,u,yt.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=ie();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let c=this.Ye(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Yd(e,n,this.Ke,this.qe,r);return this.qe=yn(),this.Qe=nF(),this.Ke=new Be(re),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Ym,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Fe(re),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||C("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Ym),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function nF(){return new Be(x.comparator)}function rF(){return new Be(x.comparator)}var yK={asc:"ASCENDING",desc:"DESCENDING"},vK={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},wK={and:"AND",or:"OR"},yD=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function vD(t,e){return t.useProto3Json||lh(e)?e:{value:e}}function $u(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yV(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function EK(t,e){return $u(t,e.toTimestamp())}function ct(t){return $(!!t),G.fromTimestamp(function(n){let r=bs(n);return new Ze(r.seconds,r.nanos)}(t))}function GT(t,e){return wD(t,e).canonicalString()}function wD(t,e){let n=function(i){return new ye(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function vV(t){let e=ye.fromString(t);return $(xV(e)),e}function Xd(t,e){return GT(t.databaseId,e.path)}function Xr(t,e){let n=vV(e);if(n.get(1)!==t.databaseId.projectId)throw new E(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new E(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new x(IV(n))}function wV(t,e){return GT(t.databaseId,e)}function EV(t){let e=vV(t);return e.length===4?ye.emptyPath():IV(e)}function ED(t){return new ye(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function IV(t){return $(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function iF(t,e,n){return{name:Xd(t,e),fields:n.value.mapValue.fields}}function CV(t,e,n){let r=Xr(t,e.name),i=ct(e.updateTime),s=e.createTime?ct(e.createTime):G.min(),o=new Zt({mapValue:{fields:e.fields}}),a=yt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function IK(t,e){return"found"in e?function(r,i){$(!!i.found),i.found.name,i.found.updateTime;let s=Xr(r,i.found.name),o=ct(i.found.updateTime),a=i.found.createTime?ct(i.found.createTime):G.min(),u=new Zt({mapValue:{fields:i.found.fields}});return yt.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){$(!!i.missing),$(!!i.readTime);let s=Xr(r,i.missing),o=ct(i.readTime);return yt.newNoDocument(s,o)}(t,e):F()}function CK(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:F()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?($(l===void 0||typeof l=="string"),kt.fromBase64String(l||"")):($(l===void 0||l instanceof Uint8Array),kt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let l=c.code===void 0?y.UNKNOWN:mV(c.code);return new E(l,c.message||"")}(o);n=new Qm(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Xr(t,r.document.name),s=ct(r.document.updateTime),o=r.document.createTime?ct(r.document.createTime):G.min(),a=new Zt({mapValue:{fields:r.document.fields}}),u=yt.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new Ou(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Xr(t,r.document),s=r.readTime?ct(r.readTime):G.min(),o=yt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ou([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Xr(t,r.document),s=r.removedTargetIds||[];n=new Ou([],s,i,null)}else{if(!("filter"in e))return F();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new gD(i,s),a=r.targetId;n=new Km(a,o)}}return n}function Jd(t,e){let n;if(e instanceof Ns)n={update:iF(t,e.key,e.value)};else if(e instanceof Ps)n={delete:Xd(t,e.key)};else if(e instanceof _r)n={update:iF(t,e.key,e.data),updateMask:xK(e.fieldMask)};else{if(!(e instanceof Wd))return F();n={verify:Xd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Rs)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ni)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Pi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ms)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw F()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:EK(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:F()}(t,e.precondition)),n}function ID(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?rt.updateTime(ct(s.updateTime)):s.exists!==void 0?rt.exists(s.exists):rt.none()}(e.currentDocument):rt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)$(a.setToServerValue==="REQUEST_TIME"),u=new Rs;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];u=new Ni(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];u=new Pi(l)}else"increment"in a?u=new Ms(o,a.increment):F();let c=ut.fromServerFormat(a.fieldPath);return new Bo(c,u)}(t,i)):[];if(e.update){e.update.name;let i=Xr(t,e.update.name),s=new Zt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let c=u.fieldPaths||[];return new Pn(c.map(l=>ut.fromServerFormat(l)))}(e.updateMask);return new _r(i,s,o,n,r)}return new Ns(i,s,n,r)}if(e.delete){let i=Xr(t,e.delete);return new Ps(i,n)}if(e.verify){let i=Xr(t,e.verify);return new Wd(i,n)}return F()}function DK(t,e){return t&&t.length>0?($(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ct(i.updateTime):ct(s);return o.isEqual(G.min())&&(o=ct(s)),new fD(o,i.transformResults||[])}(n,e))):[]}function DV(t,e){return{documents:[wV(t,e.path)]}}function TV(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=wV(t,i);let s=function(c){if(c.length!==0)return AV(Ae.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:xu(h.field),direction:bK(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=vD(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ut:n,parent:i}}function bV(t){let e=EV(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){$(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=SV(d);return h instanceof Ae&&$T(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new jo(Ru(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,lh(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){let h=!!d.before,f=d.values||[];return new ti(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new ti(f,h)}(n.endAt)),JF(e,i,o,s,a,"F",u,c)}function TK(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return F()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function SV(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Ru(n.unaryFilter.field);return me.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ru(n.unaryFilter.field);return me.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ru(n.unaryFilter.field);return me.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Ru(n.unaryFilter.field);return me.create(o,"!=",{nullValue:"NULL_VALUE"});default:return F()}}(t):t.fieldFilter!==void 0?function(n){return me.create(Ru(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return F()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ae.create(n.compositeFilter.filters.map(r=>SV(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return F()}}(n.compositeFilter.op))}(t):F()}function bK(t){return yK[t]}function SK(t){return vK[t]}function AK(t){return wK[t]}function xu(t){return{fieldPath:t.canonicalString()}}function Ru(t){return ut.fromServerFormat(t.fieldPath)}function AV(t){return t instanceof me?function(n){if(n.op==="=="){if(B1(n.value))return{unaryFilter:{field:xu(n.field),op:"IS_NAN"}};if(U1(n.value))return{unaryFilter:{field:xu(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(B1(n.value))return{unaryFilter:{field:xu(n.field),op:"IS_NOT_NAN"}};if(U1(n.value))return{unaryFilter:{field:xu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xu(n.field),op:SK(n.op),value:n.value}}}(t):t instanceof Ae?function(n){let r=n.getFilters().map(i=>AV(i));return r.length===1?r[0]:{compositeFilter:{op:AK(n.op),filters:r}}}(t):F()}function xK(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function xV(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Hu=class t{constructor(e,n,r,i,s=G.min(),o=G.min(),a=kt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Zm=class{constructor(e){this.ct=e}};function RK(t,e){let n;if(e.document)n=CV(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=x.fromSegments(e.noDocument.path),i=Ho(e.noDocument.readTime);n=yt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return F();{let r=x.fromSegments(e.unknownDocument.path),i=Ho(e.unknownDocument.version);n=yt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new Ze(i[0],i[1]);return G.fromTimestamp(s)}(e.readTime)),n}function sF(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Xm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Xd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:$u(s,o.version.toTimestamp()),createTime:$u(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:$o(e.version)};else{if(!e.isUnknownDocument())return F();r.unknownDocument={path:n.path.toArray(),version:$o(e.version)}}return r}function Xm(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function $o(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ho(t){let e=new Ze(t.seconds,t.nanoseconds);return G.fromTimestamp(e)}function No(t,e){let n=(e.baseMutations||[]).map(s=>ID(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>ID(t.ct,s)),i=Ze.fromMillis(e.localWriteTimeMs);return new Kd(e.batchId,i,n,r)}function Od(t){let e=Ho(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ho(t.lastLimboFreeSnapshotVersion):G.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return $(s.documents.length===1),un(Ju(EV(s.documents[0])))}(t.query):function(s){return un(bV(s))}(t.query),new Hu(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,kt.fromBase64String(t.resumeToken))}function RV(t,e){let n=$o(e.snapshotVersion),r=$o(e.lastLimboFreeSnapshotVersion),i;i=Gm(e.target)?DV(t.ct,e.target):TV(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Uo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function zT(t){let e=bV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Wm(e,e.limit,"L"):e}function V0(t,e){return new Qd(e.largestBatchId,ID(t.ct,e.overlayMutation))}function oF(t,e){let n=e.path.lastSegment();return[t,an(e.path.popLast()),n]}function aF(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:$o(r.readTime),documentKey:an(r.documentKey.path),largestBatchId:r.largestBatchId}}var CD=class{getBundleMetadata(e,n){return uF(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Ho(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return uF(e).put(function(i){return{bundleId:i.id,createTime:$o(ct(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return cF(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:zT(s.bundledQuery),readTime:Ho(s.readTime)}}(r)})}saveNamedQuery(e,n){return cF(e).put(function(i){return{name:i.name,readTime:$o(ct(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function uF(t){return Ot(t,"bundles")}function cF(t){return Ot(t,"namedQueries")}var Jm=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return Rd(e).get(oF(this.userId,n)).next(r=>r?V0(this.serializer,r):null)}getOverlays(e,n){let r=Yr();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new Qd(n,o);i.push(this.ht(e,a))}),_.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(an(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Rd(e).H("collectionPathOverlayIndex",a))}),_.waitFor(s)}getOverlaysForCollection(e,n,r){let i=Yr(),s=an(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Rd(e).W("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let c=V0(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=Yr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Rd(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{let d=V0(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return Rd(e).put(function(i,s,o){let[a,u,c]=oF(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Jd(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function Rd(t){return Ot(t,"documentOverlays")}var xi=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(nt(e.integerValue));else if("doubleValue"in e){let r=nt(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),$d(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Ss(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?zF(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):F()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),x.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};xi.bt=new xi;function MK(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function lF(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=MK(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var DD=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Bt(e){let n=this.Lt(e),r=lF(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Lt(e),r=lF(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},TD=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}},bD=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Po=class{constructor(){this.Gt=new DD,this.zt=new TD(this.Gt),this.jt=new bD(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var ko=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function vs(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=dF(t.arrayValue,e.arrayValue),n!==0?n:(n=dF(t.directionalValue,e.directionalValue),n!==0?n:x.comparator(t.documentKey,e.documentKey)))}function dF(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var e_=class{constructor(e){this.Yt=new Fe((n,r)=>ut.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if($(e.collectionGroup===this.collectionId),this.en)return!1;let n=K0(e);if(n!==void 0&&!this.nn(n))return!1;let r=Ro(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.rn(a,u)||!this.sn(this.Zt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Fe(ut.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Pu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Pu(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Pu(r.field,r.dir==="asc"?0:1)));return new Vu(Vu.UNKNOWN_ID,this.collectionId,n,Bd.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function MV(t){var e,n;if($(t instanceof me||t instanceof Ae),t instanceof me){if(t instanceof qm){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>me.create(t.field,"==",s)))||[];return Ae.create(i,"or")}return t}let r=t.filters.map(i=>MV(i));return Ae.create(r,t.op)}function NK(t){if(t.getFilters().length===0)return[];let e=xD(MV(t));return $(NV(e)),SD(e)||AD(e)?[e]:e.getFilters()}function SD(t){return t instanceof me}function AD(t){return t instanceof Ae&&$T(t)}function NV(t){return SD(t)||AD(t)||function(n){if(n instanceof Ae&&nD(n)){for(let r of n.getFilters())if(!SD(r)&&!AD(r))return!1;return!0}return!1}(t)}function xD(t){if($(t instanceof me||t instanceof Ae),t instanceof me)return t;if(t.filters.length===1)return xD(t.filters[0]);let e=t.filters.map(r=>xD(r)),n=Ae.create(e,t.op);return n=t_(n),NV(n)?n:($(n instanceof Ae),$(ju(n)),$(n.filters.length>1),n.filters.reduce((r,i)=>WT(r,i)))}function WT(t,e){let n;return $(t instanceof me||t instanceof Ae),$(e instanceof me||e instanceof Ae),n=t instanceof me?e instanceof me?function(i,s){return Ae.create([i,s],"and")}(t,e):hF(t,e):e instanceof me?hF(e,t):function(i,s){if($(i.filters.length>0&&s.filters.length>0),ju(i)&&ju(s))return YF(i,s.getFilters());let o=nD(i)?i:s,a=nD(i)?s:i,u=o.filters.map(c=>WT(c,a));return Ae.create(u,"or")}(t,e),t_(n)}function hF(t,e){if(ju(e))return YF(e,t.getFilters());{let n=e.filters.map(r=>WT(t,r));return Ae.create(n,"or")}}function t_(t){if($(t instanceof me||t instanceof Ae),t instanceof me)return t;let e=t.getFilters();if(e.length===1)return t_(e[0]);if(KF(t))return t;let n=e.map(i=>t_(i)),r=[];return n.forEach(i=>{i instanceof me?r.push(i):i instanceof Ae&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ae.create(r,t.op)}var RD=class{constructor(){this._n=new eh}addToCollectionParentIndex(e,n){return this._n.add(n),_.resolve()}getCollectionParents(e,n){return _.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return _.resolve()}deleteFieldIndex(e,n){return _.resolve()}deleteAllFieldIndexes(e){return _.resolve()}createTargetIndexes(e,n){return _.resolve()}getDocumentsMatchingTarget(e,n){return _.resolve(null)}getIndexType(e,n){return _.resolve(0)}getFieldIndexes(e,n){return _.resolve([])}getNextCollectionGroupToUpdate(e){return _.resolve(null)}getMinOffset(e,n){return _.resolve(Zn.min())}getMinOffsetFromCollectionGroup(e,n){return _.resolve(Zn.min())}updateCollectionGroup(e,n,r){return _.resolve()}updateIndexEntries(e,n){return _.resolve()}},eh=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Fe(ye.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Fe(ye.comparator)).toArray()}};var bm=new Uint8Array(0),MD=class{constructor(e,n){this.databaseId=n,this.an=new eh,this.un=new ni(r=>Uo(r),(r,i)=>dh(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:an(i)};return fF(e).put(s)}return _.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[OF(n),""],!1,!0);return fF(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(Qr(o.parent))}return r})}addFieldIndex(e,n){let r=Md(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Tu(e);return s.next(a=>{o.put(aF(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=Md(e),i=Tu(e),s=Du(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=Md(e),r=Du(e),i=Tu(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return _.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new e_(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=Du(e),i=!0,s=new Map;return _.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ie(),a=[];return _.forEach(s,(u,c)=>{C("IndexedDbIndexManager",`Using index ${function(D){return`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map(k=>`${k.fieldPath}:${k.kind}`).join(",")}`}(u)} to execute ${Uo(n)}`);let l=function(D,k){let q=K0(k);if(q===void 0)return null;for(let W of zm(D,q.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null}(c,u),d=function(D,k){let q=new Map;for(let W of Ro(k))for(let xe of zm(D,W.fieldPath))switch(xe.op){case"==":case"in":q.set(W.fieldPath.canonicalString(),xe.value);break;case"not-in":case"!=":return q.set(W.fieldPath.canonicalString(),xe.value),Array.from(q.values())}return null}(c,u),h=function(D,k){let q=[],W=!0;for(let xe of Ro(k)){let Dt=xe.kind===0?z1(D,xe.fieldPath,D.startAt):W1(D,xe.fieldPath,D.startAt);q.push(Dt.value),W&&(W=Dt.inclusive)}return new ti(q,W)}(c,u),f=function(D,k){let q=[],W=!0;for(let xe of Ro(k)){let Dt=xe.kind===0?W1(D,xe.fieldPath,D.endAt):z1(D,xe.fieldPath,D.endAt);q.push(Dt.value),W&&(W=Dt.inclusive)}return new ti(q,W)}(c,u),p=this.hn(u,c,h),g=this.hn(u,c,f),m=this.Pn(u,c,d),I=this.In(u.indexId,l,p,h.inclusive,g,f.inclusive,m);return _.forEach(I,A=>r.j(A,n.limit).next(D=>{D.forEach(k=>{let q=x.fromSegments(k.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}return _.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=NK(Ae.create(e.filters,"and")).map(r=>dD(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),l=[];for(let d=0;d<u;++d){let h=n?this.Tn(n[d/c]):bm,f=this.En(e,h,r[d%c],i),p=this.dn(e,h,s[d%c],o),g=a.map(m=>this.En(e,h,m,!0));l.push(...this.createRange(f,p,g))}return l}En(e,n,r,i){let s=new ko(e,x.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new ko(e,x.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new e_(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return _.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new Fe(ut.comparator),l=!1;for(let d of u.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:c=c.add(h.field));for(let d of u.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new Po;for(let i of Ro(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);xi.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new Po;return xi.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new Po;return xi.bt.Pt(Lo(this.databaseId,n),r.Ht(function(s){let o=Ro(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new Po);let s=0;for(let o of Ro(e)){let a=r[s++];for(let u of i)if(this.Vn(n,o.fieldPath)&&zd(a))i=this.mn(i,o,a);else{let c=u.Ht(o.kind);xi.bt.Pt(a,c)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new Po;u.seed(a.Wt()),xi.bt.Pt(o,u.Ht(n.kind)),s.push(u)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof me&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=Md(e),i=Tu(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return _.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,d){let h=d?new Bd(d.sequenceNumber,new Zn(Ho(d.readTime),new x(Qr(d.documentKey)),d.largestBatchId)):Bd.empty(),f=l.fields.map(([p,g])=>new Pu(ut.fromServerFormat(p),g));return new Vu(l.indexId,l.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:re(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=Md(e),s=Tu(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>_.forEach(a,u=>s.put(aF(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return _.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?_.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),_.forEach(a,u=>this.pn(e,i,u).next(c=>{let l=this.yn(s,u);return c.isEqual(l)?_.resolve():this.wn(e,s,u,c,l)}))))})}Sn(e,n,r,i){return Du(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return Du(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=Du(e),s=new Fe(vs);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new ko(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Fe(vs),i=this.An(n,e);if(i==null)return r;let s=K0(n);if(s!=null){let o=e.data.field(s.fieldPath);if(zd(o))for(let a of o.arrayValue.values||[])r=r.add(new ko(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new ko(n.indexId,e.key,bm,i));return r}wn(e,n,r,i,s){C("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(u,c,l,d,h){let f=u.getIterator(),p=c.getIterator(),g=Cu(f),m=Cu(p);for(;g||m;){let I=!1,A=!1;if(g&&m){let D=l(g,m);D<0?A=!0:D>0&&(I=!0)}else g!=null?A=!0:I=!0;I?(d(m),m=Cu(p)):A?(h(g),g=Cu(f)):(g=Cu(f),m=Cu(p))}}(i,s,vs,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),_.waitFor(o)}gn(e){let n=1;return Tu(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>vs(o,a)).filter((o,a,u)=>!a||vs(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=vs(o,e),u=vs(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&u<0)i.push(o),i.push(o.Jt());else if(u>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,bm,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,bm,[]];s.push(IDBKeyRange.bound(a,u))}return s}Dn(e,n){return vs(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(pF)}getMinOffset(e,n){return _.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||F())).next(pF)}};function fF(t){return Ot(t,"collectionParents")}function Du(t){return Ot(t,"indexEntries")}function Md(t){return Ot(t,"indexConfiguration")}function Tu(t){return Ot(t,"indexState")}function pF(t){$(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;jT(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Zn(e.readTime,e.documentKey,n)}var gF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Qn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function PV(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,u=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{$(a===1)}));let c=[];for(let l of n.mutations){let d=UF(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return _.waitFor(s).next(()=>c)}function n_(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw F();e=t.noDocument}return JSON.stringify(e).length}Qn.DEFAULT_COLLECTION_PERCENTILE=10,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qn.DEFAULT=new Qn(41943040,Qn.DEFAULT_COLLECTION_PERCENTILE,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qn.DISABLED=new Qn(-1,0,0);var r_=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){$(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ws(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Mu(e),o=ws(e);return o.add({}).next(a=>{$(typeof a=="number");let u=new Kd(a,n,r,i),c=function(f,p,g){let m=g.baseMutations.map(A=>Jd(f.ct,A)),I=g.mutations.map(A=>Jd(f.ct,A));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:m,mutations:I}}(this.serializer,this.userId,u),l=[],d=new Fe((h,f)=>re(h.canonicalString(),f.canonicalString()));for(let h of i){let f=UF(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,j8))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=u.keys()}),_.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return ws(e).get(n).next(r=>r?($(r.userId===this.userId),No(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?_.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ws(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&($(a.batchId>=r),s=No(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ws(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ws(e).W("userMutationsIndex",n).next(r=>r.map(i=>No(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Rm(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Mu(e).Y({range:i},(o,a,u)=>{let[c,l,d]=o,h=Qr(l);if(c===this.userId&&n.path.isEqual(h))return ws(e).get(d).next(f=>{if(!f)throw F();$(f.userId===this.userId),s.push(No(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Fe(re),i=[];return n.forEach(s=>{let o=Rm(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=Mu(e).Y({range:a},(c,l,d)=>{let[h,f,p]=c,g=Qr(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(u)}),_.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Rm(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Fe(re);return Mu(e).Y({range:o},(u,c,l)=>{let[d,h,f]=u,p=Qr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(ws(e).get(s).next(o=>{if(o===null)throw F();$(o.userId===this.userId),r.push(No(this.serializer,o))}))}),_.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return PV(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),_.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return _.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Mu(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=Qr(s[1]);i.push(u)}else a.done()}).next(()=>{$(i.length===0)})})}containsKey(e,n){return kV(e,this.userId,n)}xn(e){return OV(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function kV(t,e,n){let r=Rm(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Mu(t).Y({range:s,J:!0},(a,u,c)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function ws(t){return Ot(t,"mutations")}function Mu(t){return Ot(t,"documentMutations")}function OV(t){return Ot(t,"mutationQueues")}var qu=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Bn(){return new t(-1)}};var ND=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new qu(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>G.fromTimestamp(new Ze(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>bu(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>($(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return bu(e).Y((o,a)=>{let u=Od(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>_.waitFor(s)).next(()=>i)}forEachTarget(e,n){return bu(e).Y((r,i)=>{let s=Od(i);n(s)})}Ln(e){return mF(e).get("targetGlobalKey").next(n=>($(n!==null),n))}kn(e,n){return mF(e).put("targetGlobalKey",n)}qn(e,n){return bu(e).put(RV(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Uo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return bu(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let c=Od(a);dh(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Es(e);return n.forEach(o=>{let a=an(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),_.waitFor(i)}removeMatchingKeys(e,n,r){let i=Es(e);return _.forEach(n,s=>{let o=an(s.path);return _.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Es(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Es(e),s=ie();return i.Y({range:r,J:!0},(o,a,u)=>{let c=Qr(o[1]),l=new x(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=an(n.path),i=IDBKeyRange.bound([r],[OF(r)],!1,!0),s=0;return Es(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}_t(e,n){return bu(e).get(n).next(r=>r?Od(r):null)}};function bu(t){return Ot(t,"targets")}function mF(t){return Ot(t,"targetGlobal")}function Es(t){return Ot(t,"targetDocuments")}function _F([t,e],[n,r]){let i=re(t,n);return i===0?re(e,r):i}var PD=class{constructor(e){this.Kn=e,this.buffer=new Fe(_F),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();_F(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},kD=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){C("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>v(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){Fs(n)?C("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Os(n)}yield this.zn(3e5)}))}},OD=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return _.resolve(Nn._e);let r=new PD(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(C("LruGarbageCollector","Garbage collection skipped; disabled"),_.resolve(gF)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gF):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),Su()<=Fn.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),_.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function PK(t,e){return new OD(t,e)}var FD=class{constructor(e,n){this.db=e,this.garbageCollector=PK(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return Sm(e,r)}removeReference(e,n,r){return Sm(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Sm(e,n)}er(e,n){return function(i,s){let o=!1;return OV(i).Z(a=>kV(i,a,s).next(u=>(u&&(o=!0),_.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let u=this.er(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,G.min()),Es(e).delete(function(d){return[0,an(d.path)]}(o))))});i.push(u)}}).next(()=>_.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Sm(e,n)}Xn(e,n){let r=Es(e),i,s=Nn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==Nn._e&&n(new x(Qr(i)),s),s=c,i=u):s=Nn._e}).next(()=>{s!==Nn._e&&n(new x(Qr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Sm(t,e){return Es(t).put(function(r,i){return{targetId:0,path:an(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var i_=class{constructor(){this.changes=new ni(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,yt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?_.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var VD=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return xo(e).put(r)}removeEntry(e,n,r){return xo(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Xm(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=yt.newInvalidDocument(n);return xo(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Nd(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:yt.newInvalidDocument(n)};return xo(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Nd(n))},(i,s)=>{r={document:this.nr(n,s),size:n_(s)}}).next(()=>r)}getEntries(e,n){let r=yn();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=yn(),i=new Be(x.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,n_(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return _.resolve();let i=new Fe(wF);n.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(Nd(i.first()),Nd(i.last())),o=i.getIterator(),a=o.getNext();return xo(e).Y({index:"documentKeyIndex",range:s},(u,c,l)=>{let d=x.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&wF(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.U(Nd(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Xm(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xo(e).W(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let l=yn();for(let d of c){let h=this.nr(x.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(fh(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=yn(),o=vF(n,r),a=vF(n,Zn.max());return xo(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{let d=this.nr(x.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new LD(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return yF(e).get("remoteDocumentGlobalKey").next(n=>($(!!n),n))}tr(e,n){return yF(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=RK(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(G.min())))return r}return yt.newInvalidDocument(e)}};function FV(t){return new VD(t)}var LD=class extends i_{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new ni(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Fe((s,o)=>re(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=sF(this.ar.serializer,o);i=i.add(s.path.popLast());let c=n_(u);r+=c-a.size,n.push(this.ar.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=sF(this.ar.serializer,o.convertToNoDocument(G.min()));n.push(this.ar.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),_.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function yF(t){return Ot(t,"remoteDocumentGlobal")}function xo(t){return Ot(t,"remoteDocumentsV14")}function Nd(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function vF(t,e){let n=e.documentKey.path.toArray();return[t,Xm(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function wF(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=re(n[s],r[s]),i)return i;return i=re(n.length,r.length),i||(i=re(n[n.length-2],r[r.length-2]),i||re(n[n.length-1],r[r.length-1]))}var jD=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var s_=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ld(r.mutation,i,Pn.empty(),Ze.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ie()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ie()){let i=Yr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=kd();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=Yr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ie()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=yn(),o=Vd(),a=function(){return Vd()}();return n.forEach((u,c)=>{let l=r.get(c.key);i.has(c.key)&&(l===void 0||l.mutation instanceof _r)?s=s.insert(c.key,c):l!==void 0?(o.set(c.key,l.mutation.getFieldMask()),Ld(l.mutation,c,l.mutation.getFieldMask(),Ze.now())):o.set(c.key,Pn.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new jD(l,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Vd(),i=new Be((o,a)=>o-a),s=ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let c=n.get(u);if(c===null)return;let l=r.get(u)||Pn.empty();l=a.applyToLocalView(c,l),r.set(u,l);let d=(i.get(a.batchId)||ie()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),c=u.key,l=u.value,d=sV();l.forEach(h=>{if(!s.has(h)){let f=fV(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return _.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return x.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):HT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):_.resolve(Yr()),a=-1,u=s;return o.next(c=>_.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?_.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,ie())).next(l=>({batchId:a,changes:iV(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new x(n)).next(r=>{let i=kd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=kd();return this.indexManager.getCollectionParents(e,s).next(a=>_.forEach(a,u=>{let c=function(d,h){return new mr(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{let l=c.getKey();o.get(l)===null&&(o=o.insert(l,yt.newInvalidDocument(l)))});let a=kd();return o.forEach((u,c)=>{let l=s.get(u);l!==void 0&&Ld(l.mutation,c,Pn.empty(),Ze.now()),fh(n,c)&&(a=a.insert(u,c))}),a})}};var UD=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return _.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ct(i.createTime)}}(n)),_.resolve()}getNamedQuery(e,n){return _.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:zT(i.bundledQuery),readTime:ct(i.readTime)}}(n)),_.resolve()}};var BD=class{constructor(){this.overlays=new Be(x.comparator),this.hr=new Map}getOverlay(e,n){return _.resolve(this.overlays.get(n))}getOverlays(e,n){let r=Yr();return _.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),_.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),_.resolve()}getOverlaysForCollection(e,n,r){let i=Yr(),s=n.length+1,o=new x(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return _.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Be((c,l)=>c-l),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);l===null&&(l=Yr(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}let a=Yr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return _.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Qd(n,r));let s=this.hr.get(n);s===void 0&&(s=ie(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var th=class{constructor(){this.Pr=new Fe(gt.Ir),this.Tr=new Fe(gt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new gt(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new gt(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new x(new ye([])),r=new gt(n,e),i=new gt(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new x(new ye([])),r=new gt(n,e),i=new gt(n,e+1),s=ie();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new gt(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},gt=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return x.comparator(e.key,n.key)||re(e.pr,n.pr)}static Er(e,n){return re(e.pr,n.pr)||x.comparator(e.key,n.key)}};var $D=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Fe(gt.Ir)}checkEmpty(e){return _.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Kd(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new gt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return _.resolve(o)}lookupMutationBatch(e,n){return _.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return _.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return _.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return _.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new gt(n,0),i=new gt(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),_.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Fe(re);return n.forEach(i=>{let s=new gt(i,0),o=new gt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),_.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;x.isDocumentKey(s)||(s=s.child(""));let o=new gt(new x(s),0),a=new Fe(re);return this.wr.forEachWhile(u=>{let c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.pr)),!0)},o),_.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){$(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return _.forEach(n.mutations,i=>{let s=new gt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new gt(n,0),i=this.wr.firstAfterOrEqual(r);return _.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,_.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var HD=class{constructor(e){this.vr=e,this.docs=function(){return new Be(x.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return _.resolve(r?r.document.mutableCopy():yt.newInvalidDocument(n))}getEntries(e,n){let r=yn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():yt.newInvalidDocument(i))}),_.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=yn(),o=n.path,a=new x(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||jT(VF(l),r)<=0||(i.has(l.key)||fh(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return _.resolve(s)}getAllFromCollectionGroup(e,n,r,i){F()}Fr(e,n){return _.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new qD(this)}getSize(e){return _.resolve(this.size)}},qD=class extends i_{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),_.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var GD=class{constructor(e){this.persistence=e,this.Mr=new ni(n=>Uo(n),dh),this.lastRemoteSnapshotVersion=G.min(),this.highestTargetId=0,this.Or=0,this.Nr=new th,this.targetCount=0,this.Br=qu.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),_.resolve()}getLastRemoteSnapshotVersion(e){return _.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),_.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),_.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Br=new qu(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,_.resolve()}updateTargetData(e,n){return this.qn(n),_.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,_.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),_.waitFor(s).next(()=>i)}getTargetCount(e){return _.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return _.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),_.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),_.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),_.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return _.resolve(r)}containsKey(e,n){return _.resolve(this.Nr.containsKey(n))}};var o_=class{constructor(e,n){this.Lr={},this.overlays={},this.kr=new Nn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new GD(this),this.indexManager=new RD,this.remoteDocumentCache=function(i){return new HD(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Zm(n),this.$r=new UD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new BD,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new $D(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){C("MemoryPersistence","Starting transaction:",e);let i=new zD(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return _.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},zD=class extends jm{constructor(e){super(),this.currentSequenceNumber=e}},a_=class t{constructor(e){this.persistence=e,this.zr=new th,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw F()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),_.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),_.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),_.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _.forEach(this.Jr,r=>{let i=x.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,G.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return _.or([()=>_.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var WD=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Um("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",V1,{unique:!0}),u.createObjectStore("documentMutations")}(e),EF(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=_.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),EF(e)),o=o.next(()=>function(u){let c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:G.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").W().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",V1,{unique:!0});let d=c.store("mutations"),h=l.map(f=>d.put(f));return _.waitFor(h)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let c=u.createObjectStore("documentOverlays",{keyPath:Z8});c.createIndex("collectionPathOverlayIndex",X8,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",J8,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let c=u.createObjectStore("remoteDocumentsV14",{keyPath:U8});c.createIndex("documentKeyIndex",B8),c.createIndex("collectionGroupIndex",$8)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:W8}).createIndex("sequenceNumberIndex",K8,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:Q8}).createIndex("documentKeyIndex",Y8,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=n_(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>_.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>_.forEach(a,u=>{$(u.userId===s.userId);let c=No(this.serializer,u);return PV(e,s.userId,c).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let u=new ye(o),c=function(d){return[0,an(d)]}(u);s.push(n.get(c).next(l=>l?_.resolve():(d=>n.put({targetId:0,path:an(d),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>_.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:z8});let r=n.store("collectionParents"),i=new eh,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:an(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let u=new ye(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],c)=>{let l=Qr(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=Od(i),o=RV(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),u=function(d){return d.document?new x(ye.fromString(d.document.name).popFirst(5)):d.noDocument?x.fromSegments(d.noDocument.path):d.unknownDocument?x.fromSegments(d.unknownDocument.path):F()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>_.waitFor(i))}si(e,n){let r=n.store("mutations"),i=FV(this.serializer),s=new o_(a_.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:ie();No(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),_.forEach(a,(u,c)=>{let l=new mt(c),d=Jm.lt(this.serializer,l),h=s.getIndexManager(l),f=r_.lt(l,this.serializer,h,s.referenceDelegate);return new s_(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Hd(n,Nn._e),u).next()})})}};function EF(t){t.createObjectStore("targetDocuments",{keyPath:q8}).createIndex("documentTargetsIndex",G8,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",H8,{unique:!0}),t.createObjectStore("targetGlobal")}var L0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",KD=class t{constructor(e,n,r,i,s,o,a,u,c,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=c,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new E(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new FD(this,i),this.Ti=n+"main",this.serializer=new Zm(u),this.Ei=new Mi(this.Ti,this.ui,new WD(this.serializer)),this.Qr=new ND(this.referenceDelegate,this.serializer),this.remoteDocumentCache=FV(this.serializer),this.$r=new CD,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&at("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new E(y.FAILED_PRECONDITION,L0);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Nn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>v(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(n=>v(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>v(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Am(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(Fs(e))return C("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return C("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Pd(e).get("owner").next(n=>_.resolve(this.Si(n)))}bi(e){return Am(e).delete(this.clientId)}Di(){return v(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=Ot(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return _.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?_.resolve(!0):Pd(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new E(y.FAILED_PRECONDITION,L0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Am(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&C("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return v(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Hd(e,Nn._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Bi()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>Am(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return r_.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new MD(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Jm.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){C("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===15?tK:u===14?HF:u===13?$F:u===12?eK:u===11?BF:void F()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Hd(a,this.kr?this.kr.next():Nn._e),n==="readwrite-primary"?this.gi(o).next(u=>!!u||this.pi(o)).next(u=>{if(!u)throw at(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new E(y.FAILED_PRECONDITION,LF);return r(o)}).next(u=>this.wi(o).next(()=>u)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return Pd(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new E(y.FAILED_PRECONDITION,L0)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Pd(e).put("owner",n)}static D(){return Mi.D()}yi(e){let n=Pd(e);return n.get("owner").next(r=>this.Si(r)?(C("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):_.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(at(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;iy()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return C("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return at("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){at("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Pd(t){return Ot(t,"owner")}function Am(t){return Ot(t,"clientMetadata")}function KT(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var QD=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=ie(),i=ie();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var YD=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var u_=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return iy()?8:Mi.v(mc())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new YD;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Su()<=Fn.DEBUG&&C("QueryEngine","SDK will not create cache indexes for query:",Au(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),_.resolve()):(Su()<=Fn.DEBUG&&C("QueryEngine","Query:",Au(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Su()<=Fn.DEBUG&&C("QueryEngine","The SDK decides to create cache indexes for query:",Au(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,un(n))):_.resolve())}ji(e,n){if(K1(n))return _.resolve(null);let r=un(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Wm(n,null,"F"),r=un(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ie(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let c=this.Zi(n,a);return this.Xi(n,c,o,u.readTime)?this.ji(e,Wm(n,null,"F")):this.es(e,c,n,u)}))})))}Hi(e,n,r,i){return K1(n)||i.isEqual(G.min())?_.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?_.resolve(null):(Su()<=Fn.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Au(n)),this.es(e,o,n,FF(i,-1)).next(a=>a))})}Zi(e,n){let r=new Fe(nV(e));return n.forEach((i,s)=>{fh(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Su()<=Fn.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",Au(n)),this.zi.getDocumentsMatchingQuery(e,n,Zn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var ZD=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Be(re),this.rs=new ni(s=>Uo(s),dh),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new s_(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function VV(t,e,n,r){return new ZD(t,e,n,r)}function LV(t,e){return v(this,null,function*(){let n=M(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=ie();for(let c of i){o.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}for(let c of s){a.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})})}function kK(t,e){let n=M(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){let d=c.batch,h=d.keys(),f=_.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(u,p)).next(g=>{let m=c.docVersions.get(p);$(m!==null),g.version.compareTo(m)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ie();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function jV(t){let e=M(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function OK(t,e){let n=M(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(kt.EMPTY_BYTE_STRING,G.min()).withLastLimboFreeSnapshotVersion(G.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,m,I){return g.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let u=yn(),c=ie();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(UV(s,o,e.documentUpdates).next(l=>{u=l.cs,c=l.ls})),!r.isEqual(G.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return _.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ns=i,s))}function UV(t,e,n){let r=ie(),i=ie();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=yn();return n.forEach((a,u)=>{let c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(G.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):C("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{cs:o,ls:i}})}function FK(t,e){let n=M(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Gu(t,e){let n=M(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,_.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Hu(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function zu(t,e,n){return v(this,null,function*(){let r=M(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Fs(o))throw o;C("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function c_(t,e,n){let r=M(t),i=G.min(),s=ie();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){let d=M(u),h=d.rs.get(l);return h!==void 0?_.resolve(d.ns.get(h)):d.Qr.getTargetData(c,l)}(r,o,un(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:G.min(),n?s:ie())).next(a=>(HV(r,tV(e),a),{documents:a,hs:s})))}function BV(t,e){let n=M(t),r=M(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function $V(t,e){let n=M(t),r=n.ss.get(e)||G.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,FF(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(HV(n,e,i),i))}function HV(t,e,n){let r=t.ss.get(e)||G.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function VK(t,e,n,r){return v(this,null,function*(){let i=M(t),s=ie(),o=yn();for(let c of n){let l=e.Ps(c.metadata.name);c.document&&(s=s.add(l));let d=e.Is(c);d.setReadTime(e.Ts(c.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),u=yield Gu(i,function(l){return un(Ju(ye.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>UV(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.Qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.cs,l.ls)).next(()=>l.cs)))})}function LK(r,i){return v(this,arguments,function*(t,e,n=ie()){let s=yield Gu(t,un(zT(e.bundledQuery))),o=M(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=ct(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.$r.saveNamedQuery(a,e);let c=s.withResumeToken(kt.EMPTY_BYTE_STRING,u);return o.ns=o.ns.insert(c.targetId,c),o.Qr.updateTargetData(a,c).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function IF(t,e){return`firestore_clients_${t}_${e}`}function CF(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function j0(t,e){return`firestore_targets_${t}_${e}`}var l_=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new E(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(at("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},jd=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new E(r.error.code,r.error.message))),s?new t(e,r.state,i):(at("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},d_=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=qT();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=jF(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(at("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},XD=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(at("SharedClientState",`Failed to parse online state: ${e}`),null)}},nh=class{constructor(){this.activeTargetIds=qT()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Ud=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Be(re),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=IF(this.persistenceKey,this.Vs),this.Ss=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new nh),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Fs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return v(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(IF(this.persistenceKey,r));if(i){let s=d_.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,n,r){this.Bs(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(j0(this.persistenceKey,e));if(r){let i=jd.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(j0(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return C("SharedClientState","READ",e,n),n}setItem(e,n){C("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){C("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(C("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void at("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>v(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=Nn._e;if(s!=null)try{let a=JSON.parse(s);$(typeof a=="number"),o=a}catch(a){at("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Nn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,n,r){let i=new l_(this.currentUser,e,n,r),s=CF(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Ls(e){let n=CF(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=j0(this.persistenceKey,e),s=new jd(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return d_.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return l_.Es(new mt(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return jd.Es(i,n)}xs(e){return XD.Es(e)}Js(e){return JSON.parse(e)}zs(e){return v(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);C("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=qT();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},h_=class{constructor(){this.no=new nh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new nh,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var JD=class{io(e){}shutdown(){}};var f_=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){C("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){C("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var xm=null;function U0(){return xm===null?xm=function(){return 268435456+Math.round(2147483648*Math.random())}():xm++,"0x"+xm.toString(16)}var jK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var eT=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Yt="WebChannelConnection",tT=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=U0(),u=this.bo(n,r.toUriEncodedString());C("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let c={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(c,s,o),this.Co(n,u,c,i).then(l=>(C("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Yn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Xu}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=jK[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=U0();return new Promise((o,a)=>{let u=new N1;u.setWithCredentials(!0),u.listenOnce(R1.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Tm.NO_ERROR:let l=u.getResponseJson();C(Yt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Tm.TIMEOUT:C(Yt,`RPC '${e}' ${s} timed out`),a(new E(y.DEADLINE_EXCEEDED,"Request time out"));break;case Tm.HTTP_ERROR:let d=u.getStatus();if(C(Yt,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(m){let I=m.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(I)>=0?I:y.UNKNOWN}(f.status);a(new E(p,f.message))}else a(new E(y.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new E(y.UNAVAILABLE,"Connection failed."));break;default:F()}}finally{C(Yt,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);C(Yt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Fo(e,n,r){let i=U0(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=A1(),a=x1(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Do(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let l=s.join("");C(Yt,`Creating RPC '${e}' stream ${i}: ${l}`,u);let d=o.createWebChannel(l,u),h=!1,f=!1,p=new eT({lo:m=>{f?C(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,m):(h||(C(Yt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),C(Yt,`RPC '${e}' stream ${i} sending:`,m),d.send(m))},ho:()=>d.close()}),g=(m,I,A)=>{m.listen(I,D=>{try{A(D)}catch(k){setTimeout(()=>{throw k},0)}})};return g(d,xd.EventType.OPEN,()=>{f||C(Yt,`RPC '${e}' stream ${i} transport opened.`)}),g(d,xd.EventType.CLOSE,()=>{f||(f=!0,C(Yt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,xd.EventType.ERROR,m=>{f||(f=!0,Yn(Yt,`RPC '${e}' stream ${i} transport errored:`,m),p.Vo(new E(y.UNAVAILABLE,"The operation could not be completed")))}),g(d,xd.EventType.MESSAGE,m=>{var I;if(!f){let A=m.data[0];$(!!A);let D=A,k=D.error||((I=D[0])===null||I===void 0?void 0:I.error);if(k){C(Yt,`RPC '${e}' stream ${i} received error:`,k);let q=k.status,W=function(js){let Qb=pt[js];if(Qb!==void 0)return mV(Qb)}(q),xe=k.message;W===void 0&&(W=y.INTERNAL,xe="Unknown error status: "+q+" with message "+k.message),f=!0,p.Vo(new E(W,xe)),d.close()}else C(Yt,`RPC '${e}' stream ${i} received:`,A),p.mo(A)}}),g(a,M1.STAT_EVENT,m=>{m.stat===F0.PROXY?C(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):m.stat===F0.NOPROXY&&C(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function qV(){return typeof window<"u"?window:null}function km(){return typeof document<"u"?document:null}function ph(t){return new yD(t,!0)}var rh=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&C("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var p_=class{constructor(e,n,r,i,s,o,a,u){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new rh(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return v(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return v(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return v(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(at(n.toString()),at("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new E(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>v(this,null,function*(){this.state=0,this.start()}))}__(e){return C("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(C("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},nT=class extends p_{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=CK(this.serializer,e),r=function(s){if(!("targetChange"in s))return G.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?G.min():o.readTime?ct(o.readTime):G.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=ED(this.serializer),n.addTarget=function(s,o){let a,u=o.target;if(a=Gm(u)?{documents:DV(s,u)}:{query:TV(s,u).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=yV(s,o.resumeToken);let c=vD(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(G.min())>0){a.readTime=$u(s,o.snapshotVersion.toTimestamp());let c=vD(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=TK(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=ED(this.serializer),n.removeTarget=e,this.t_(n)}},rT=class extends p_{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if($(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=DK(e.writeResults,e.commitTime),r=ct(e.commitTime);return this.listener.T_(r,n)}return $(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=ED(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Jd(this.serializer,r))};this.t_(n)}};var iT=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new E(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,wD(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new E(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,wD(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new E(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var sT=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(at(n),this.g_=!1):C("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var oT=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>v(this,null,function*(){Vs(this)&&(C("RemoteStore","Restarting streams for network reachability change."),yield function(u){return v(this,null,function*(){let c=M(u);c.v_.add(4),yield ec(c),c.x_.set("Unknown"),c.v_.delete(4),yield gh(c)})}(this))}))}),this.x_=new sT(r,i)}};function gh(t){return v(this,null,function*(){if(Vs(t))for(let e of t.F_)yield e(!0)})}function ec(t){return v(this,null,function*(){for(let e of t.F_)yield e(!1)})}function P_(t,e){let n=M(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),ZT(n)?YT(n):nc(n).Jo()&&QT(n,e))}function ih(t,e){let n=M(t),r=nc(n);n.C_.delete(e),r.Jo()&&GV(n,e),n.C_.size===0&&(r.Jo()?r.Xo():Vs(n)&&n.x_.set("Unknown"))}function QT(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(G.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}nc(t).c_(e)}function GV(t,e){t.O_.Oe(e),nc(t).l_(e)}function YT(t){t.O_=new _D({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),nc(t).start(),t.x_.p_()}function ZT(t){return Vs(t)&&!nc(t).Ho()&&t.C_.size>0}function Vs(t){return M(t).v_.size===0}function zV(t){t.O_=void 0}function UK(t){return v(this,null,function*(){t.C_.forEach((e,n)=>{QT(t,e)})})}function BK(t,e){return v(this,null,function*(){zV(t),ZT(t)?(t.x_.S_(e),YT(t)):t.x_.set("Unknown")})}function $K(t,e,n){return v(this,null,function*(){if(t.x_.set("Online"),e instanceof Qm&&e.state===2&&e.cause)try{yield function(i,s){return v(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){C("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield g_(t,r)}else if(e instanceof Ou?t.O_.$e(e):e instanceof Km?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(G.min()))try{let r=yield jV(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){let l=s.C_.get(c);l&&s.C_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{let l=s.C_.get(u);if(!l)return;s.C_.set(u,l.withResumeToken(kt.EMPTY_BYTE_STRING,l.snapshotVersion)),GV(s,u);let d=new Hu(l.target,u,c,l.sequenceNumber);QT(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){C("RemoteStore","Failed to raise snapshot:",r),yield g_(t,r)}})}function g_(t,e,n){return v(this,null,function*(){if(!Fs(e))throw e;t.v_.add(1),yield ec(t),t.x_.set("Offline"),n||(n=()=>jV(t.localStore)),t.asyncQueue.enqueueRetryable(()=>v(this,null,function*(){C("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield gh(t)}))})}function WV(t,e){return e().catch(n=>g_(t,n,e))}function tc(t){return v(this,null,function*(){let e=M(t),n=ks(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;HK(e);)try{let i=yield FK(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,qK(e,i)}catch(i){yield g_(e,i)}KV(e)&&QV(e)})}function HK(t){return Vs(t)&&t.D_.length<10}function qK(t,e){t.D_.push(e);let n=ks(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function KV(t){return Vs(t)&&!ks(t).Ho()&&t.D_.length>0}function QV(t){ks(t).start()}function GK(t){return v(this,null,function*(){ks(t).d_()})}function zK(t){return v(this,null,function*(){let e=ks(t);for(let n of t.D_)e.I_(n.mutations)})}function WK(t,e,n){return v(this,null,function*(){let r=t.D_.shift(),i=pD.from(r,e,n);yield WV(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield tc(t)})}function KK(t,e){return v(this,null,function*(){e&&ks(t).P_&&(yield function(r,i){return v(this,null,function*(){if(function(o){return gV(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();ks(r).Zo(),yield WV(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield tc(r)}})}(t,e)),KV(t)&&QV(t)})}function DF(t,e){return v(this,null,function*(){let n=M(t);n.asyncQueue.verifyOperationInProgress(),C("RemoteStore","RemoteStore received new credentials");let r=Vs(n);n.v_.add(3),yield ec(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield gh(n)})}function aT(t,e){return v(this,null,function*(){let n=M(t);e?(n.v_.delete(2),yield gh(n)):e||(n.v_.add(2),yield ec(n),n.x_.set("Unknown"))})}function nc(t){return t.N_||(t.N_=function(n,r,i){let s=M(n);return s.R_(),new nT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:UK.bind(null,t),To:BK.bind(null,t),u_:$K.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.N_.Zo(),ZT(t)?YT(t):t.x_.set("Unknown")):(yield t.N_.stop(),zV(t))}))),t.N_}function ks(t){return t.B_||(t.B_=function(n,r,i){let s=M(n);return s.R_(),new rT(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:GK.bind(null,t),To:KK.bind(null,t),E_:zK.bind(null,t),T_:WK.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.B_.Zo(),yield tc(t)):(yield t.B_.stop(),t.D_.length>0&&(C("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}var uT=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new _t,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new E(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function rc(t,e){if(at("AsyncQueue",`${e}: ${t}`),Fs(t))return new E(y.UNAVAILABLE,`${e}: ${t}`);throw t}var m_=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||x.comparator(n.key,r.key):(n,r)=>x.comparator(n.key,r.key),this.keyedMap=kd(),this.sortedSet=new Be(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var __=class{constructor(){this.L_=new Be(x.comparator)}track(e){let n=e.doc.key,r=this.L_.get(n);r?e.type!==0&&r.type===3?this.L_=this.L_.insert(n,e):e.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.L_=this.L_.remove(n):e.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):F():this.L_=this.L_.insert(n,e)}k_(){let e=[];return this.L_.inorderTraversal((n,r)=>{e.push(r)}),e}},Wu=class t{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,m_.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var cT=class{constructor(){this.q_=void 0,this.Q_=[]}},lT=class{constructor(){this.queries=new ni(e=>eV(e),hh),this.onlineState="Unknown",this.K_=new Set}};function XT(t,e){return v(this,null,function*(){let n=M(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new cT),i)try{s.q_=yield n.onListen(r)}catch(o){let a=rc(o,`Initialization of query '${Au(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&eb(n)})}function JT(t,e){return v(this,null,function*(){let n=M(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),i=s.Q_.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function QK(t,e){let n=M(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.W_(i)&&(r=!0);o.q_=i}}r&&eb(n)}function YK(t,e,n){let r=M(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function eb(t){t.K_.forEach(e=>{e.next()})}var sh=class{constructor(e,n,r){this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Wu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.z_?this.H_(e)&&(this.G_.next(e),n=!0):this.J_(e,this.onlineState)&&(this.Y_(e),n=!0),this.j_=e,n}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),n=!0),n}J_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.Z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}H_(e){if(e.docChanges.length>0)return!0;let n=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(e){e=Wu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}};var dT=class{constructor(e,n){this.X_=e,this.byteLength=n}ea(){return"metadata"in this.X_}};var y_=class{constructor(e){this.serializer=e}Ps(e){return Xr(this.serializer,e)}Is(e){return e.metadata.exists?CV(this.serializer,e.document,!1):yt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return ct(e)}},hT=class{constructor(e,n,r){this.ta=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=YV(e)}na(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.X_.namedQuery)this.queries.push(e.X_.namedQuery);else if(e.X_.documentMetadata){this.documents.push({metadata:e.X_.documentMetadata}),e.X_.documentMetadata.exists||++n;let r=ye.fromString(e.X_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.X_.document&&(this.documents[this.documents.length-1].document=e.X_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ra(e){let n=new Map,r=new y_(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||ie()).add(s);n.set(o,a)}}return n}complete(){return v(this,null,function*(){let e=yield VK(this.localStore,new y_(this.serializer),this.documents,this.ta.id),n=this.ra(this.documents);for(let r of this.queries)yield LK(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ia:this.collectionGroups,sa:e}})}};function YV(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var v_=class{constructor(e){this.key=e}},w_=class{constructor(e){this.key=e}},E_=class{constructor(e,n){this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=ie(),this.mutatedKeys=ie(),this.ua=nV(e),this.ca=new m_(this.ua)}get la(){return this.oa}ha(e,n){let r=n?n.Pa:new __,i=n?n.ca:this.ca,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=fh(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),m=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),m=!0):this.Ia(h,f)||(r.track({type:2,doc:f}),m=!0,(u&&this.ua(f,u)>0||c&&this.ua(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),m=!0):h&&!f&&(r.track({type:1,doc:h}),m=!0,(u||c)&&(a=!0)),m&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{ca:o,Pa:r,Xi:a,mutatedKeys:s}}Ia(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;let o=e.Pa.k_();o.sort((l,d)=>function(f,p){let g=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return F()}};return g(f)-g(p)}(l.type,d.type)||this.ua(l.doc,d.doc)),this.Ta(r),i=i!=null&&i;let a=n&&!i?this.Ea():[],u=this.aa.size===0&&this.current&&!i?1:0,c=u!==this._a;return this._a=u,o.length!==0||c?{snapshot:new Wu(this.query,e.ca,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new __,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=e.current)}Ea(){if(!this.current)return[];let e=this.aa;this.aa=ie(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});let n=[];return e.forEach(r=>{this.aa.has(r)||n.push(new w_(r))}),this.aa.forEach(r=>{e.has(r)||n.push(new v_(r))}),n}Ra(e){this.oa=e.hs,this.aa=ie();let n=this.ha(e.documents);return this.applyChanges(n,!0)}Va(){return Wu.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}},fT=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},pT=class{constructor(e){this.key=e,this.ma=!1}},gT=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new ni(a=>eV(a),hh),this.pa=new Map,this.ya=new Set,this.wa=new Be(x.comparator),this.Sa=new Map,this.ba=new th,this.Da={},this.Ca=new Map,this.va=qu.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}};function ZK(t,e){return v(this,null,function*(){let n=sb(t),r,i,s=n.ga.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{let o=yield Gu(n.localStore,un(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield tb(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&P_(n.remoteStore,o)}return i})}function tb(t,e,n,r,i){return v(this,null,function*(){t.Ma=(d,h,f)=>function(g,m,I,A){return v(this,null,function*(){let D=m.view.ha(I);D.Xi&&(D=yield c_(g.localStore,m.query,!1).then(({documents:xe})=>m.view.ha(xe,D)));let k=A&&A.targetChanges.get(m.targetId),q=A&&A.targetMismatches.get(m.targetId)!=null,W=m.view.applyChanges(D,g.isPrimaryClient,k,q);return mT(g,m.targetId,W.da),W.snapshot})}(t,d,h,f);let s=yield c_(t.localStore,e,!0),o=new E_(e,s.hs),a=o.ha(s.documents),u=Zd.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);mT(t,n,c.da);let l=new fT(e,n,o);return t.ga.set(e,l),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),c.snapshot})}function XK(t,e){return v(this,null,function*(){let n=M(t),r=n.ga.get(e),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter(s=>!hh(s,e))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield zu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),ih(n.remoteStore,r.targetId),Ku(n,r.targetId)}).catch(Os))):(Ku(n,r.targetId),yield zu(n.localStore,r.targetId,!0))})}function JK(t,e,n){return v(this,null,function*(){let r=ob(t);try{let i=yield function(o,a){let u=M(o),c=Ze.now(),l=a.reduce((f,p)=>f.add(p.key),ie()),d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=yn(),g=ie();return u.os.getEntries(f,l).next(m=>{p=m,p.forEach((I,A)=>{A.isValidDocument()||(g=g.add(I))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,p)).next(m=>{d=m;let I=[];for(let A of a){let D=mK(A,d.get(A.key).overlayedDocument);D!=null&&I.push(new _r(A.key,D,WF(D.value.mapValue),rt.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,I,a)}).next(m=>{h=m;let I=m.applyToLocalDocumentSet(d,g);return u.documentOverlayCache.saveOverlays(f,m.batchId,I)})}).then(()=>({batchId:h.batchId,changes:iV(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Da[o.currentUser.toKey()];c||(c=new Be(re)),c=c.insert(a,u),o.Da[o.currentUser.toKey()]=c}(r,i.batchId,n),yield Fi(r,i.changes),yield tc(r.remoteStore)}catch(i){let s=rc(i,"Failed to persist write");n.reject(s)}})}function ZV(t,e){return v(this,null,function*(){let n=M(t);try{let r=yield OK(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Sa.get(s);o&&($(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ma=!0:i.modifiedDocuments.size>0?$(o.ma):i.removedDocuments.size>0&&($(o.ma),o.ma=!1))}),yield Fi(n,r,e)}catch(r){yield Os(r)}})}function TF(t,e,n){let r=M(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ga.forEach((s,o)=>{let a=o.view.U_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=M(o);u.onlineState=a;let c=!1;u.queries.forEach((l,d)=>{for(let h of d.Q_)h.U_(a)&&(c=!0)}),c&&eb(u)}(r.eventManager,e),i.length&&r.fa.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function e7(t,e,n){return v(this,null,function*(){let r=M(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Sa.get(e),s=i&&i.key;if(s){let o=new Be(x.comparator);o=o.insert(s,yt.newNoDocument(s,G.min()));let a=ie().add(s),u=new Yd(G.min(),new Map,new Be(re),o,a);yield ZV(r,u),r.wa=r.wa.remove(s),r.Sa.delete(e),ib(r)}else yield zu(r.localStore,e,!1).then(()=>Ku(r,e,n)).catch(Os)})}function t7(t,e){return v(this,null,function*(){let n=M(t),r=e.batch.batchId;try{let i=yield kK(n.localStore,e);rb(n,r,null),nb(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Fi(n,i)}catch(i){yield Os(i)}})}function n7(t,e,n){return v(this,null,function*(){let r=M(t);try{let i=yield function(o,a){let u=M(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>($(d!==null),l=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);rb(r,e,n),nb(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Fi(r,i)}catch(i){yield Os(i)}})}function r7(t,e){return v(this,null,function*(){let n=M(t);Vs(n.remoteStore)||C("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=M(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ca.get(r)||[];i.push(e),n.Ca.set(r,i)}catch(r){let i=rc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function nb(t,e){(t.Ca.get(e)||[]).forEach(n=>{n.resolve()}),t.Ca.delete(e)}function rb(t,e,n){let r=M(t),i=r.Da[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}function Ku(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.pa.get(e))t.ga.delete(r),n&&t.fa.xa(r,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach(r=>{t.ba.containsKey(r)||XV(t,r)})}function XV(t,e){t.ya.delete(e.path.canonicalString());let n=t.wa.get(e);n!==null&&(ih(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),ib(t))}function mT(t,e,n){for(let r of n)r instanceof v_?(t.ba.addReference(r.key,e),i7(t,r)):r instanceof w_?(C("SyncEngine","Document no longer in limbo: "+r.key),t.ba.removeReference(r.key,e),t.ba.containsKey(r.key)||XV(t,r.key)):F()}function i7(t,e){let n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(C("SyncEngine","New document in limbo: "+n),t.ya.add(r),ib(t))}function ib(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){let e=t.ya.values().next().value;t.ya.delete(e);let n=new x(ye.fromString(e)),r=t.va.next();t.Sa.set(r,new pT(n)),t.wa=t.wa.insert(n,r),P_(t.remoteStore,new Hu(un(Ju(n.path)),r,"TargetPurposeLimboResolution",Nn._e))}}function Fi(t,e,n){return v(this,null,function*(){let r=M(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,u)=>{o.push(r.Ma(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let l=QD.Ki(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.fa.u_(i),yield function(u,c){return v(this,null,function*(){let l=M(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>_.forEach(c,h=>_.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>_.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Fs(d))throw d;C("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,g)}}})}(r.localStore,s))})}function s7(t,e){return v(this,null,function*(){let n=M(t);if(!n.currentUser.isEqual(e)){C("SyncEngine","User change. New user:",e.toKey());let r=yield LV(n.localStore,e);n.currentUser=e,function(s,o){s.Ca.forEach(a=>{a.forEach(u=>{u.reject(new E(y.CANCELLED,o))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Fi(n,r.us)}})}function o7(t,e){let n=M(t),r=n.Sa.get(e);if(r&&r.ma)return ie().add(r.key);{let i=ie(),s=n.pa.get(e);if(!s)return i;for(let o of s){let a=n.ga.get(o);i=i.unionWith(a.view.la)}return i}}function a7(t,e){return v(this,null,function*(){let n=M(t),r=yield c_(n.localStore,e.query,!0),i=e.view.Ra(r);return n.isPrimaryClient&&mT(n,e.targetId,i.da),i})}function u7(t,e){return v(this,null,function*(){let n=M(t);return $V(n.localStore,e).then(r=>Fi(n,r))})}function c7(t,e,n,r){return v(this,null,function*(){let i=M(t),s=yield function(a,u){let c=M(a),l=M(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,u).next(h=>h?c.localDocuments.getDocuments(d,h):_.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield tc(i.remoteStore):n==="acknowledged"||n==="rejected"?(rb(i,e,r||null),nb(i,e),function(a,u){M(M(a).mutationQueue).Mn(u)}(i.localStore,e)):F(),yield Fi(i,s)):C("SyncEngine","Cannot apply mutation batch with id: "+e)})}function l7(t,e){return v(this,null,function*(){let n=M(t);if(sb(n),ob(n),e===!0&&n.Fa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield bF(n,r.toArray());n.Fa=!0,yield aT(n.remoteStore,!0);for(let s of i)P_(n.remoteStore,s)}else if(e===!1&&n.Fa!==!1){let r=[],i=Promise.resolve();n.pa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Ku(n,o),zu(n.localStore,o,!0))),ih(n.remoteStore,o)}),yield i,yield bF(n,r),function(o){let a=M(o);a.Sa.forEach((u,c)=>{ih(a.remoteStore,c)}),a.ba.mr(),a.Sa=new Map,a.wa=new Be(x.comparator)}(n),n.Fa=!1,yield aT(n.remoteStore,!1)}})}function bF(t,e,n){return v(this,null,function*(){let r=M(t),i=[],s=[];for(let o of e){let a,u=r.pa.get(o);if(u&&u.length!==0){a=yield Gu(r.localStore,un(u[0]));for(let c of u){let l=r.ga.get(c),d=yield a7(r,l);d.snapshot&&s.push(d.snapshot)}}else{let c=yield BV(r.localStore,o);a=yield Gu(r.localStore,c),yield tb(r,JV(c),o,!1,a.resumeToken)}i.push(a)}return r.fa.u_(s),i})}function JV(t){return JF(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function d7(t){return function(n){return M(M(n).persistence).Li()}(M(t).localStore)}function h7(t,e,n,r){return v(this,null,function*(){let i=M(t);if(i.Fa)return void C("SyncEngine","Ignoring unexpected query state notification.");let s=i.pa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield $V(i.localStore,tV(s[0])),a=Yd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",kt.EMPTY_BYTE_STRING);yield Fi(i,o,a);break}case"rejected":yield zu(i.localStore,e,!0),Ku(i,e,r);break;default:F()}})}function f7(t,e,n){return v(this,null,function*(){let r=sb(t);if(r.Fa){for(let i of e){if(r.pa.has(i)){C("SyncEngine","Adding an already active target "+i);continue}let s=yield BV(r.localStore,i),o=yield Gu(r.localStore,s);yield tb(r,JV(s),o.targetId,!1,o.resumeToken),P_(r.remoteStore,o)}for(let i of n)r.pa.has(i)&&(yield zu(r.localStore,i,!1).then(()=>{ih(r.remoteStore,i),Ku(r,i)}).catch(Os))}})}function sb(t){let e=M(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ZV.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=o7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=e7.bind(null,e),e.fa.u_=QK.bind(null,e.eventManager),e.fa.xa=YK.bind(null,e.eventManager),e}function ob(t){let e=M(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=t7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=n7.bind(null,e),e}function p7(t,e,n){let r=M(t);(function(s,o,a){return v(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(f,p){let g=M(f),m=ct(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",I=>g.$r.getBundleMetadata(I,p.id)).then(I=>!!I&&I.createTime.compareTo(m)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(YV(u));let c=new hT(u,s.localStore,o.serializer),l=yield o.Oa();for(;l;){let h=yield c.na(l);h&&a._updateProgress(h),l=yield o.Oa()}let d=yield c.complete();return yield Fi(s,d.sa,void 0),yield function(f,p){let g=M(f);return g.persistence.runTransaction("Save bundle","readwrite",m=>g.$r.saveBundleMetadata(m,p))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d.ia)}catch(u){return Yn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var oh=class{constructor(){this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){this.serializer=ph(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return VV(this.persistence,new u_,e.initialUser,this.serializer)}createPersistence(e){return new o_(a_.Hr,this.serializer)}createSharedClientState(e){return new h_}terminate(){return v(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var I_=class t extends oh{constructor(e,n,r){super(),this.Na=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){yield ny(t.prototype,this,"initialize").call(this,e),yield this.Na.initialize(this,e),yield ob(this.Na.syncEngine),yield tc(this.Na.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return VV(this.persistence,new u_,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new kD(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new X0(n,this.persistence);return new Z0(e.asyncQueue,r)}createPersistence(e){let n=KT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Qn.withCacheSize(this.cacheSizeBytes):Qn.DEFAULT;return new KD(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,qV(),km(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new h_}},_T=class t extends I_{constructor(e,n){super(e,n,!1),this.Na=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return v(this,null,function*(){yield ny(t.prototype,this,"initialize").call(this,e);let n=this.Na.syncEngine;this.sharedClientState instanceof Ud&&(this.sharedClientState.syncEngine={Zs:c7.bind(null,n),Xs:h7.bind(null,n),eo:f7.bind(null,n),Li:d7.bind(null,n),Ys:u7.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>v(this,null,function*(){yield l7(this.Na.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=qV();if(!Ud.D(n))throw new E(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=KT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ud(n,e.asyncQueue,r,e.clientId,e.initialUser)}},ah=class{initialize(e,n){return v(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>TF(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=s7.bind(null,this.syncEngine),yield aT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new lT}()}createDatastore(e){let n=ph(e.databaseInfo.databaseId),r=function(s){return new tT(s)}(e.databaseInfo);return function(s,o,a,u){return new iT(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new oT(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>TF(this.syncEngine,n,0),function(){return f_.D()?new f_:new JD}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,l){let d=new gT(i,s,o,a,u,c);return l&&(d.Fa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return v(this,null,function*(){var e;yield function(r){return v(this,null,function*(){let i=M(r);C("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield ec(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function SF(t,e=10240){let n=0;return{read(){return v(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return v(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Qu=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):at("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var yT=class{constructor(e,n){this.ka=e,this.serializer=n,this.metadata=new _t,this.buffer=new Uint8Array,this.qa=function(){return new TextDecoder("utf-8")}(),this.Qa().then(r=>{r&&r.ea()?this.metadata.resolve(r.X_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.X_)}`))},r=>this.metadata.reject(r))}close(){return this.ka.cancel()}getMetadata(){return v(this,null,function*(){return this.metadata.promise})}Oa(){return v(this,null,function*(){return yield this.getMetadata(),this.Qa()})}Qa(){return v(this,null,function*(){let e=yield this.Ka();if(e===null)return null;let n=this.qa.decode(e),r=Number(n);isNaN(r)&&this.$a(`length string (${n}) is not valid number`);let i=yield this.Ua(r);return new dT(JSON.parse(i),e.length+r)})}Wa(){return this.buffer.findIndex(e=>e===123)}Ka(){return v(this,null,function*(){for(;this.Wa()<0&&!(yield this.Ga()););if(this.buffer.length===0)return null;let e=this.Wa();e<0&&this.$a("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ua(e){return v(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ga())&&this.$a("Reached the end of bundle when more is expected.");let n=this.qa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}$a(e){throw this.ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ga(){return v(this,null,function*(){let e=yield this.ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var vT=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new E(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return v(this,null,function*(){let o=M(i),a={documents:s.map(d=>Xd(o.serializer,d))},u=yield o.vo("BatchGetDocuments",o.serializer.databaseId,ye.emptyPath(),a,s.length),c=new Map;u.forEach(d=>{let h=IK(o.serializer,d);c.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=c.get(d.toString());$(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ps(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=x.fromPath(r);this.mutations.push(new Wd(i,this.precondition(i)))}),yield function(r,i){return v(this,null,function*(){let s=M(r),o={writes:i.map(a=>Jd(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,ye.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw F();n=G.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new E(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(G.min())?rt.exists(!1):rt.updateTime(n):rt.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(G.min()))throw new E(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rt.updateTime(n)}return rt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var wT=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.za=r.maxAttempts,this.jo=new rh(this.asyncQueue,"transaction_retry")}ja(){this.za-=1,this.Ha()}Ha(){this.jo.qo(()=>v(this,null,function*(){let e=new vT(this.datastore),n=this.Ja(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Ya(i)}))}).catch(r=>{this.Ya(r)})}))}Ja(e){try{let n=this.updateFunction(e);return!lh(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Ya(e){this.za>0&&this.Za(e)?(this.za-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ha(),Promise.resolve()))):this.deferred.reject(e)}Za(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!gV(n)}return!1}};var ET=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=mt.UNAUTHENTICATED,this.clientId=Vm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>v(this,null,function*(){C("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(C("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new E(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new _t;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=rc(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Om(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),C("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>v(this,null,function*(){r.isEqual(i)||(yield LV(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function IT(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield ab(t);C("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>DF(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>DF(e.remoteStore,i)),t._onlineComponents=e})}function eL(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function ab(t){return v(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){C("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Om(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!eL(n))throw n;Yn("Error using user provided cache. Falling back to memory cache: "+n),yield Om(t,new oh)}}else C("FirestoreClient","Using default OfflineComponentProvider"),yield Om(t,new oh);return t._offlineComponents})}function k_(t){return v(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(C("FirestoreClient","Using user provided OnlineComponentProvider"),yield IT(t,t._uninitializedComponentsProvider._online)):(C("FirestoreClient","Using default OnlineComponentProvider"),yield IT(t,new ah))),t._onlineComponents})}function tL(t){return ab(t).then(e=>e.persistence)}function ub(t){return ab(t).then(e=>e.localStore)}function nL(t){return k_(t).then(e=>e.remoteStore)}function cb(t){return k_(t).then(e=>e.syncEngine)}function g7(t){return k_(t).then(e=>e.datastore)}function Yu(t){return v(this,null,function*(){let e=yield k_(t),n=e.eventManager;return n.onListen=ZK.bind(null,e.syncEngine),n.onUnlisten=XK.bind(null,e.syncEngine),n})}function m7(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield tL(t),n=yield nL(t);return e.setNetworkEnabled(!0),function(i){let s=M(i);return s.v_.delete(0),gh(s)}(n)}))}function _7(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield tL(t),n=yield nL(t);return e.setNetworkEnabled(!1),function(i){return v(this,null,function*(){let s=M(i);s.v_.add(0),yield ec(s),s.x_.set("Offline")})}(n)}))}function y7(t,e){let n=new _t;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield function(c,l){let d=M(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new E(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=rc(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield ub(t),e,n)})),n.promise}function rL(t,e,n={}){let r=new _t;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new Qu({next:h=>{o.enqueueAndForget(()=>JT(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new E(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?c.reject(new E(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new sh(Ju(a.path),l,{includeMetadataChanges:!0,Z_:!0});return XT(s,d)}(yield Yu(t),t.asyncQueue,e,n,r)})),r.promise}function v7(t,e){let n=new _t;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield c_(i,s,!0),u=new E_(s,a.hs),c=u.ha(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){let u=rc(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield ub(t),e,n)})),n.promise}function iL(t,e,n={}){let r=new _t;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new Qu({next:h=>{o.enqueueAndForget(()=>JT(s,d)),h.fromCache&&u.source==="server"?c.reject(new E(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new sh(a,l,{includeMetadataChanges:!0,Z_:!0});return XT(s,d)}(yield Yu(t),t.asyncQueue,e,n,r)})),r.promise}function w7(t,e){let n=new Qu(e);return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){M(i).K_.add(s),s.next()}(yield Yu(t),n)})),()=>{n.La(),t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){M(i).K_.delete(s)}(yield Yu(t),n)}))}}function E7(t,e,n,r){let i=function(o,a){let u;return u=typeof o=="string"?_V().encode(o):o,function(l,d){return new yT(l,d)}(function(l,d){if(l instanceof Uint8Array)return SF(l,d);if(l instanceof ArrayBuffer)return SF(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(n,ph(e));t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){p7(yield cb(t),i,r)}))}function I7(t,e){return t.asyncQueue.enqueue(()=>v(this,null,function*(){return function(r,i){let s=M(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield ub(t),e)}))}function sL(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var AF=new Map;function lb(t,e,n){if(!n)throw new E(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function db(t,e,n,r){if(e===!0&&r===!0)throw new E(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function xF(t){if(!x.isDocumentKey(t))throw new E(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function RF(t){if(x.isDocumentKey(t))throw new E(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function O_(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":F()}function ve(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new E(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=O_(t);throw new E(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function oL(t,e){if(e<=0)throw new E(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var C_=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new E(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new E(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}db("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sL((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new E(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new E(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new E(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},qo=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new C_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new E(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new E(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new C_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new B0;switch(r.type){case"firstParty":return new G0(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new E(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=AF.get(n);r&&(C("ComponentProvider","Removing Datastore"),AF.delete(n),r.terminate())}(this),Promise.resolve()}};function aL(t,e,n,r={}){var i;let s=(t=ve(t,qo))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Yn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=mt.MOCK_USER;else{a=ia(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new E(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new mt(c)}t._authCredentials=new $0(new Fm(a,u))}}var qt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},je=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Jr=class t extends qt{constructor(e,n,r){super(e,n,Ju(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new je(this.firestore,null,new x(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function hb(t,e,...n){if(t=Z(t),lb("collection","path",e),t instanceof qo){let r=ye.fromString(e,...n);return RF(r),new Jr(t,null,r)}{if(!(t instanceof je||t instanceof Jr))throw new E(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ye.fromString(e,...n));return RF(r),new Jr(t.firestore,null,r)}}function uL(t,e){if(t=ve(t,qo),lb("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new E(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new qt(t,null,function(r){return new mr(ye.emptyPath(),r)}(e))}function mh(t,e,...n){if(t=Z(t),arguments.length===1&&(e=Vm.newId()),lb("doc","path",e),t instanceof qo){let r=ye.fromString(e,...n);return xF(r),new je(t,null,new x(r))}{if(!(t instanceof je||t instanceof Jr))throw new E(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ye.fromString(e,...n));return xF(r),new je(t.firestore,t instanceof Jr?t.converter:null,new x(r))}}function fb(t,e){return t=Z(t),e=Z(e),(t instanceof je||t instanceof Jr)&&(e instanceof je||e instanceof Jr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function pb(t,e){return t=Z(t),e=Z(e),t instanceof qt&&e instanceof qt&&t.firestore===e.firestore&&hh(t._query,e._query)&&t.converter===e.converter}var CT=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new rh(this,"async_queue_retry"),this._u=()=>{let n=km();n&&C("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=km();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;let n=km();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});let n=new _t;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){return v(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!Fs(e))throw e;C("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(e){let n=this.Xa.then(()=>(this.iu=!0,e().catch(r=>{this.ru=r,this.iu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw at("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(e,n,r){this.au(),this.ou.indexOf(e)>-1&&(n=0);let i=uT.createAndSchedule(this,e,n,r,s=>this.lu(s));return this.nu.push(i),i}au(){this.ru&&F()}verifyOperationInProgress(){}hu(){return v(this,null,function*(){let e;do e=this.Xa,yield e;while(e!==this.Xa)})}Pu(e){for(let n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){let n=this.nu.indexOf(e);this.nu.splice(n,1)}};function DT(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var TT=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new _t,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var cL=-1,Ke=class extends qo{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new CT}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||lL(this),this._firestoreClient.terminate()}};function Ct(t){return t._firestoreClient||lL(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function lL(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,c,l){return new J0(a,u,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,sL(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new ET(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function dL(t,e){wL(t=ve(t,Ke));let n=Ct(t);if(n._uninitializedComponentsProvider)throw new E(y.FAILED_PRECONDITION,"SDK cache is already specified.");Yn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new ah;return fL(n,i,new I_(i,r.cacheSizeBytes,e?.forceOwnership))}function hL(t){wL(t=ve(t,Ke));let e=Ct(t);if(e._uninitializedComponentsProvider)throw new E(y.FAILED_PRECONDITION,"SDK cache is already specified.");Yn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new ah;return fL(e,r,new _T(r,n.cacheSizeBytes))}function fL(t,e,n){let r=new _t;return t.asyncQueue.enqueue(()=>v(this,null,function*(){try{yield Om(t,n),yield IT(t,e),r.resolve()}catch(i){let s=i;if(!eL(s))throw s;Yn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function pL(t){if(t._initialized&&!t._terminated)throw new E(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new _t;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{yield function(r){return v(this,null,function*(){if(!Mi.D())return Promise.resolve();let i=r+"main";yield Mi.delete(i)})}(KT(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function gL(t){return function(n){let r=new _t;return n.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return r7(yield cb(n),r)})),r.promise}(Ct(t=ve(t,Ke)))}function mL(t){return m7(Ct(t=ve(t,Ke)))}function _L(t){return _7(Ct(t=ve(t,Ke)))}function yL(t,e){let n=Ct(t=ve(t,Ke)),r=new TT;return E7(n,t._databaseId,e,r),r}function vL(t,e){return I7(Ct(t=ve(t,Ke)),e).then(n=>n?new qt(t,null,n.query):null)}function wL(t){if(t._initialized||t._terminated)throw new E(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var ri=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(kt.fromBase64String(e))}catch(n){throw new E(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var yr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new E(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ut(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ki=class{constructor(e){this._methodName=e}};var Go=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new E(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new E(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return re(this._lat,e._lat)||re(this._long,e._long)}};var C7=/^__.*__$/,bT=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new _r(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ns(e,this.data,n,this.fieldTransforms)}},D_=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new _r(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function EL(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F()}}var T_=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.mu(e),i}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.Eu(),i}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return b_(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(e.length===0)throw this.pu("Document fields must not be empty");if(EL(this.du)&&C7.test(e))throw this.pu('Document fields cannot begin and end with "__"')}},ST=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ph(e)}Su(e,n,r,i=!1){return new T_({du:e,methodName:n,wu:r,path:ut.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Qo(t){let e=t._freezeSettings(),n=ph(t._databaseId);return new ST(t._databaseId,!!e.ignoreUndefinedProperties,n)}function F_(t,e,n,r,i,s={}){let o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);_b("Data must be an object, but it was:",o,r);let a=DL(r,o),u,c;if(s.merge)u=new Pn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=NT(e,d,n);if(!o.contains(h))throw new E(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);bL(l,h)||l.push(h)}u=new Pn(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new bT(new Zt(a),u,c)}var uh=class t extends ki{_toFieldTransform(e){if(e.du!==2)throw e.du===1?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function IL(t,e,n){return new T_({du:3,wu:e.settings.wu,methodName:t._methodName,Vu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var AT=class t extends ki{_toFieldTransform(e){return new Bo(e.path,new Rs)}isEqual(e){return e instanceof t}},xT=class t extends ki{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=IL(this,e,!0),r=this.bu.map(s=>Yo(s,n)),i=new Ni(r);return new Bo(e.path,i)}isEqual(e){return e instanceof t&&sy(this.bu,e.bu)}},RT=class t extends ki{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=IL(this,e,!0),r=this.bu.map(s=>Yo(s,n)),i=new Pi(r);return new Bo(e.path,i)}isEqual(e){return e instanceof t&&sy(this.bu,e.bu)}},MT=class t extends ki{constructor(e,n){super(e),this.Du=n}_toFieldTransform(e){let n=new Ms(e.serializer,uV(e.serializer,this.Du));return new Bo(e.path,n)}isEqual(e){return e instanceof t&&this.Du===e.Du}};function gb(t,e,n,r){let i=t.Su(1,e,n);_b("Data must be an object, but it was:",i,r);let s=[],o=Zt.empty();Ko(r,(u,c)=>{let l=yb(e,u,n);c=Z(c);let d=i.fu(l);if(c instanceof uh)s.push(l);else{let h=Yo(c,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new Pn(s);return new D_(o,a,i.fieldTransforms)}function mb(t,e,n,r,i,s){let o=t.Su(1,e,n),a=[NT(e,r,n)],u=[i];if(s.length%2!=0)throw new E(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(NT(e,s[h])),u.push(s[h+1]);let c=[],l=Zt.empty();for(let h=a.length-1;h>=0;--h)if(!bL(c,a[h])){let f=a[h],p=u[h];p=Z(p);let g=o.fu(f);if(p instanceof uh)c.push(f);else{let m=Yo(p,g);m!=null&&(c.push(f),l.set(f,m))}}let d=new Pn(c);return new D_(l,d,o.fieldTransforms)}function CL(t,e,n,r=!1){return Yo(n,t.Su(r?4:3,e))}function Yo(t,e){if(TL(t=Z(t)))return _b("Unsupported field value:",e,t),DL(t,e);if(t instanceof ki)return function(r,i){if(!EL(i.du))throw i.pu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&e.du!==4)throw e.pu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=Yo(a,i.gu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Z(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return uV(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ze.fromDate(r);return{timestampValue:$u(i.serializer,s)}}if(r instanceof Ze){let s=new Ze(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$u(i.serializer,s)}}if(r instanceof Go)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ri)return{bytesValue:yV(i.serializer,r._byteString)};if(r instanceof je){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:GT(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.pu(`Unsupported field value: ${O_(r)}`)}(t,e)}function DL(t,e){let n={};return qF(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ko(t,(r,i)=>{let s=Yo(i,e.Ru(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function TL(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ze||t instanceof Go||t instanceof ri||t instanceof je||t instanceof ki)}function _b(t,e,n){if(!TL(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=O_(n);throw r==="an object"?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function NT(t,e,n){if((e=Z(e))instanceof yr)return e._internalPath;if(typeof e=="string")return yb(t,e);throw b_("Field path arguments must be of type string or ",t,!1,void 0,n)}var D7=new RegExp("[~\\*/\\[\\]]");function yb(t,e,n){if(e.search(D7)>=0)throw b_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new yr(...e.split("."))._internalPath}catch{throw b_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function b_(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new E(y.INVALID_ARGUMENT,a+t+u)}function bL(t,e){return t.some(n=>n.isEqual(e))}var zo=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new PT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(V_("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},PT=class extends zo{data(){return super.data()}};function V_(t,e){return typeof e=="string"?yb(t,e):e instanceof yr?e._internalPath:e._delegate._internalPath}function SL(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new E(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ch=class{},Wo=class extends ch{};function Vi(t,e,...n){let r=[];e instanceof ch&&r.push(e),r=r.concat(n),function(s){let o=s.filter(u=>u instanceof kT).length,a=s.filter(u=>u instanceof S_).length;if(o>1||o>0&&a>0)throw new E(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var S_=class t extends Wo{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return VL(e._query,n),new qt(e.firestore,e.converter,hD(e._query,n))}_parse(e){let n=Qo(e.firestore);return function(s,o,a,u,c,l,d){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new E(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){NF(d,l);let f=[];for(let p of d)f.push(MF(u,s,p));h={arrayValue:{values:f}}}else h=MF(u,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||NF(d,l),h=CL(a,o,d,l==="in"||l==="not-in");return me.create(c,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function AL(t,e,n){let r=e,i=V_("where",t);return S_._create(i,r,n)}var kT=class t extends ch{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ae.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)VL(o,u),o=hD(o,u)}(e._query,n),new qt(e.firestore,e.converter,hD(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var OT=class t extends Wo{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new E(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new E(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new jo(s,o)}(e._query,this._field,this._direction);return new qt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new mr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function xL(t,e="asc"){let n=e,r=V_("orderBy",t);return OT._create(r,n)}var A_=class t extends Wo{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new qt(e.firestore,e.converter,Wm(e._query,this._limit,this._limitType))}};function RL(t){return oL("limit",t),A_._create("limit",t,"F")}function ML(t){return oL("limitToLast",t),A_._create("limitToLast",t,"L")}var x_=class t extends Wo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=FL(e,this.type,this._docOrFields,this._inclusive);return new qt(e.firestore,e.converter,function(i,s){return new mr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function NL(...t){return x_._create("startAt",t,!0)}function PL(...t){return x_._create("startAfter",t,!1)}var R_=class t extends Wo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=FL(e,this.type,this._docOrFields,this._inclusive);return new qt(e.firestore,e.converter,function(i,s){return new mr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function kL(...t){return R_._create("endBefore",t,!1)}function OL(...t){return R_._create("endAt",t,!0)}function FL(t,e,n,r){if(n[0]=Z(n[0]),n[0]instanceof zo)return function(s,o,a,u,c){if(!u)throw new E(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of ku(s))if(d.field.isKeyField())l.push(Lo(o,u.key));else{let h=u.data.field(d.field);if(N_(h))throw new E(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new E(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new ti(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=Qo(t.firestore);return function(o,a,u,c,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new E(y.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new E(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!HT(o)&&g.indexOf("/")!==-1)throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);let m=o.path.child(ye.fromString(g));if(!x.isDocumentKey(m))throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${m}' is not because it contains an odd number of segments.`);let I=new x(m);f.push(Lo(a,I))}else{let m=CL(u,c,g);f.push(m)}}return new ti(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function MF(t,e,n){if(typeof(n=Z(n))=="string"){if(n==="")throw new E(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!HT(e)&&n.indexOf("/")!==-1)throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(ye.fromString(n));if(!x.isDocumentKey(r))throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Lo(t,new x(r))}if(n instanceof je)return Lo(t,n._key);throw new E(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${O_(n)}.`)}function NF(t,e){if(!Array.isArray(t)||t.length===0)throw new E(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function VL(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new E(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new E(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Zu=class{convertValue(e,n="none"){switch(Vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ss(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw F()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return Ko(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Go(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=BT(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(qd(e));default:return null}}convertTimestamp(e){let n=bs(e);return new Ze(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=ye.fromString(e);$(xV(r));let i=new As(r.get(1),r.get(3)),s=new x(r.popFirst(5));return i.isEqual(n)||at(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function L_(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var FT=class extends Zu{constructor(e){super(),this.firestore=e}convertBytes(e){return new ri(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,n)}};var Ri=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Xn=class extends zo{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Ds(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(V_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Ds=class extends Xn{data(e={}){return super.data(e)}},vr=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Ri(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ds(this._firestore,this._userDataWriter,r.key,r,new Ri(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new E(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new Ds(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ri(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new Ds(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Ri(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,l=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:T7(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function T7(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return F()}}function vb(t,e){return t instanceof Xn&&e instanceof Xn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof vr&&e instanceof vr&&t._firestore===e._firestore&&pb(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function LL(t){t=ve(t,je);let e=ve(t.firestore,Ke);return rL(Ct(e),t._key).then(n=>Cb(e,t,n))}var Oi=class extends Zu{constructor(e){super(),this.firestore=e}convertBytes(e){return new ri(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,n)}};function jL(t){t=ve(t,je);let e=ve(t.firestore,Ke),n=Ct(e),r=new Oi(e);return y7(n,t._key).then(i=>new Xn(e,r,t._key,i,new Ri(i!==null&&i.hasLocalMutations,!0),t.converter))}function UL(t){t=ve(t,je);let e=ve(t.firestore,Ke);return rL(Ct(e),t._key,{source:"server"}).then(n=>Cb(e,t,n))}function BL(t){t=ve(t,qt);let e=ve(t.firestore,Ke),n=Ct(e),r=new Oi(e);return SL(t._query),iL(n,t._query).then(i=>new vr(e,r,t,i))}function $L(t){t=ve(t,qt);let e=ve(t.firestore,Ke),n=Ct(e),r=new Oi(e);return v7(n,t._query).then(i=>new vr(e,r,t,i))}function HL(t){t=ve(t,qt);let e=ve(t.firestore,Ke),n=Ct(e),r=new Oi(e);return iL(n,t._query,{source:"server"}).then(i=>new vr(e,r,t,i))}function wb(t,e,n){t=ve(t,je);let r=ve(t.firestore,Ke),i=L_(t.converter,e,n);return ic(r,[F_(Qo(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,rt.none())])}function Eb(t,e,n,...r){t=ve(t,je);let i=ve(t.firestore,Ke),s=Qo(i),o;return o=typeof(e=Z(e))=="string"||e instanceof yr?mb(s,"updateDoc",t._key,e,n,r):gb(s,"updateDoc",t._key,e),ic(i,[o.toMutation(t._key,rt.exists(!0))])}function qL(t){return ic(ve(t.firestore,Ke),[new Ps(t._key,rt.none())])}function GL(t,e){let n=ve(t.firestore,Ke),r=mh(t),i=L_(t.converter,e);return ic(n,[F_(Qo(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,rt.exists(!1))]).then(()=>r)}function Ib(t,...e){var n,r,i;t=Z(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||DT(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(DT(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,c,l;if(t instanceof je)c=ve(t.firestore,Ke),l=Ju(t._key.path),u={next:d=>{e[o]&&e[o](Cb(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=ve(t,qt);c=ve(d.firestore,Ke),l=d._query;let h=new Oi(c);u={next:f=>{e[o]&&e[o](new vr(c,h,d,f))},error:e[o+1],complete:e[o+2]},SL(t._query)}return function(h,f,p,g){let m=new Qu(g),I=new sh(f,m,p);return h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return XT(yield Yu(h),I)})),()=>{m.La(),h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return JT(yield Yu(h),I)}))}}(Ct(c),l,a,u)}function zL(t,e){return w7(Ct(t=ve(t,Ke)),DT(e)?e:{next:e})}function ic(t,e){return function(r,i){let s=new _t;return r.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return JK(yield cb(r),i,s)})),s.promise}(Ct(t),e)}function Cb(t,e,n){let r=n.docs.get(e._key),i=new Oi(t);return new Xn(t,i,e._key,r,new Ri(n.hasPendingWrites,n.fromCache),e.converter)}var b7={maxAttempts:5};var M_=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Qo(e)}set(e,n,r){this._verifyNotCommitted();let i=Is(e,this._firestore),s=L_(i.converter,n,r),o=F_(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,rt.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Is(e,this._firestore),o;return o=typeof(n=Z(n))=="string"||n instanceof yr?mb(this._dataReader,"WriteBatch.update",s._key,n,r,i):gb(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,rt.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Is(e,this._firestore);return this._mutations=this._mutations.concat(new Ps(n._key,rt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new E(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Is(t,e){if((t=Z(t)).firestore!==e)throw new E(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var VT=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Qo(n)}get(n){let r=Is(n,this._firestore),i=new FT(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return F();let o=s[0];if(o.isFoundDocument())return new zo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new zo(this._firestore,i,r._key,null,r.converter);throw F()})}set(n,r,i){let s=Is(n,this._firestore),o=L_(s.converter,r,i),a=F_(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Is(n,this._firestore),a;return a=typeof(r=Z(r))=="string"||r instanceof yr?mb(this._dataReader,"Transaction.update",o._key,r,i,s):gb(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Is(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Is(e,this._firestore),r=new Oi(this._firestore);return super.get(e).then(i=>new Xn(this._firestore,r,n._key,i._document,new Ri(!1,!1),n.converter))}};function WL(t,e,n){t=ve(t,Ke);let r=Object.assign(Object.assign({},b7),n);return function(s){if(s.maxAttempts<1)throw new E(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new _t;return s.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){let c=yield g7(s);new wT(s.asyncQueue,c,a,o,u).ja()})),u.promise}(Ct(t),i=>e(new VT(t,i)),r)}function KL(){return new uh("deleteField")}function QL(){return new AT("serverTimestamp")}function YL(...t){return new xT("arrayUnion",t)}function ZL(...t){return new RT("arrayRemove",t)}function XL(t){return new MT("increment",t)}(function(e,n=!0){(function(i){Xu=i})(sa),ai(new Ft("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ke(new H0(r.getProvider("auth-internal")),new W0(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new E(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new As(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),hn(k1,"4.4.2",e),hn(k1,"4.4.2","esm2017")})();var S7="@firebase/firestore-compat",A7="0.3.25";function xb(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new E("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function JL(){if(typeof Uint8Array>"u")throw new E("unimplemented","Uint8Arrays are not available in this environment.")}function e2(){if(!GF())throw new E("unimplemented","Blobs are unavailable in Firestore in this environment.")}var j_=class t{constructor(e){this._delegate=e}static fromBase64String(e){return e2(),new t(ri.fromBase64String(e))}static fromUint8Array(e){return JL(),new t(ri.fromUint8Array(e))}toBase64(){return e2(),this._delegate.toBase64()}toUint8Array(){return JL(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Db(t){return x7(t,["next","error","complete"])}function x7(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var Tb=class{enableIndexedDbPersistence(e,n){return dL(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return hL(e._delegate)}clearIndexedDbPersistence(e){return pL(e._delegate)}},U_=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof As||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Yn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){aL(this._delegate,e,n,r)}enableNetwork(){return mL(this._delegate)}disableNetwork(){return _L(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,db("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return gL(this._delegate)}onSnapshotsInSync(e){return zL(this._delegate,e)}get app(){if(!this._appCompat)throw new E("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ac(this,hb(this._delegate,e))}catch(n){throw cn(n,"collection()","Firestore.collection()")}}doc(e){try{return new ii(this,mh(this._delegate,e))}catch(n){throw cn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ea(this,uL(this._delegate,e))}catch(n){throw cn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return WL(this._delegate,n=>e(new B_(this,n)))}batch(){return Ct(this._delegate),new $_(new M_(this._delegate,e=>ic(this._delegate,e)))}loadBundle(e){return yL(this._delegate,e)}namedQuery(e){return vL(this._delegate,e).then(n=>n?new ea(this,n):null)}},sc=class extends Zu{constructor(e){super(),this.firestore=e}convertBytes(e){return new j_(new ri(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return ii.forKey(n,this.firestore,null)}};function R7(t){PF(t)}var B_=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new sc(e)}get(e){let n=Zo(e);return this._delegate.get(n).then(r=>new Xo(this._firestore,new Xn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Zo(e);return r?(xb("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Zo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Zo(e);return this._delegate.delete(n),this}},$_=class{constructor(e){this._delegate=e}set(e,n,r){let i=Zo(e);return r?(xb("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Zo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Zo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},oc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Ds(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Jo(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new sc(e),n),i.set(n,s)),s}};oc.INSTANCES=new WeakMap;var ii=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new sc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new E("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new je(n._delegate,r,new x(e)))}static forKey(e,n,r){return new t(n,new je(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ac(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ac(this.firestore,hb(this._delegate,e))}catch(n){throw cn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Z(e),e instanceof je?fb(this._delegate,e):!1}set(e,n){n=xb("DocumentReference.set",n);try{return n?wb(this._delegate,e,n):wb(this._delegate,e)}catch(r){throw cn(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?Eb(this._delegate,e):Eb(this._delegate,e,n,...r)}catch(i){throw cn(i,"updateDoc()","DocumentReference.update()")}}delete(){return qL(this._delegate)}onSnapshot(...e){let n=t2(e),r=n2(e,i=>new Xo(this.firestore,new Xn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Ib(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=jL(this._delegate):e?.source==="server"?n=UL(this._delegate):n=LL(this._delegate),n.then(r=>new Xo(this.firestore,new Xn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(oc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function cn(t,e,n){return t.message=t.message.replace(e,n),t}function t2(t){for(let e of t)if(typeof e=="object"&&!Db(e))return e;return{}}function n2(t,e){var n,r;let i;return Db(t[0])?i=t[0]:Db(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Xo=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new ii(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return vb(this._delegate,e._delegate)}},Jo=class extends Xo{data(e){let n=this._delegate.data(e);return this._delegate._converter||kF(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},ea=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new sc(e)}where(e,n,r){try{return new t(this.firestore,Vi(this._delegate,AL(e,n,r)))}catch(i){throw cn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,Vi(this._delegate,xL(e,n)))}catch(r){throw cn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,Vi(this._delegate,RL(e)))}catch(n){throw cn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,Vi(this._delegate,ML(e)))}catch(n){throw cn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,Vi(this._delegate,NL(...e)))}catch(n){throw cn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,Vi(this._delegate,PL(...e)))}catch(n){throw cn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,Vi(this._delegate,kL(...e)))}catch(n){throw cn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,Vi(this._delegate,OL(...e)))}catch(n){throw cn(n,"endAt()","Query.endAt()")}}isEqual(e){return pb(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=$L(this._delegate):e?.source==="server"?n=HL(this._delegate):n=BL(this._delegate),n.then(r=>new _h(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=t2(e),r=n2(e,i=>new _h(this.firestore,new vr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Ib(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(oc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},bb=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Jo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},_h=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new ea(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Jo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new bb(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Jo(this._firestore,r))})}isEqual(e){return vb(this._delegate,e._delegate)}},ac=class t extends ea{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new ii(this.firestore,e):null}doc(e){try{return e===void 0?new ii(this.firestore,mh(this._delegate)):new ii(this.firestore,mh(this._delegate,e))}catch(n){throw cn(n,"doc()","CollectionReference.doc()")}}add(e){return GL(this._delegate,e).then(n=>new ii(this.firestore,n))}isEqual(e){return fb(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(oc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Zo(t){return ve(t,je)}var Sb=class t{constructor(...e){this._delegate=new yr(...e)}static documentId(){return new t(ut.keyField().canonicalString())}isEqual(e){return e=Z(e),e instanceof yr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Ab=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=QL();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=KL();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=YL(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=ZL(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=XL(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var M7={Firestore:U_,GeoPoint:Go,Timestamp:Ze,Blob:j_,Transaction:B_,WriteBatch:$_,DocumentReference:ii,DocumentSnapshot:Xo,Query:ea,QueryDocumentSnapshot:Jo,QuerySnapshot:_h,CollectionReference:ac,FieldPath:Sb,FieldValue:Ab,setLogLevel:R7,CACHE_SIZE_UNLIMITED:cL};function N7(t,e){t.INTERNAL.registerComponent(new Ft("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},M7)))}function P7(t){N7(t,(e,n)=>new U_(e,n,new Tb)),t.registerVersion(S7,A7)}P7(Je);function k7(t,e=ci){return new se(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function r2(t,e){return k7(t,e)}function O7(t,e){return r2(t,e).pipe(Gs(void 0),Dc(),U(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function Nb(t,e){return r2(t,e).pipe(U(n=>({payload:n,type:"query"})))}var H_=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=u2(r,n);return new G_(i,s,this.afs)}snapshotChanges(){return O7(this.ref,this.afs.schedulers.outsideAngular).pipe(ze)}valueChanges(e={}){return this.snapshotChanges().pipe(U(({payload:n})=>e.idField?Ce(N({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return ce(this.ref.get(e)).pipe(ze)}};function q_(t,e){return Nb(t,e).pipe(Gs(void 0),Dc(),U(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function i2(t,e,n){return q_(t,n).pipe(Cr((r,i)=>F7(r,i.map(s=>s.payload),e),[]),Ic(),U(r=>r.map(i=>({type:i.type,payload:i}))))}function F7(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=V7(t,r))}),t}function Rb(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function V7(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return Rb(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return Rb(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Rb(t,e.oldIndex,1);break}return t}function s2(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var G_=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=q_(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(U(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(Gs(void 0),Dc(),Et(([r,i])=>i.length>0||!r),U(([,r])=>r),ze)}auditTrail(e){return this.stateChanges(e).pipe(Cr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=s2(e);return i2(this.query,n,this.afs.schedulers.outsideAngular).pipe(ze)}valueChanges(e={}){return Nb(this.query,this.afs.schedulers.outsideAngular).pipe(U(n=>n.payload.docs.map(r=>e.idField?Ce(N({},r.data()),{[e.idField]:r.id}):r.data())),ze)}get(e){return ce(this.query.get(e)).pipe(ze)}add(e){return this.ref.add(e)}doc(e){return new H_(this.ref.doc(e),this.afs)}},Mb=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?q_(this.query,this.afs.schedulers.outsideAngular).pipe(ze):q_(this.query,this.afs.schedulers.outsideAngular).pipe(U(n=>n.filter(r=>e.indexOf(r.type)>-1)),Et(n=>n.length>0),ze)}auditTrail(e){return this.stateChanges(e).pipe(Cr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=s2(e);return i2(this.query,n,this.afs.schedulers.outsideAngular).pipe(ze)}valueChanges(e={}){return Nb(this.query,this.afs.schedulers.outsideAngular).pipe(U(r=>r.payload.docs.map(i=>e.idField?N({[e.idField]:i.id},i.data()):i.data())),ze)}get(e){return ce(this.query.get(e)).pipe(ze)}},o2=new P("angularfire2.enableFirestorePersistence"),a2=new P("angularfire2.firestore.persistenceSettings"),L7=new P("angularfire2.firestore.settings"),j7=new P("angularfire2.firestore.use-emulator");function u2(t,e=n=>n){return{query:e(t),ref:t}}var U7=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,m,I,A){this.schedulers=u;let D=Di(n,a,r),k=l;d&&El(D,a,h,p,g,m,f,I),[this.firestore,this.persistenceEnabled$]=as(`${D.name}.firestore`,"AngularFirestore",D.name,()=>{let q=a.runOutsideAngular(()=>D.firestore());if(s&&q.settings(s),k&&q.useEmulator(...k),i&&!lo(o)){let W=()=>{try{return ce(q.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(xe){return typeof console<"u"&&console.warn(xe),B(!1)}};return[q,a.runOutsideAngular(W)]}else return[q,B(!1)]},[s,k,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=u2(i,r),a=this.schedulers.ngZone.run(()=>s);return new G_(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new Mb(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new H_(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(w(jr),w(Ur,8),w(o2,8),w(L7,8),w(St),w(de),w(ss),w(a2,8),w(j7,8),w(Qp,8),w(gl,8),w(ml,8),w(_l,8),w(yl,8),w(vl,8),w(wl,8),w(lr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),c2=(()=>{class t{constructor(){Je.registerVersion("angularfire",Lr.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:o2,useValue:!0},{provide:a2,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=He({type:t});static \u0275inj=$e({providers:[U7]})}return t})();var y2="firebasestorage.googleapis.com",v2="storageBucket",B7=2*60*1e3,$7=10*60*1e3,H7=1e3;var Xe=class t extends bh{constructor(e,n,r=0){super(Pb(e),`Firebase Storage: ${n} (${Pb(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Pb(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Qe=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Qe||{});function Pb(t){return"storage/"+t}function Bb(){let t="An unknown error occurred, please check the error payload for server response.";return new Xe(Qe.UNKNOWN,t)}function q7(t){return new Xe(Qe.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function G7(t){return new Xe(Qe.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function z7(){let t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Xe(Qe.UNAUTHENTICATED,t)}function W7(){return new Xe(Qe.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function K7(t){return new Xe(Qe.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function w2(){return new Xe(Qe.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function E2(){return new Xe(Qe.CANCELED,"User canceled the upload/download.")}function Q7(t){return new Xe(Qe.INVALID_URL,"Invalid URL '"+t+"'.")}function Y7(t){return new Xe(Qe.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Z7(){return new Xe(Qe.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+v2+"' property when initializing the app?")}function I2(){return new Xe(Qe.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function X7(){return new Xe(Qe.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function J7(){return new Xe(Qe.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function eQ(t){return new Xe(Qe.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ta(t){return new Xe(Qe.INVALID_ARGUMENT,t)}function C2(){return new Xe(Qe.APP_DELETED,"The Firebase app was deleted.")}function $b(t){return new Xe(Qe.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function vh(t,e){return new Xe(Qe.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function yh(t){throw new Xe(Qe.INTERNAL_ERROR,"Internal error: "+t)}var ln=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw Y7(e)}static makeFromUrl(e,n){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(k){k.path.charAt(k.path.length-1)==="/"&&(k.path_=k.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),u={bucket:1,path:3};function c(k){k.path_=decodeURIComponent(k.path)}let l="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",f=new RegExp(`^https?://${d}/${l}/b/${i}/o${h}`,"i"),p={bucket:1,path:3},g=n===y2?"(?:storage.googleapis.com|storage.cloud.google.com)":n,m="([^?#]*)",I=new RegExp(`^https?://${g}/${i}/${m}`,"i"),D=[{regex:a,indices:u,postModify:s},{regex:f,indices:p,postModify:c},{regex:I,indices:{bucket:1,path:2},postModify:c}];for(let k=0;k<D.length;k++){let q=D[k],W=q.regex.exec(e);if(W){let xe=W[q.indices.bucket],Dt=W[q.indices.path];Dt||(Dt=""),r=new t(xe,Dt),q.postModify(r);break}}if(r==null)throw Q7(e);return r}},Ob=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function tQ(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function u(){return a===2}let c=!1;function l(...m){c||(c=!0,e.apply(null,m))}function d(m){i=setTimeout(()=>{i=null,t(f,u())},m)}function h(){s&&clearTimeout(s)}function f(m,...I){if(c){h();return}if(m){h(),l.call(null,m,...I);return}if(u()||o){h(),l.call(null,m,...I);return}r<64&&(r*=2);let D;a===1?(a=2,D=0):D=(r+Math.random())*1e3,d(D)}let p=!1;function g(m){p||(p=!0,h(),!c&&(i!==null?(m||(a=2),clearTimeout(i),d(0)):m||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}function nQ(t){t(!1)}function rQ(t){return t!==void 0}function iQ(t){return typeof t=="function"}function sQ(t){return typeof t=="object"&&!Array.isArray(t)}function K_(t){return typeof t=="string"||t instanceof String}function l2(t){return Hb()&&t instanceof Blob}function Hb(){return typeof Blob<"u"}function Fb(t,e,n,r){if(r<e)throw ta(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ta(`Invalid value for '${t}'. Expected ${n} or less.`)}function Ls(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function D2(t){let e=encodeURIComponent,n="?";for(let r in t)if(t.hasOwnProperty(r)){let i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var lc=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(lc||{});function T2(t,e){let n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}var Vb=class{constructor(e,n,r,i,s,o,a,u,c,l,d,h=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=d,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new cc(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let u=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===lc.NO_ERROR,u=s.getStatus();if(!a||T2(u,this.additionalRetryCodes_)&&this.retry){let l=s.getErrorCode()===lc.ABORT;r(!1,new cc(!1,null,l));return}let c=this.successCodes_.indexOf(u)!==-1;r(!0,new cc(c,s))})},n=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let u=this.callback_(a,a.getResponse());rQ(u)?s(u):s()}catch(u){o(u)}else if(a!==null){let u=Bb();u.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,u)):o(u)}else if(i.canceled){let u=this.appDelete_?C2():E2();o(u)}else{let u=w2();o(u)}};this.canceled_?n(!1,new cc(!1,null,!0)):this.backoffId_=tQ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&nQ(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},cc=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function oQ(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function aQ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function uQ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function cQ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function lQ(t,e,n,r,i,s,o=!0){let a=D2(t.urlParams),u=t.url+a,c=Object.assign({},t.headers);return uQ(c,e),oQ(c,n),aQ(c,s),cQ(c,r),new Vb(u,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}function dQ(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function hQ(...t){let e=dQ();if(e!==void 0){let n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Hb())return new Blob(t);throw new Xe(Qe.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function fQ(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function pQ(t){if(typeof atob>"u")throw eQ("base-64");return atob(t)}var kn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},wh=class{constructor(e,n){this.data=e,this.contentType=n||null}};function qb(t,e){switch(t){case kn.RAW:return new wh(b2(e));case kn.BASE64:case kn.BASE64URL:return new wh(S2(t,e));case kn.DATA_URL:return new wh(mQ(e),_Q(e))}throw Bb()}function b2(t){let e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function gQ(t){let e;try{e=decodeURIComponent(t)}catch{throw vh(kn.DATA_URL,"Malformed data URL.")}return b2(e)}function S2(t,e){switch(t){case kn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw vh(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case kn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw vh(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=pQ(e)}catch(i){throw i.message.includes("polyfill")?i:vh(t,"Invalid character found")}let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}var W_=class{constructor(e){this.base64=!1,this.contentType=null;let n=e.match(/^data:([^,]+)?,/);if(n===null)throw vh(kn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=n[1]||null;r!=null&&(this.base64=yQ(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function mQ(t){let e=new W_(t);return e.base64?S2(kn.BASE64,e.rest):gQ(e.rest)}function _Q(t){return new W_(t).contentType}function yQ(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}var dc=class t{constructor(e,n){let r=0,i="";l2(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(l2(this.data_)){let r=this.data_,i=fQ(r,e,n);return i===null?null:new t(i)}else{let r=new Uint8Array(this.data_.buffer,e,n-e);return new t(r,!0)}}static getBlob(...e){if(Hb()){let n=e.map(r=>r instanceof t?r.data_:r);return new t(hQ.apply(null,n))}else{let n=e.map(o=>K_(o)?qb(kn.RAW,o).data:o.data_),r=0;n.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new t(i,!0)}}uploadData(){return this.data_}};function Gb(t){let e;try{e=JSON.parse(t)}catch{return null}return sQ(e)?e:null}function vQ(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function wQ(t,e){let n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function A2(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function EQ(t,e){return e}var Gt=class{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||EQ}},z_=null;function IQ(t){return!K_(t)||t.length<2?t:A2(t)}function Q_(){if(z_)return z_;let t=[];t.push(new Gt("bucket")),t.push(new Gt("generation")),t.push(new Gt("metageneration")),t.push(new Gt("name","fullPath",!0));function e(s,o){return IQ(o)}let n=new Gt("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}let i=new Gt("size");return i.xform=r,t.push(i),t.push(new Gt("timeCreated")),t.push(new Gt("updated")),t.push(new Gt("md5Hash",null,!0)),t.push(new Gt("cacheControl",null,!0)),t.push(new Gt("contentDisposition",null,!0)),t.push(new Gt("contentEncoding",null,!0)),t.push(new Gt("contentLanguage",null,!0)),t.push(new Gt("contentType",null,!0)),t.push(new Gt("metadata","customMetadata",!0)),z_=t,z_}function CQ(t,e){function n(){let r=t.bucket,i=t.fullPath,s=new ln(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function DQ(t,e,n){let r={};r.type="file";let i=n.length;for(let s=0;s<i;s++){let o=n[s];r[o.local]=o.xform(r,e[o.server])}return CQ(r,t),r}function x2(t,e,n){let r=Gb(e);return r===null?null:DQ(t,r,n)}function TQ(t,e,n,r){let i=Gb(e);if(i===null||!K_(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(c=>{let l=t.bucket,d=t.fullPath,h="/b/"+o(l)+"/o/"+o(d),f=Ls(h,n,r),p=D2({alt:"media",token:c});return f+p})[0]}function zb(t,e){let n={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}var d2="prefixes",h2="items";function bQ(t,e,n){let r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[d2])for(let i of n[d2]){let s=i.replace(/\/$/,""),o=t._makeStorageReference(new ln(e,s));r.prefixes.push(o)}if(n[h2])for(let i of n[h2]){let s=t._makeStorageReference(new ln(e,i.name));r.items.push(s)}return r}function SQ(t,e,n){let r=Gb(n);return r===null?null:bQ(t,e,r)}var wr=class{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function oi(t){if(!t)throw Bb()}function Y_(t,e){function n(r,i){let s=x2(t,i,e);return oi(s!==null),s}return n}function AQ(t,e){function n(r,i){let s=SQ(t,e,i);return oi(s!==null),s}return n}function xQ(t,e){function n(r,i){let s=x2(t,i,e);return oi(s!==null),TQ(s,i,t.host,t._protocol)}return n}function pc(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=W7():i=z7():n.getStatus()===402?i=G7(t.bucket):n.getStatus()===403?i=K7(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Z_(t){let e=pc(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=q7(t.path)),s.serverResponse=i.serverResponse,s}return n}function R2(t,e,n){let r=e.fullServerUrl(),i=Ls(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new wr(i,s,Y_(t,n),o);return a.errorHandler=Z_(e),a}function RQ(t,e,n,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=Ls(o,t.host,t._protocol),u="GET",c=t.maxOperationRetryTime,l=new wr(a,u,AQ(t,e.bucket),c);return l.urlParams=s,l.errorHandler=pc(e),l}function MQ(t,e,n){let r=e.fullServerUrl(),i=Ls(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new wr(i,s,xQ(t,n),o);return a.errorHandler=Z_(e),a}function NQ(t,e,n,r){let i=e.fullServerUrl(),s=Ls(i,t.host,t._protocol),o="PATCH",a=zb(n,r),u={"Content-Type":"application/json; charset=utf-8"},c=t.maxOperationRetryTime,l=new wr(s,o,Y_(t,r),c);return l.headers=u,l.body=a,l.errorHandler=Z_(e),l}function PQ(t,e){let n=e.fullServerUrl(),r=Ls(n,t.host,t._protocol),i="DELETE",s=t.maxOperationRetryTime;function o(u,c){}let a=new wr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=Z_(e),a}function kQ(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function M2(t,e,n){let r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=kQ(null,e)),r}function OQ(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let D="";for(let k=0;k<2;k++)D=D+Math.random().toString().slice(2);return D}let u=a();o["Content-Type"]="multipart/related; boundary="+u;let c=M2(e,r,i),l=zb(c,n),d="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+l+`\r
--`+u+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+u+"--",f=dc.getBlob(d,r,h);if(f===null)throw I2();let p={name:c.fullPath},g=Ls(s,t.host,t._protocol),m="POST",I=t.maxUploadRetryTime,A=new wr(g,m,Y_(t,n),I);return A.urlParams=p,A.headers=o,A.body=f.uploadData(),A.errorHandler=pc(e),A}var hc=class{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}};function Wb(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{oi(!1)}return oi(!!n&&(e||["active"]).indexOf(n)!==-1),n}function FQ(t,e,n,r,i){let s=e.bucketOnlyServerUrl(),o=M2(e,r,i),a={name:o.fullPath},u=Ls(s,t.host,t._protocol),c="POST",l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},d=zb(o,n),h=t.maxUploadRetryTime;function f(g){Wb(g);let m;try{m=g.getResponseHeader("X-Goog-Upload-URL")}catch{oi(!1)}return oi(K_(m)),m}let p=new wr(u,c,f,h);return p.urlParams=a,p.headers=l,p.body=d,p.errorHandler=pc(e),p}function VQ(t,e,n,r){let i={"X-Goog-Upload-Command":"query"};function s(c){let l=Wb(c,["active","final"]),d=null;try{d=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{oi(!1)}d||oi(!1);let h=Number(d);return oi(!isNaN(h)),new hc(h,r.size(),l==="final")}let o="POST",a=t.maxUploadRetryTime,u=new wr(n,o,s,a);return u.headers=i,u.errorHandler=pc(e),u}var f2=256*1024;function LQ(t,e,n,r,i,s,o,a){let u=new hc(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw X7();let c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));let d=u.current,h=d+l,f="";l===0?f="finalize":c===l?f="upload, finalize":f="upload";let p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":`${u.current}`},g=r.slice(d,h);if(g===null)throw I2();function m(k,q){let W=Wb(k,["active","final"]),xe=u.current+l,Dt=r.size(),js;return W==="final"?js=Y_(e,s)(k,q):js=null,new hc(xe,Dt,W==="final",js)}let I="POST",A=e.maxUploadRetryTime,D=new wr(n,I,m,A);return D.headers=p,D.body=g.uploadData(),D.progressCallback=a||null,D.errorHandler=pc(t),D}var N2={STATE_CHANGED:"state_changed"},Xt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function kb(t){switch(t){case"running":case"pausing":case"canceling":return Xt.RUNNING;case"paused":return Xt.PAUSED;case"success":return Xt.SUCCESS;case"canceled":return Xt.CANCELED;case"error":return Xt.ERROR;default:return Xt.ERROR}}var Lb=class{constructor(e,n,r){if(iQ(e)||n!=null||r!=null)this.next=e,this.error=n??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function uc(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}var p2=null,jb=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=lc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=lc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=lc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw yh("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw yh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw yh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw yh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw yh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},Ub=class extends jb{initXhr(){this.xhr_.responseType="text"}};function si(){return p2?p2():new Ub}var Eh=class{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=Q_(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Qe.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(T2(i.status,[]))if(s)i=w2();else{this.sleepTime=Math.max(this.sleepTime*2,H7),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Qe.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{let r=FQ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,si,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((n,r)=>{let i=VQ(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,si,n,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=f2*this._chunkMultiplier,n=new hc(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=LQ(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(u){this._error=u,this._transition("error");return}let a=this._ref.storage._makeRequest(o,si,i,s,!1);this._request=a,a.getPromise().then(u=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(u.current),u.finalized?(this._metadata=u.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){f2*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{let r=R2(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,si,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{let r=OQ(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,si,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=E2(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=kb(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){let s=new Lb(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(kb(this._state)){case Xt.SUCCESS:uc(this._resolve.bind(null,this.snapshot))();break;case Xt.CANCELED:case Xt.ERROR:let n=this._reject;uc(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(kb(this._state)){case Xt.RUNNING:case Xt.PAUSED:e.next&&uc(e.next.bind(e,this.snapshot))();break;case Xt.SUCCESS:e.complete&&uc(e.complete.bind(e))();break;case Xt.CANCELED:case Xt.ERROR:e.error&&uc(e.error.bind(e,this._error))();break;default:e.error&&uc(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var fc=class t{constructor(e,n){this._service=e,n instanceof ln?this._location=n:this._location=ln.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new ln(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return A2(this._location.path)}get storage(){return this._service}get parent(){let e=vQ(this._location.path);if(e===null)return null;let n=new ln(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw $b(e)}};function jQ(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Eh(t,new dc(e),n)}function UQ(t){let e={prefixes:[],items:[]};return P2(t,e).then(()=>e)}function P2(t,e,n){return v(this,null,function*(){let i=yield k2(t,{pageToken:n});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield P2(t,e,i.nextPageToken))})}function k2(t,e){e!=null&&typeof e.maxResults=="number"&&Fb("options.maxResults",1,1e3,e.maxResults);let n=e||{},r=RQ(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(r,si)}function BQ(t){t._throwIfRoot("getMetadata");let e=R2(t.storage,t._location,Q_());return t.storage.makeRequestWithTokens(e,si)}function $Q(t,e){t._throwIfRoot("updateMetadata");let n=NQ(t.storage,t._location,e,Q_());return t.storage.makeRequestWithTokens(n,si)}function HQ(t){t._throwIfRoot("getDownloadURL");let e=MQ(t.storage,t._location,Q_());return t.storage.makeRequestWithTokens(e,si).then(n=>{if(n===null)throw J7();return n})}function qQ(t){t._throwIfRoot("deleteObject");let e=PQ(t.storage,t._location);return t.storage.makeRequestWithTokens(e,si)}function O2(t,e){let n=wQ(t._location.path,e),r=new ln(t._location.bucket,n);return new fc(t.storage,r)}function GQ(t){return/^[A-Za-z]+:\/\//.test(t)}function zQ(t,e){return new fc(t,e)}function F2(t,e){if(t instanceof Ih){let n=t;if(n._bucket==null)throw Z7();let r=new fc(n,n._bucket);return e!=null?F2(r,e):r}else return e!==void 0?O2(t,e):t}function WQ(t,e){if(e&&GQ(e)){if(t instanceof Ih)return zQ(t,e);throw ta("To use ref(service, url), the first argument must be a Storage instance.")}else return F2(t,e)}function g2(t,e){let n=e?.[v2];return n==null?null:ln.makeFromBucketSpec(n,t)}function KQ(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:ia(i,t.app.options.projectId))}var Ih=class{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=y2,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=B7,this._maxUploadRetryTime=$7,this._requests=new Set,i!=null?this._bucket=ln.makeFromBucketSpec(i,this._host):this._bucket=g2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ln.makeFromBucketSpec(this._url,e):this._bucket=g2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Fb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Fb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return v(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return v(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new fc(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new Ob(C2());{let o=lQ(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return v(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()})}},m2="@firebase/storage",_2="0.12.1";var QQ="storage";function V2(t,e,n){return t=Z(t),jQ(t,e,n)}function L2(t){return t=Z(t),BQ(t)}function j2(t,e){return t=Z(t),$Q(t,e)}function U2(t,e){return t=Z(t),k2(t,e)}function B2(t){return t=Z(t),UQ(t)}function $2(t){return t=Z(t),HQ(t)}function H2(t){return t=Z(t),qQ(t)}function Kb(t,e){return t=Z(t),WQ(t,e)}function q2(t,e){return O2(t,e)}function G2(t,e,n,r={}){KQ(t,e,n,r)}function YQ(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Ih(n,r,i,e,sa)}function ZQ(){ai(new Ft(QQ,YQ,"PUBLIC").setMultipleInstances(!0)),hn(m2,_2,""),hn(m2,_2,"esm2017")}ZQ();var gc=class{constructor(e,n,r){this._delegate=e,this.task=n,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var X_=class{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new gc(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(r=>{if(e)return e(new gc(r,this,this._ref))},n)}on(e,n,r,i){let s;return n&&(typeof n=="function"?s=o=>n(new gc(o,this,this._ref)):s={next:n.next?o=>n.next(new gc(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},J_=class{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new na(e,this._service))}get items(){return this._delegate.items.map(e=>new na(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var na=class t{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let n=q2(this._delegate,e);return new t(n,this.storage)}get root(){return new t(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new t(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new X_(V2(this._delegate,e,n),this)}putString(e,n=kn.RAW,r){this._throwIfRoot("putString");let i=qb(n,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new X_(new Eh(this._delegate,new dc(i.data,!0),s),this)}listAll(){return B2(this._delegate).then(e=>new J_(e,this.storage))}list(e){return U2(this._delegate,e||void 0).then(n=>new J_(n,this.storage))}getMetadata(){return L2(this._delegate)}updateMetadata(e){return j2(this._delegate,e)}getDownloadURL(){return $2(this._delegate)}delete(){return this._throwIfRoot("delete"),H2(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw $b(e)}};var ey=class{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(z2(e))throw ta("ref() expected a child path but got a URL, use refFromURL instead.");return new na(Kb(this._delegate,e),this)}refFromURL(e){if(!z2(e))throw ta("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ln.makeFromUrl(e,this._delegate.host)}catch{throw ta("refFromUrl() expected a valid full URL but got an invalid one.")}return new na(Kb(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,r={}){G2(this._delegate,e,n,r)}};function z2(t){return/^[A-Za-z]+:\/\//.test(t)}var XQ="@firebase/storage-compat",JQ="0.3.4";var eY="storage-compat";function tY(t,{instanceIdentifier:e}){let n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("storage").getImmediate({identifier:e});return new ey(n,r)}function nY(t){let e={TaskState:Xt,TaskEvent:N2,StringFormat:kn,Storage:ey,Reference:na};t.INTERNAL.registerComponent(new Ft(eY,tY,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(XQ,JQ)}nY(Je);function rY(t){return new se(e=>{let n=o=>e.next(o),r=o=>e.error(o),i=()=>e.complete();n(t.snapshot);let s=t.on("state_changed",n);return t.then(o=>{n(o),i()},o=>{n(t.snapshot),r(o)}),function(){s()}}).pipe(Ty(0))}function W2(t){let e=rY(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(U(n=>n.bytesTransferred/n.totalBytes*100))}}function ty(t){return{getDownloadURL:()=>B(void 0).pipe(LE,Ne(()=>t.getDownloadURL()),ze),getMetadata:()=>B(void 0).pipe(LE,Ne(()=>t.getMetadata()),ze),delete:()=>ce(t.delete()),child:e=>ty(t.child(e)),updateMetadata:e=>ce(t.updateMetadata(e)),put:(e,n)=>{let r=t.put(e,n);return W2(r)},putString:(e,n,r)=>{let i=t.putString(e,n,r);return W2(i)},list:e=>ce(t.list(e)),listAll:()=>ce(t.listAll())}}var iY=new P("angularfire2.storageBucket"),sY=new P("angularfire2.storage.maxUploadRetryTime"),oY=new P("angularfire2.storage.maxOperationRetryTime"),aY=new P("angularfire2.storage.use-emulator"),uY=(()=>{class t{storage;constructor(n,r,i,s,o,a,u,c,l,d){let h=Di(n,o,r);this.storage=as(`${h.name}.storage.${i}`,"AngularFireStorage",h.name,()=>{let f=o.runOutsideAngular(()=>h.storage(i||void 0)),p=l;return p&&f.useEmulator(...p),u&&f.setMaxUploadRetryTime(u),c&&f.setMaxOperationRetryTime(c),f},[u,c])}ref(n){return ty(this.storage.ref(n))}refFromURL(n){return ty(this.storage.refFromURL(n))}upload(n,r,i){let s=this.storage.ref(n);return ty(s).put(r,i)}static \u0275fac=function(r){return new(r||t)(w(jr),w(Ur,8),w(iY,8),w(St),w(de),w(ss),w(sY,8),w(oY,8),w(aY,8),w(lr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var cY=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=He({type:t});static \u0275inj=$e({})}return t})(),K2=(()=>{class t{constructor(){Je.registerVersion("angularfire",Lr.full,"gcs-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=He({type:t});static \u0275inj=$e({providers:[uY],imports:[cY]})}return t})();var Q2={production:!1,firebase:{apiKey:"AIzaSyDxcpvdhNonZCKPUv-bMOGjtGf6SpS_BgI",authDomain:"account-58c0e.firebaseapp.com",databaseURL:"https://account-58c0e-default-rtdb.firebaseio.com",projectId:"account-58c0e",storageBucket:"account-58c0e.appspot.com",messagingSenderId:"1054730131196",appId:"1:1054730131196:web:8bbef9a3faf1282631a979"}};var Y2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=He({type:e,bootstrap:[Yg]}),e.\u0275inj=$e({imports:[oM,hO,dN.initializeApp(Q2.firebase),Fk,c2,K2,rO]});let t=e;return t})();sM().bootstrapModule(Y2).catch(t=>console.error(t));
